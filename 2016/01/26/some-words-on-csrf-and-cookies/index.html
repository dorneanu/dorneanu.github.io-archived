<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="appsec, web, javascript, csrf">
        <meta name="description" content="Being involved in different projects where web technologies are used, I have to make sure that AppSec related security nightmares are avoided. One of those security nightmare - and in my own oppinion the most complicated one to explain to a non-sec person - is CSRF. I won't go into details ...">
        <title>Some words on CSRF and cookies - blog.dornea.nu</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
        <link rel="stylesheet" href="/css/ipython.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/font-icons/style.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/niu2.min.css" type="text/css" />
        <link rel="stylesheet" href="/css/custom.css" type="text/css" />
		
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/niu2.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>
        
        <link rel="canonical" href="http://blog.dornea.nu/2016/01/26/some-words-on-csrf-and-cookies" />
        <script type="text/javascript">window.onload=function(){};</script>
        <!--[if lt IE 9]>
            <script src="http://blog.dornea.nu/theme/js/html5shiv.js"></script>
            <script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>
        <![endif]-->
    </head>
    <body> 
        <div id="body-header">
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="col-md-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://blog.dornea.nu">
                            <i class="icon-home"></i>blog.dornea.nu
                        </a>
                    </div>
                    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="http://dornea.nu" title="about">
                                <i class="icon-user"></i>about</a>
                            </li>
                            <li><a href="/archives.html" title="archives">
                                <i class="icon-archive"></i>archives</a>
                            </li>
                            <li><a href="/tags.html" title="tags">
                                <i class="icon-tag"></i>tags</a>
                            </li>
                            <li><a href="/feeds/rss.xml" title="feeds">
                                <i class="icon-rss"></i>feeds</a>
                            </li>
                        <!-- category dropdown list -->
                        <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="icon-folder-open"></i>category<b class="caret"></b>
                           </a>
                           <ul class="dropdown-menu">
                               <li><a href="http://blog.dornea.nu/category/blog">
                                      <i class="icon-pencil"></i>blog
                                      (117)</a></li>
                               <li><a href="http://blog.dornea.nu/category/low">
                                   <i class="icon-folder-close"></i>LOW
                                      (27)</a></li>
                               <li><a href="http://blog.dornea.nu/category/notes">
                                      <i class="icon-book"></i>notes
                                      (21)</a></li>
                           </ul>
                        </li>
                        <!--  self defined dropdown list -->
                        </ul>
                        
                        <!-- right nav bar -->
                        <ul class="nav navbar-nav navbar-right">
                        <!-- google custom search -->
                        <li>
                        <div id="niu2-cse-wrapper">
                            <div id="niu2-cse-header-box" class="navbar-form navbar-nav">
                                <form action="http://google.com/cse">
                                    <input type="hidden" name="cx" value="008508447409818574933:pxyxuhrgnxi" />
                                    <input type="hidden" name="ie" value="UTF-8" />
                                    <div class="form-group">
                                        <input id="niu2-cse-search-input" class="niu2-cse-header form-control" 
                                            type="text" name="q" 
                                            placeholder="Press enter to search ..."/>
                                    </div>
                                </form>
                           </div>
                           <div id="niu2-cse-ctrl-box" class="navbar-nav">
                            <i id="niu2-cse-search-image" class="icon-search navbar-nav"></i><span id="niu2-cse-search-text">Search</span>
                           </div>
                       </div>
                       </li>
                       </ul>
                    </nav>
                </div>
            </div>
<style>
    #banner{
        background-image:url("http://blog.dornea.nu//images/header.jpg");
    }   
</style>

<div id="banner">
    <div class="container">
        <div class="copy">
            <h2>blog.dornea.nu</h2>
                <p class="intro">Hack, code and drink some țuică. Personal blog of Victor Dorneanu.</p>
        </div>
    </div>
</div>
            <!-- End Banner -->
        </div>

        <div id="body-content">
            <div class="col-md-8 col-md-offset-2">
                <h1 id="content-heading">Some words on CSRF and cookies</h1>
            </div>
            <div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
                <div id="niu2-main-content">
                    <p>Being involved in different projects where web technologies are used, I have to make sure that <a href="http://blog.dornea.nu/tag/appsec/">AppSec</a> related security nightmares
are avoided. One of those security nightmare - and in my own oppinion the most complicated one to explain to a <strong>non-sec</strong> person - is <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">CSRF</a>. I won't go into details since these are freely available. Furthermore I would like to focus on the <strong>countermeasures</strong> one would implement to prevent CSRF. In some cases it's suggested to think of some attack scenarios before relying on the implemented solution. But first let's have a look how a typical CSRF attack works like. </p>
<h2 id="6432f4693afd88598023fe78739fb577">General idea</h2>
<p>Usually we have 3 components involved:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAACQCAYAAACYhNqRAAAKZklEQVR4nO3d3W7byBkG4BmKlEVLu8imP1gkKIqe9Ib2OveGCrQ9KLBbZNvG8Tp2JFNkDywmsqK/ZB0r5vc8QBBblumx/Q71ckjJueu6nAAACKM49QAAAHhcCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMAogAEAwCiAAQDAKIABAMOWpB3BqOef21GPgtLquC3sgJP/IP5FFzn/4AphSSl3XnXoInEjOOXVdl1NKXf9+NPIfl/zLf2TR8x+2+UKvbdu82gn0/0MY8k9kkfNvBZDwlstlmXNui6LoVqeEckqpi3Y0SEzyT2SR828FkPDm8/lZ0zTVcrkctW076o8GTz0ueAzyT2SR8x96BTDaci/bXV9fz8bj8byqqtuqqhYppVQUxTKllHPOg71ASP5JSf6JLWr+UwpcAF34S+/y8vJ5XddXdV1fp5RSznmec+5yzm3XdYO8MFj+6ck/kUXMfy9sAUzJToA7FxcXv2+apkzp7shvNBo1Oec25zzoyS//pCT/xBY1/ynFLoDhnvHDdq9fv/5DSimVZdlUVbUoy/J2NBotu65rVzuAIT5SyD8pJfkntqD5TynFLoApBbnQk/0uLi5+X1XVfDKZvD0/Px9vXAg82Mmf5J8k/8QWOP+xnwXsFAAppfT27dtvb25uZovFYtI0TdW2bdF1XR56Pob+/XEc+SeyqPlPKWgBjPCL5Xg3NzfTxWKx/lIAxfrpoaHlZWjfD7+N/BNZtPyvC1kAU3r/S3UKgNQ0zXg1+cu2bYv04fqgwR4Fyj89+SeyiPnvhS2A0Fsul2U/+VdL/x4YCEP+iSxy/hVAwts46hv0kj9skn8ii5x/BRDSvUkf5ugPevJPZFHzrwACAAQT/XUAn7T+Vco3l6x33f6p2/0t24BtNl9Z/6Gze+w2cs6yDYSmAH7lDj1gfglD//uHPI5t2e3zuytfj1nKto1BKeSpOMVjA8OiAH7ldpWx9dvWVzx23b75Oes7i0MrfsdsZ9cY7JRi2pWHQ/fv7cvntm1vy+a+FfJdue0/ti/Ph8az7/N3jdU84lMck/ttH981Hw/NJfkcJtcAPhGbE2z9/fWVlV2375rc+yb9vo8f+z6s5/BT77MtX7veXr/fsV9319f5lLzv+hrbHiTNIx7S+kFL/35Kx+Xq0CUSx26Hp0sB/MptFrXPPTV76NRbf59tE3rfA/O+r2XnwEN5qEsSdhW2ffPj2Dxvm6ObK5m7DrC2MY/YZXNf/Tm5Wn/70PXk+7Yjn0+XU8BPxKFTacdO4H3bOeaU2fp24BgPsVrwW5/Q9KXzum9e7Vp1f4xxMUz9PnnfKd2HIJ/DZgXwCTq0HL/vqG7zWpFDR4DrH9+8//qKxq5rUIhp36mjzaxsZmn99l15+9yvvW8ubPvczbePnS/7xr15Ktg84nOs5+ZQ7vblatflQ5+6HZ4eK4BfuW2TctfH992+70ju0HaP2ZYjRTY9VE4+NZ/Hfp1PnROHPrbvgfTY7ZhHHOOhc3Xs58jnsFgBBELw4AXwgQIIABCMAggAEIwCCAAQjAIIABCMAggAEIwCCAAQjAIIABCMAggAEIwCCAAQjAIIABCMAggAEIwCCAAQjAIIKaWcc/9md8pxwCnIP5FFzb8CSHhFUbQppS7n3KV0b2cAgyf/RBY5/+WpB/A1iPQL52Oj0agZjUZNURRtzvn9jiAK+Y9N/uU/ssj5D1sAV5O+u76+nl5fX0/fvHnzu19++eXFzz///OeffvrpL69evfrT69ev/3h1dfVsPp/XTdOcLZfL9z+vrhtGRn788ce//vDDD3879Ti+pPUd/Gg0asqynJ+dnd3MZrOL77777lVZlouyLG/7nUD6cDTYDfXBQf7vyL/8y7/8R8t/L2QBzDm/n8A5564oinY0Gi3Lsrwdj8fzuq7fnp+f/7pYLCYppVRV1bxpmqpt23IoE3/dN998879Tj+Ex5JxTURRNWZa3Z2dnN9Pp9PL8/PzXuq7fjsfj+WonsOyPBNc/b0jk/z75l3/5Hz75/1jIAtjLOb/fAawm/7u6rq+m0+nlfD6fpJTSeDx+t1gsJk3TlF3XFV3Xpa7rBnXt5PPnz/996jF8aTnndvX7bsuybMbj8bvz8/Nfv/322/9Op9PLuq6vxuPxu7Isb9dOBZx62F+U/N+Rf/mX/2GT/+1CF8C0WuotimJZluViMpnczGazy9vb27OUUjo7O3t3c3MzbZpmvFwuy7ZtBzXxey9evPjnqcfwWFZH+01Zlou6rt9Op9PLZ8+e/Wc2m11OJpObsiwXRVEs+1MApx7vFyb/Sf7lX/5PPYbHIv/3RS6A3cYRwbyu66umacqU7pb9Z7PZm8VicdY0TbW6/iMP8RTAy5cv/37qMTyG/rqf1Q6gP91zNZvNLmez2cXqKHBelmWzOmIc8k5A/lfkX/7lf/jk/2ORC2B/TUA3Go2WVVXd1nV9nVJKZVk2k8nk7Wrpv+qP/rquG+Sa8MuXL/9x6jE8lrVrfvqdwLvJZHJT1/VVXdfXVVX114EM/hSA/N+Rf/mX/xjk/76wBbC/EDjn3BZFkauqWqSUUlEUy6qqFufn5+PV5B9tTP7BpeL777//16nH8Ej613m6d+F3WZaL8Xg8r6rqtqqqxeoakHZ139OO+AuR/w/kX/7lPwT535CHelRzrK7rctd1uW3bom3bYrlcjpqmKdu2HfW3pdXPaYjL/9H0F36nlLqiKNrVv2VZlk3/DLBIrwcl/7HI/33yH4v836cA3k3q3D+7q23bvHq2V17/d+px8rD6Cb72r10t+7f9tSJDP/pLSf6jkv878h+T/N8R7pX+57DaEeR0/4JfP6PhWf+zP/1OIK1uG/yR3yb5D0f+18h/OPKfFMB7dk14S//Ds+XoLtzfgdwk/3HI/8fkPw75v6MAHjD0yV8URTvU17c6JNpk/xzyP1zyf5j8D5f8B34W8LEihCTC98jniZCNCN8jnydCNiJ8j2wXsvkDAESmAAIABKMAAgAEowACAASjAAIABKMAAgAE43UAAQCCsQIIABCMAggAEIwCCAAQjAIYXM65PfUY4FTkn8jkPzYFEAAgGAUQACAYBRAAIBgFEAAgGAUQACAYBRAAIBgFEAAgGH8LGAAgGCuAAADBKIAAAMEogAAAwSiAwflbkEQm/0Qm/7EpgAAAwSiAAADBKIAAAMEogAAAwSiAAADBKIAAAMEogAAAwfhbwAAAwVgBBAAIRgEEAAhGAQQACEYBBAAIRgEEAAhGAQQACEYBBAAIRgEEAAhGAQQACEYBBAAIRgEEAAhGAQQACEYBBAAIRgEEAAhGAQQACEYBBAAIRgEEAAhGAQQACEYBBAAI5v9FLi4j1TFB9QAAAABJRU5ErkJggg=="/></div></p>
<p>The <strong>client/browser</strong> communicates with the <strong>server</strong> and the <strong>attacker</strong> will try to <em>lure</em> the user to some previously <strong>prepared site</strong>. This can happen by sending 
<strong>mails</strong> with some malicious link or injecting content into a site the user is visiting (e.g. using <strong>iframes</strong>). This way the attack will cause the client/browser 
to fire requests to the server <strong>without</strong> any user interaction. The user behing the client/browser won't notice anything since this will happen in the background by just visiting the site and/or triggering some JavaScript to execute. </p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<h2 id="c0fa85353677943560ac0bca6672d54d">Some example</h2>
<p>Now let's think of some <strong>real-world</strong> example. User <strong>Bob</strong> has an account on <code>http://bank.nu</code>. Attacker <strong>Victor</strong> will prepare a site <code>http://attacker.nu</code> which once accessed will load following <strong>iframe</strong>:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">style</span><span class="o">=</span><span class="s">"display:none"</span> <span class="na">name</span><span class="o">=</span><span class="s">"csrf-frame"</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">"http://bank.nu/transfer.do"</span> <span class="na">method</span><span class="o">=</span><span class="s">"POST"</span> <span class="na">id</span><span class="o">=</span><span class="s">"csrf-form"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"hidden"</span> <span class="na">name</span><span class="o">=</span><span class="s">"acct"</span> <span class="na">value</span><span class="o">=</span><span class="s">"Victor"</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"hidden"</span> <span class="na">name</span><span class="o">=</span><span class="s">"amount"</span> <span class="na">value</span><span class="o">=</span><span class="s">"10.000"</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">value</span><span class="o">=</span><span class="s">"View my pictures"</span><span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"csrf-form"</span><span class="p">).</span><span class="nx">submit</span><span class="p">()&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
<p>In this case the <strong>iframe</strong> ins't visible at all (<code>display:none</code>) and some JavaScript will trigger the submission of the form once the <code>script</code>tag is loaded aka the user enters the site. In this fictional example the form will trigger a <code>POST</code> request which will <strong>transfer</strong> some money to the <strong>attacker</strong> (Victor). Next the <strong>attacker</strong> will send <strong>Bob</strong> a mail with a link to his site <code>http://attacker.nu</code>. Bob will click on this link and the browser will open the link. Untill now nothing happens. Once the browser will load the attackers site, the whole <strong>voodoo</strong> behind CSRF would take place. </p>
<h2 id="2d4dde52d975a2014c057771fa28ee31">CSRF fundamentals</h2>
<p>At this point I'd like to slow down things a little bit and focus on some details. In the past people have asked me some questions or made some observations regarding the whole process. Among these (I tried to apply the questions/observations to the previous example):</p>
<ol>
<li><em>"In a iframe you are able to load stuff (javascript, images etc.) via GET. How do you trigger a <strong>POST</strong> request at all?"</em></li>
<li><em>"The attackers site is not authentificated to <code>http://bank.nu</code>. Your triggered request is not going to work at all."</em></li>
<li><em>"Why should the browser trigger the request once the user visits the attackers site?"</em></li>
<li><em>"We do protect the session cookies by <code>httponly</code> and the <code>secure</code> flag. Why do you think this is going to work?"</em></li>
</ol>
<p>Well first let's see <strong>why</strong> this kind of attacks are so powerful. Apparently Bob can only trigger the transaction if he has a <strong>valid session</strong>. Otherwise the bank would
show some error message that the request is not allowed and a valid session is necessary. The authentification process usually looks like this:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1gAAAEfCAYAAABcXWdVAAAV4klEQVR4nO3dz3Ljyr0f8O4GwD+Szimfc53E5eNUKpuUy6/ipZd+hDxBKs/k8uouvMkij5GqJIvcslO+92b+SZRIAugshpjD4ZAipekZjojPp4o1FIgBWxIB/b7daCDmnGMAAADgs6VzNwAAAOBSCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACF1OduwLnFGPtzt4HzyjnraACAgtRXjLm+Gn3ACiGEnPO5m8CZxBhDzjmGEPLwNQDw+dRX4zX2+mq0yRIGfd/HzUFg+BcAgM8w5vrKCBaj13VdHWPsU0p5c0pDDCHksfW2AACUMub6yggWo7dcLqdt2zZd11V931dDb8u52wUA8FKNub4a9QjW2IYr2W+xWNxMJpNl0zTrpmlWIYSQUupCCDHG6ARyAHgC9RUhjLu+Gm3AMvGSwdu3b3+cz+e38/l8EUIIMcZljDHHGPuc8+gmZgLAc6mvGIy5vhptwArBQYD3Xr9+/cu2besQ3vesVFXVxhj7GONF7/wA8CWorwhh3PXVmAPW6K5own6vXr36NyGEUNd12zTNqq7rdVVVXc653xwA/KUAgNOorwghjLu+GnPACmEkE+143OvXr3/ZNM1yNpvdXV1dTXYmYl7szg8AX4j6ilHXV6O+iqAhbEII4e7u7vv7+/ub1Wo1a9u26fs+5ZyjzwcAPJ2/n4Qw7vpqlAFrDL9YTnd/f3+9Wq22LyWatk9v8HkBgOP8vWTbmOurUQasED78Ug1hE9q2nWx2/rrv+xR+Pn98FL0sAFCK+orBmOur0QYsGHRdVw87/2bo2h8GAIDPMOb6SsBi9HZ6VS56yBoA4GsYc30lYEH4aKcfTe8KAMCXNNb6SsACAAAoZOz3wbo4u3fG3h2OHV7/nGHaEtsAAIBLJGC9YPvC1BB6dl/bXgcAgP2OdVbDMQLWC7U9inQoTO1bf7B9sNh+bXt7u8931zWSBQBcklPqnn2vH6rHjtVSx7ajxnqZzMG6ANsjV09dZ99Of+j59nqnvi8AwEsTY3y0Dnrs68dqo6dsh5dLwCKEcPiUQgCAsdgNSLv10WP10m4n9Pb6h+bEP7YdIevlcorgBSjR2/Hc/6unBQC4FMOo1WOn/JWgbrpsAtYLNez4j53Xu+/r3eW729ne1lPfGwDgpdtXEx2ql3bnaO2OYh1a9pTt8PIIWC/Yvp3vOTvkse2Ueh8AgG/ZY/XNc+qhU/+PuuqymIMFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFAABQiIAFIYQY4/A0n7MdAACXYqz1lYDF6KWU+hBCjjHmED46GAAA8Axjrq/qczfgWzCmXzifqqqqraqqTSn1McYPBwIA4PnUV+M25vpqtAFrs9PnxWJxvVgsrt+8efMP//zP//zrv/3tb//hr3/963/8+9///u9fvXr1b29vb3+xXC7nbdtOu6778PPK+TI+I3/605/+0x/+8If/ce52fEnbB/iqqtq6rpfT6fT+5ubm9Q8//PD3uq5XdV2vh4NA+Lm3JfvjAACnU1+9p74ad301yoAVY/ywA8cYc0qpr6qqq+t6PZlMlvP5/O7q6urdarWahRBC0zTLtm2bvu/rS9nxt3333Xf/79xt+BpijCGl1NZ1vZ5Op/fX19dvr66u3s3n87vJZLLcHAS6oadl+/8BAI9TX31MfTXe+mqUAWsQY/xwANjs/A/z+fz2+vr67XK5nIUQwmQyeVitVrO2beucc8o5h5zzRc1d+/HHH//vudvwpcUY+83vu6/rup1MJg9XV1fvvv/++3+9vr5+O5/PbyeTyUNd1+utoexzNxsAXhz11Xvqq/HWV6MOWGEzVJlS6uq6Xs1ms/ubm5u36/V6GkII0+n04f7+/rpt20nXdXXf9xe14w9+/etf/+9zt+Fr2fSmtXVdr+bz+d319fXbX/ziF/9yc3Pzdjab3dd1vUopdcMQ9rnbCwAvkPoqqK/GXF+NOWDlncS9nM/nt23b1iG8H7a+ubl5s1qtpm3bNpvzg+MlDmH/9NNP//PcbfgahvPCNweA4XSF25ubm7c3NzevN70sy7qu202PzCgOAgBQkPpqQ3013vpqzAFrOGc0V1XVNU2zns/nixBCqOu6nc1md5uh62boXck5X+SY5k8//fS/zt2Gr2XrnPDhIPAwm83u5/P57Xw+XzRNM5wnPIohbAAoTX31nvpqvPXVaAPWMBEzxtinlGLTNKsQQkgpdU3TrK6uriabnb/a2fkv7lPxq1/96v+cuw1fyXAfho8m3tZ1vZpMJsumadZN06w25wj3m3XP22IAeEHUVz9TX423voqX2mtwqpxzzDnHvu9T3/ep67qqbdu67/tqWBY2P6dLHL4em2HibQghp5T6zaOr67odrnAzxvs1AEBJ6qtxUV99TMB6v1PH4eo1fd/HzdVs4vbj3O2krGEH33r0m2HrfjiX+NJ7VwDgS1FfjZP66j0f7o3h57A5EMTw8YRLP6PLMwxnh7C52tGww4+hZwUAvgb11eior4KA9ZFDO7yh68uzp/ckH1gOAHwG9dV4qK/eE7COuPSdP6XUX+r9J44Z284OAN8K9dXlUl+N+CqCpxrDh2QM3yMA8O0YQ+0xhu+R/UaZrAEAAL4EAQsAAKAQAQsAAKAQAQsAAKAQAQsAAKAQAQsAAKAQ98ECAAAoxAgWAABAIQIWAABAIQIWAABAIQLWyMUY+3O3AQDgkqivxk3AAgAAKETAAgAAKETAAgAAKETAAgAAKETAAgAAKETAAgAAKETAAgAAKCTmnOO5GwEAAHAJjGABAAAUImABAAAUImABAAAUImCNXIyxP3cbAAAuifpq3AQsAACAQgQsAACAQgQsAACAQgQsAACAQgQsAACAQgQsAACAQgQsAACAQmLOOZ67EfBUMcY+55x27zORc/6sToNhe5+7HQAAxqk+dwN4WR4LNNuvHVr+mOeEmuH/lLqhn2AFAMDnUEzyLLvBZnfkZ9/y7fBy6PkphtGrU9YbHvuW766zu/6h5wAAcIiAxVcxBJTdoDUoPXJ0SuDbDX+7bdj+v6VHygAAuEwC1sg9NzCcOldpN7h8bkA5dfQKAOBcdMiOm0KVZzk0ErXLRSMAABgTRS/PcuhiF/sC1fb8pX2n2p3ay7Nv9Gp3btT2qYj72nPoVL992zmlTQAAsM1l2kfuJZ1yV7qtRtcAgH0+t+Z4SfUV5blMOy9GiQNV6ftmAQCXSUcszyVgMSoOkgDAUwhaPJUPCgAAHOGemJzKHKyROeXAUPKy6gAAl+ip9ZIRsPFwiuAI5X/6x4Ovxd/8PuScY4wxh+BgAACMz7HAtK8+ekp9xWUTsNgn5vzz/u9gAADw2R3P6quRELD4RN/3VQghxxjz5jKjelwAgNEqcUaP+mo8BCw+0bbtNMbYpZS6lFLcHAT0tAAAo1JyqoT6ajwErBE59YImy+XypqqqVV3XqxDCOqUUYoydnhYAYAyeEqzUV+wSsPjEYrH4xWQyuc85LzaLckopu6IgAMDzqK/GQ8Aaie1Jlcfc3t7+w3w+fxtCCDHGbvPoY4xhM5T9xdoJAPBSqK/YR8Aaj5Pvefbu3btf5pxTSqmtqmpVVdU6pdTlnPvNzm8YGwBAfcUeAta4nHoA+CGltG6aZjGZTBZN01Sbg0cMdn4AgG3qKz7iJrJ8YrFYfP/w8HC9Xq9nXdfVfd+ncOLBAwCAT6mvxkPAGpFTzxN+eHiYr1aradu2Td/3Vc455ZzjU84zBgAYA/UVuwSscTmpl2S9Xk/btm26rqv6vk9bw9d6WQAAPqa+4iMCFp9o27ba7lkJ7ydwnrtZAAAvlvpqPAQsPrE1ZK1XBQCgAPXVeAhYfOLUy40CAHAa9dV4CFjsZcgaAKAs9dU4CFgAAACFCFg8Sk8LAEBZ6qvLJmBxkJ0fAKAs9dXlE7AAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKEbAAAAAKqc/dAAAAOCbG2A/Pc87pucvhS/NhAwDgmzaEpSEoDV8/dfmx9xgej31d+nvj8ghYAAB803LO6UuOQu0LZPvez0gYp/AhAQDgRdgNQl/zfYUrTuWDAgDAN+9c4Wr3/eEYAQsAgG/adrg6x1yop8zlAgELAIAXYTfg7Aaf4etDyw/Zt/72e22fIihkcYzLtAMA8E17LCAdeu2ppxLuru8iFzyXDwkAAEAhAhYAAEAhAhYAAEAhAhYAAEAhAhYAAEAhriIIAHCCr32j2+3LgR96z3PffPdzvfT2wz4CFvvkczcAAL60Q/dU+la2v3svpkPrPKdt34qX3n7YR8ACAEZnd+Rk96ayw/PHXn8sHBy6Ye2h7T+2/JRtPmU7pzp2U9/H3vfQ+s9p/77v+7FtP7aNY+04dblgyGN8OACA0Yox9jHGfrcwP/T18Hz79d3H7nvsrr9v+8eCw+7r29t8bL3dYHhsRGx3O09t/6H1d5c/pf2Hnm9vZ3d7+wLb7jqfs/yUnyHj5QMCAIzOoeL50NfHtrOvyC/tKds+FvSe8l77gtmxEah9YeQpAe9Uj4XbQ4Gr1HM4xIcEABidY6MRxwLTU0eDSgSLp2yjROB7LIQeGjV6ykhQCY+F20OnfZZ6DoeYgwUAjNK+uUTDPJtTXnssvBxa96nLD23v0PfyWPufcorboRGw4bXSc5wOtf+5AXHfvK1DbX7OciNZPEbAoigHHQBegmPh6DmvnbruU5Y/5/S0p77vU9c91s7PbUuJn8Mp65dsM2wTsCjCkDkAAAhYfCbBCgAAfiZg8YkYYwjvbzZ88IbDghUAAHxKwBq5+Jvff7Lsj3/843/d/vrNmze/Gp6nlLqj2xS+AIALZ04WhwhYhPxP/3jwtU0A+zCS1fd9dSxkOeAAADBWCmFOEXPOw+NJNyoEAIAxUSRz1NYN/GLYhK3t5WduHgAAfDMUxxzVdV3T932dc65yzlXYClkhCFoAADAwB4uj1uv1VUqp3dxZPW8eXc45xhg/zM8SsgAAGDsBi6Pu7++/jzH2KaU+pdRvnmdXCwQAgI8JWBx1d3f3wyZUtcNjM5oVcs7DfbMAAGD0BCyOur29/TGl1NZ1vazr+qGu61VKqcs591s3JQYAgNEzZ4ajbm9vf7i/v/9uuVxedV036fu+Gq4oeO62AQDAt0TA4qjFYvHdw8PD9Xq9nrZt2/R9n4JwBQAAnxCwOOrh4WG2Wq0mm3BVDffEytmZgQAAsE3A4qitkauq7/u0dXqgUSwAANgiYHFU13VpE6yGUwONXgEAwB4CFkdtTgkcTgs0agUAAAcIWBw1hCqjVgAA8DgBCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAoBABCwAAvpIY47mbwBcmYAEAwFckZF02AQsAAKAQAQsAAL4CI1fjIGBxVIwxb/49d1MAAF6koZ7i8glYHBVj7DeP7OAAAPB0O7WUeuqC1eduAF9f/M3vH/16V1VVfVVVfYyxD+8PCNloFgDAz47VU3VddymlbghaQT11sQSsccnL5fJ6uVxeLxaLH16/fv3vfvvb3/73v/zlL//53bt3Pz48PHz/8PBwtVqtrlar1STGmOfz+bvJZLKs63qdUmpTSv1Wz4veFwBg7D7UV3d3dz++evXq17/73e/+25///Of/8ubNm1+u1+tZ0zQPTdMs67peV1XVqacum4A1IjHGsBma7mOMXV3X6xBCmEwmq9ls9pBznoQQUkop1nW9jjHm2Wx2N51OF5PJZNk0zXq750WvCwAwdtv1VUrpQ301m83u1+v13Xq9bpumWc5ms/utTmv11AUTsMYnp5T6qqrauq6XIYQwm83u+r5vYoyxqqpuMpms2ratU0rddDq9u7m5eTubzW6HnpeU0nCqIAAAW/VV0zQPIYRwdXX1NudctW3b1HW9vrq6ejubze6apnmoqqpVT10uAWtccowxb3pXVtPp9D6E9weAGGNummY1nU7v27ad5pxTjLGdTqd319fXr66urt5Np9O7qqpWm14XQ9oAAJ/WV4sQQvjuu+9e1XW97rquqapqPZ/Pbzf11KKua/XUBROwxiNvhrD7lFJb1/VqMpnchxDC9fX1q7qu1+v1+r5t22nXdXXOOaaU2qZp7ufz+burq6vX0+n0rq7rZUqp3Z6geebvCwDgXHbrq+VWwPqX6XS66Pu+Sil1k8lkMZ/P324ClnrqgglYIxFjDDnnsN3DknP+ELAmk8l927azruuavu+rEELYrPcwmUwWm3lYi6Zptntc3BsLABitA/XVIoQQbm5u/rVt23c552oz9301mUzuJ5PJ7giWeurCCFgjs+lhiSGE9bBsPp+/mUwmi67rmpxzlXNOOefhXOJ1Xderuq6XVVWtqqpab65805/x2wAA+Gbsq6+urq5e931fbaZd9CmlrqqqVV3X6qkLJ2CNSIwx55zjZicPYTMcPZ1Ob/u+r4aDwNb6fUqpTyl1m0u0t9sHAzcdBgDG7kh9lUIIMWwughFj7DZ1lXrqgsWcszHJkRl+55uRqrh5pLDn87B1CdEP/26WOxgAAGzs1ldhp67aurmweurCCVgjtfN7jznnD8vipitmeDGl9NHkSwcDAIBP7auvPnzxfp6VemoEBCx2DwbDZM2P1nEQAAA43b4aWz01DgIWAABAIen4KgAAAJxCwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAAChEwAIAACjk/wPESr6unuywlQAAAABJRU5ErkJggg=="/></div></p>
<p>The user sends his credentials to the server, the server validates these and sends a <strong>cookie</strong> to the client which serves as authentification characteristic. 
Regardless of the expiration time of the cookie, <strong>every time</strong> the browser/client makes a request to the server, the cookie will be sent <strong>automatically</strong> to the server. 
This is a very important one and <strong>often misunderstood</strong> by non-sec people. </p>
<p>So next time the user wants to visit the site again, the browser will <strong>add</strong> the cookies received from the server to the request:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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3ajv+2p1RsFztw0AAL4mAhZ73d/ff/P4+Hi9WCzGbds2fd+nIFwBAMAnBCz2enx8nMzn89EyXFWra2LlbGYgAACsE7DYa23kqur7Pq1NDzSKBQAAawQs9uq6Li2D1WpqoNErAADYQsBir+WUwNW0QKNWAADwBAGLvVahyqgVAADsJmABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAMAXEmM8dxP4zAQsAAD4goSsyyZgAQAAFCJgAQDAF2DkahgELPaKMeblv+duCgDAi7Sqp7h8AhZ7xRj75U+2cwAAON5GLaWeumD1uRvAlxd/9dud9zdVVdVXVdXHGPvwfoeQjWYBAPxsXz1V13WXUupWQSuopy6WgDUseTabXc9ms+v7+/vvX79+/Q+//vWv/9ef/vSn//7u3bsfHh8fv318fLyaz+dX8/l8FGPM0+n03Wg0mtV1vUgptSmlfq3nRe8LADB0H+qru7u7H169evXjb37zm3/64x//+D/evHnzi8ViMWma5rFpmlld14uqqjr11GUTsAYkxhiWQ9N9jLGr63oRQgij0Wg+mUwec86jEEJKKcW6rhcxxjyZTO7G4/H9aDSaNU2zWO950esCAAzden2VUvpQX00mk4fFYnG3WCzapmlmk8nkYa3TWj11wQSs4ckppb6qqrau61kIIUwmk7u+75sYY6yqqhuNRvO2beuUUjcej+9ubm7eTiaT21XPS0ppNVUQAIC1+qppmscQQri6unqbc67atm3qul5cXV29nUwmd03TPFZV1aqnLpeANSw5xpiXvSvz8Xj8EML7HUCMMTdNMx+Pxw9t245zzinG2I7H47vr6+tXV1dX78bj8V1VVfNlr4shbQCAT+ur+xBC+Oabb17Vdb3ouq6pqmoxnU5vl/XUfV3X6qkLJmANR14OYfcppbau6/loNHoIIYTr6+tXdV0vFovFQ9u2467r6pxzTCm1TdM8TKfTd1dXV6/H4/FdXdezlFK7foDmmd8XAMC5bNZXs7WA9e/j8fi+7/sqpdSNRqP76XT6dhmw1FMXTMAaiBhjyDmH9R6WnPOHgDUajR7atp10Xdf0fV+FEMLyeY+j0eh+eRzWfdM06z0uro0FAAzWE/XVfQgh3Nzc/Efbtu9yztXy2Pf5aDR6GI1GmyNY6qkLI2ANzLKHJYYQFqtl0+n0zWg0uu+6rsk5VznnlHNezSVe1HU9r+t6VlXVvKqqxfLMN/0Z3wYAwFdjW311dXX1uu/7annYRZ9S6qqqmtd1rZ66cDHnLDIPyPL7jjnn1Pd96vu+6vu+Xv5b5Zw/XHx6uTPoU0rd8hTt7drOwEWHAQDC9voq51z1fZ9CCDEsT4IRY+yWdZV66oIJWAO0+s6XI1Vx+ZPClr+HtVOIfvh3udzOAABgabO+Cht11drFhdVTF07AGqiN7z3mnD8sizHGnPOHDT6l9NHBl3YGAACf2lZffbjz/jgr9dQACFhs7gxWB2t+9Bw7AQCAw22rsdVTwyBgAQAAFJL2PwUAAIBDCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACFCFgAAACF/H8oxZWIOsJrygAAAABJRU5ErkJggg=="/></div></p>
<p>That in turn means that every time a request is conducted by your browser - whether intended by the user or not - the session cookie will be <strong>always</strong> be sent 
along with the request. </p>
<h2 id="007233f8fd8f7e131056ddd1a3d73606">The attack</h2>
<p>Recalling a few thoughts made some sentences ago, the attack will consist of following steps:</p>
<ol>
<li>Send a malicious link to <strong>Bob</strong></li>
<li>Bob will click the link and the browser will open the malicious site</li>
<li>The malicious site will trigger a <strong>POST</strong> request to <code>http://bank.nu</code> and try to make a money transfer</li>
<li>This is going to work <strong>only and if</strong> Bob is logged in (has a valid session cookie) on the bank site</li>
</ol>
<p>Trying to be more precise, these are the requests made:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>As you have noticed the <strong>session cookie</strong> is part of the POST request. The attackers site <strong>can't</strong> read the cookie due to several reasons: </p>
<ul>
<li>the <strong>domain</strong> attribute of the cookie restricts the availability of the cookie only to the <code>bank.nu</code> domain<ul>
<li>that means that the browser will only set the cookie if the request is made to <code>bank.nu</code></li>
</ul>
</li>
<li>the <strong>httpOnly</strong> flag is set<ul>
<li>no JavaScript can read the cookie</li>
</ul>
</li>
</ul>
<p>But the attacker doesn't have to know the cookie. In the case of CSRF he/she will fire up a request assuming that the victim is <strong>authentificated</strong> against <code>bank.nu</code>. If not, the 
attack will have no consequences since the POST request won't be accepted by the server.</p>
<h2 id="8304512816e26767b8137d5ab36e7905">The defense</h2>
<p>Since it is the <strong>natural</strong> behaviour of the browser to add the cookies to some specific requests (in order to tell the server that the user is authentificated), 
the mitigation of such attacks has to be done somewhere else. The <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#General_Recommendation:_Synchronizer_Token_Pattern">generic solution</a> consists of adding some <strong>random secure token</strong> which has to be:</p>
<ul>
<li>unique per user/session</li>
<li>tied to only <strong>one</strong> session</li>
<li>generated by a secure PRNG</li>
</ul>
<p>The <strong>client</strong> has to provide this token in its requests. The server will reject the request/action if the token is not valid. Sounds simple, isn't it? There are two ways to do it:</p>
<h3 id="0a74ece5651a0dc38158844dd93f9308">Provide the token in a hidden field (Synchronizer Token Pattern)</h3>
<p>If the client wants to perform an action (like sending a POST request), the server will put inside the <strong>body</strong> content a hidden token which the client has to provide when sending the POST request:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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CwGLnfpQpdcKAAAeJmABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUUh+7AVBCjLHLOad+OoQQ+ufP3Y5++im2/9TrBwDg6whYfJWUUjt8Piz6t4WB4fyHvLYA8RzBLuec9v39AQDw/AQsiugL/74naRg2ts0P4fNQsml6H5t6r/Zd90PPN7V3fRub1rHtPe563+vb2fQ+d81/baEUAODUKMY4imHo2hQKHhsUhj83XPe24YObnm+bHv67bf3r8/fZ3j7vd9tyD4U5AACen4BFEfsGhfVA9bWBYBiC9jUMRYcGk/W27/tzDy23KaQBAPA6KegoYltP1LrnvgDFrhD0mPY8JiT2PyNEAQCcNsUeRWw6L2k4f1vPz0PnTu2zzYeGF247z2nT+g/Z5npo27T+Te9vOP+h9mwKhdt+Ty/hyokAAPzERS74Kl3XVTHGvOm1Q86tKh0M1td36HbXz6l67Hq2vXbo8o/dNgAAz0thxqslWAAA8NIoUAEAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAoRsAAAAAqpj90AXr8YY9dP55yLh/ZD198vv2vZp243AADjo6ikmKcKKdvWG2Ps+kfJ9QIAPIF87AbwPPRg8Spt66Uahq31ZXb1WO1afvj6Q8vus471ZXfNFwYBAF4HRRuv0q5g00+vL7ft57a9Pny+bXq4reE219uzvuwh8x/zOwIA4Pkp3HiV1nuqHjtMcOihXq192rNtyOK2wHXoNAAAL58hgrw6Dw3V27bsvutdX8++Aeeh5dbD4KZetH3mAwDw8inceDLbepYOnb9uWxDZ9vpDQwU3/cx62PmaHrJN2xuub9/5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"/></div></p>
<p>The token should change every time the site is loaded again. That means that the server should <strong>not</strong> accept 2 POST requests with the <strong>same</strong> token value.</p>
<h3 id="946a7a2766612c2ed85c65e7dc7a7118">Provide session based CSRF token (Double Submit Cookies)</h3>
<p>Once the client has authentificated against the server, the server will send the client a CSRF token which will be used for <strong>every</strong> request. The token value <strong>doesn't change</strong> and remains the same for the whole session.</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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mSKmlNrb6FXfAQBg7hTJ7NUGqpRSDNuw1V1+5O4BAMCboThmr7qul03TlCmlRUppETohKwRBCwAAWo7BYq/NZnNdFEW1vXJ62t7qlFKMMX4+PkvIAgBg7gQs9rq/v38fY2yKomiKomi295OzBQIAwJcELPb6+PHjt9tQVbW37WhWSCm1180CAIDZE7DY6/b29ruiKKqyLB/Lsnwoy3JdFEWdUmo6FyUGAIDZc8wMe93e3n57f3//zePj43Vd16umaRbtGQWP3TcAAHhLBCz2uru7++bh4eFms9lcVFW1bJqmCMIVAAB8RcBir4eHh8v1er3ahqtFe02slMwMBACALgGLvTojV4umaYrO9ECjWAAA0CFgsVdd18U2WLVTA41eAQDAAAGLvbZTAttpgUatAABghIDFXm2oMmoFAAC7CVgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZCFgAAACZlMfuAMAMNMfuAPTYwQrwQnzBAgAAZCJgAQAAZCJgAQAAZCJgAQAAZCJgAQAAZOIsggBvXIzxi8cppcHn+8ufso1D2uj26znbPke7fp85/l4AvF0CFsAbMhSm2kK8/1x3nWNIKY32iXGCFcB5E7AA3ojuyMaU4LJrZKs/ujTU9lBwmzq6Mta/sVGtKcufst2h1zD2+5vSnynb3dfO2O8z19+rv/7U1wDA63AMFsAb1B25OnSdoQA1dr+73tTtjoWwseC2b/mh2+2vv+v1Dv38roC5a7tTX9fY7zPX3+vQ3xsAr0vAAjhTb2363r4RnH39PXT97s/sCjZT29i1/msGnaf8HgB4PaYIArxBOU6E8NSffamTMAy1NzQ6s2u7u0ZzcvRnyJSpm699UotDf28AvB4BC+CNaAv4fVPYphT5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pE9PWQ4AvKyhWS0wlYDFs730F9CpfsGNTfU7dDkA8PpyHePN/AhY8EKMWAHA6RO0OJQ3CgAA7PHcY7JjjCF8utiwCw6fOSNYHOTXv/71fzt2HwAAjmXKiFb81W++Wvbb3/72n7qPf/jhh59n7xxvgoDFQf74xz/+/fv37/9ycXFxW5bluiiKOsZoTwwAcDb2jVRNmS6Y/vT78fY/BTD105kSsAAAYILMx2HFlFJ7a6cQcgYELAAA2OElTnDRXqczpRTDp7AVzAo6D05yAQAAA9oQ9BJt13W9bJqmTCktUkqLsB3Reolt8bqMYAEAQMdrnJJ9s9lcF0VRbc9OmLa3OqUUjWSdNgELAABe2f39/fsYY1MURVMURbO9n55zKnjeBgELAABe2cePH7/dhqqqvW1Hs4KTXpw2AQsAAF7Z7e3td0VRVGVZPpZl+dBe/ial1HQuSswJcpILAAB4Zbe3t9/e399/8/j4eF3X9appmkV7RsFj943nEbAAAOCV3d3dffPw8HCz2WwuqqpaNk1TBOHqLAhYAADwyh4eHi7X6/VqG64W7TWxUjIz8NQJWAAA8Mo6I1eLpmmKzvRAo1gnTsACAIBXVtd1sQ1W7dRAo1dnQsACAIBXtp0S2E4LNGp1RgQsAAB4ZW2oMmp1fgQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATMpjdwAAAPaJMTbt/ZRS8dTl8NK82ZgiHbsDAMB8tWGpDUrt40OX79tGe9v1OPdr4/wIWAAAvGkppeIlR6GGAtnQ9oyEMYU3CQAAJ6EfhF5zu8IVU3mjAADw5h0rXPW3D/sIWAAAvGndcHWMY6EOOZYLBCwAAE5CP+D0g0/7eGz5mKH1u9vqThEUstjHadp5UeYsAwDPtauWGHvu0Pqjv76TXPBUAhYvwt4dAADmSMAiK8EK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"/></div></p>
<p>The interesting thing about this approach is the fact that the token is sent <strong>twice</strong>. The CSRF token is being sent to the client as a <em>cookie</em>. 
That means that this specific cookie will be sent automatically by the browser when some requests are triggered (<strong>natural</strong> behaviour, remember?). 
At first look this approach doesn't look secure, since the <strong>session</strong> cookie <strong>and</strong> the <strong>csrf</strong> token will be sent automatically by the browser
in case of a <strong>forged</strong> request. Remember that the <strong>attacker</strong> doesn't have to know the cookie values. He/she just <strong>forges</strong> the request and since the
server can't distinguish between a <strong>legitimate</strong> and a <strong>forged</strong> request, the attack will be successful.</p>
<p>However, in the <em>Double Submit Cookies</em> approach the token value <strong>has</strong> to be sent more than once: Either as a <em>GET</em> or <em>POST</em> parameter. So the big question here is: Why is this secure? Well due to the fact that the token value has to be submitted somewhere else, the attacker will have to <strong>read</strong> this value - which is <strong>not possible</strong>. The attacker <em>can</em> forge the request but he can't <em>get</em> the response. The reason therefore is called <strong>SOP</strong> (Same Origin Policy) and prevents <strong>cross-requests</strong> (aka from other domains) to be performed. In our case a script hosted at <code>attacker.nu</code> would <strong>not</strong>  be able to get "ressources" from <code>bank.nu</code> when executed in the browser. </p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>This is the reason the attacker <strong>can't</strong> read the token value even though he is able to <em>forge</em> requests. Providing the token value <strong>twice</strong> make this approach secure since the attacker can't read the token value and therefore can't forge a valid request (accepted by the server). </p>
<h2 id="6f8b794f3246b0c1e1780bb4d4d5dc53">Conclusion</h2>
<p>There are some other patterns I'm aware of (there might more!):</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#Encrypted_Token_Pattern">Encrypted Token Pattern</a></li>
<li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/csrf.html">token interceptors</a></li>
</ul>
<p>But the most valuable "take-home-lesson" is not about the technical details regarding the solutions. When discussing solutions several things should be always
considered:</p>
<ul>
<li>The browser will <strong>always</strong> send available (regarding to the domain) cookies within the requests (whether its a page, JS, CSS, JPG whatever)</li>
<li>If <strong>XSS</strong> is possible, you have bigger problems<ul>
<li><strong>SOP</strong> offers no protection anymore </li>
</ul>
</li>
<li>Make sure the CSRF token is <strong>random</strong> and <strong>unique</strong> per session</li>
<li>When storing the CSRF token as a <strong>cookie</strong>, make sure you <strong>double</strong> check the value<ul>
<li>The client <strong>has</strong> to provide the token as a GET/POST parameter</li>
<li>Don't rely on the validation based on the cookie</li>
</ul>
</li>
</ul>
                </div>
<hr/>
<div style="float:left;">
	Prev: <a href="http://blog.dornea.nu/2016/01/15/howto-put-nginx-and-php-to-jail-in-debian-8" align='left'>
	 HowTo: Put nginx and PHP to jail in Debian 8
	</a>
</div>
<div style="float:right;">
    Next: <a href="http://blog.dornea.nu/2016/02/01/steve-jobs-by-walter-isaacson" align='right'>
	 Steve Jobs by Walter Isaacson
	</a>
</div>
</p>

                <!-- Add comments -->
<div id="content-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname="dorneanu";
				var disqus_identifier = 'some-words-on-csrf-and-cookies';
			var disqus_url = 'http://blog.dornea.nu/2016/01/26/some-words-on-csrf-and-cookies';

		var disqus_config = function () {
			this.language = "en";
		};
 
        
        (function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
            </div>
            <div class="niu2-right-container col-md-2">
                <div id="niu2-sidebar-meta" class="niu2-sidebar">
                    <div class="niu2-sidebar-label"><i class="icon-calendar"></i>Published:</div>
                    <div class="niu2-sidebar-value">2016-01-26 00:00</div>
                    <div class="niu2-sidebar-label"><i class="icon-pencil"></i>category:</div>
                    <div class="niu2-sidebar-value"><a href="http://blog.dornea.nu/category/blog">blog</a></div>
                    <div class="niu2-sidebar-label"><i class="icon-tag"></i>Tag:</div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/appsec/">appsec</a><sup>25</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/web/">web</a><sup>14</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/javascript/">javascript</a><sup>5</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/csrf/">csrf</a><sup>2</sup></div>
                </div>

                <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
                    <div class="niu2-sidebar-label">
                        <i id="niu2-sidebar-toc-ctrl" class="icon-open-tocs"></i>Table of contents
                    </div>
                    <ul id="niu2-sidebar-toc-list">
                        <li><a href="#content-heading">Some words on CSRF and cookies</a></li>
                        <li><a href='#6432f4693afd88598023fe78739fb577'>General idea</a></li><li><a href='#c0fa85353677943560ac0bca6672d54d'>Some example</a></li><li><a href='#2d4dde52d975a2014c057771fa28ee31'>CSRF fundamentals</a></li><li><a href='#007233f8fd8f7e131056ddd1a3d73606'>The attack</a></li><li><a href='#8304512816e26767b8137d5ab36e7905'>The defense</a><ul><li><a href='#0a74ece5651a0dc38158844dd93f9308'>Provide the token in a hidden field (Synchronizer Token Pattern)</a></li><li><a href='#946a7a2766612c2ed85c65e7dc7a7118'>Provide session based CSRF token (Double Submit Cookies)</a></li></ul></li><li><a href='#6f8b794f3246b0c1e1780bb4d4d5dc53'>Conclusion</a></li>
                        <li><a href="#content-comments">Comments</a></li>
                    </ul>
                </div>
            </div>
            <div id="niu2-toolbar">
                <ul class="list-unstyled">
                    <li><a id="niu2-toolbar-ctrlsidebar" href="#" title="Hide Sidebar"><i class="icon-3x icon-hide-sidebar"></i></a></li>
                </ul>
                <div id="niu2-toolbar-showsidebar" data-title="Show Sidebar"></div>
                <div id="niu2-toolbar-github" data-repo=""></div>
                <div id="niu2-toolbar-bitbucket" data-repo=""></div>
            </div>
            <div id="niu2-toc" data-style="fixed"></div>
        </div>

        <div class="niu2-footer">
            <div id="body-footer" class="col-md-6 col-md-offset-2">
                <hr/>
                <p>
                    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
                    <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="https://github.com/twbs/bootstrap">Bootstrap3</a>
                    by <a href="https://blog.mawenbao.com">Ma Wenbao</a>, icons by 
                    <a href="https://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
                </p>
                <p>
                    © 2008 - 2016
                    <a class="niu2-footer-link" href="http://blog.dornea.nu">Victor Dorneanu</a>
                </p>
                <p class="niu2-icons">
                    <a class="niu2-footer-icon" href="https://pgp.mit.edu/pks/lookup?op=get&search=0x18F1AD46FB05E1B7" title="my public key">
                        <i class="icon-key icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="mailto: no-spam ÄATT dornea DOT nu" title="my email address">
                        <i class="icon-envelope-o icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="http://github.com/dorneanu" title="my github page">
                        <i class="icon-github-alt icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="/feeds/rss.xml" title="subscribe my blog">
                        <i class="icon-rss icon-lg"></i>
                    </a>
                </p>
            </div>
        </div>

        <script type="text/javascript">
            var _gaq=_gaq||[];
            _gaq.push(["_setAccount","UA-7161767-3"]);
            _gaq.push(["_trackPageview"]);
            (function(){
                var b=document.createElement("script");
                b.type="text/javascript";
                b.async=true;
                b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";
                var a=document.getElementsByTagName("script")[0];
                a.parentNode.insertBefore(b,a)
            })();
        </script>
        <div id="niu2-pygments" data-theme="github"></div>
        <div id="niu2-lazy-load" data-loading-txt="Loading image" data-loading-icon="icon-spin icon-spinner"></div>
        <div id="niu2-toolbar-load" data-loading-icon="icon-spin icon-4x icon-spinner"></div>
        <script type="text/javascript" src="/js/custom.js"></script>
        <script type="text/javascript">
            onContentLoaded();
        </script>
    </body>
</html>