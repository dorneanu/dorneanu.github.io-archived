<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="appsec, web, javascript, csrf">
        <meta name="description" content="Being involved in different projects where web technologies are used, I have to make sure that AppSec related security nightmares are avoided. One of those security nightmare - and in my own oppinion the most complicated one to explain to a non-sec person - is CSRF. I won't go into details ...">
        <title>Some words on CSRF and cookies - blog.dornea.nu</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
        <link rel="stylesheet" href="/css/ipython.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/font-icons/style.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/niu2.min.css" type="text/css" />
        <link rel="stylesheet" href="/css/custom.css" type="text/css" />
		
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/niu2.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>
        
        <link rel="canonical" href="http://blog.dornea.nu/2016/01/26/some-words-on-csrf-and-cookies" />
        <script type="text/javascript">window.onload=function(){};</script>
        <!--[if lt IE 9]>
            <script src="http://blog.dornea.nu/theme/js/html5shiv.js"></script>
            <script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>
        <![endif]-->
    </head>
    <body> 
        <div id="body-header">
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="col-md-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://blog.dornea.nu">
                            <i class="icon-home"></i>blog.dornea.nu
                        </a>
                    </div>
                    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="http://dornea.nu" title="about">
                                <i class="icon-user"></i>about</a>
                            </li>
                            <li><a href="/archives.html" title="archives">
                                <i class="icon-archive"></i>archives</a>
                            </li>
                            <li><a href="/tags.html" title="tags">
                                <i class="icon-tag"></i>tags</a>
                            </li>
                            <li><a href="/feeds/rss.xml" title="feeds">
                                <i class="icon-rss"></i>feeds</a>
                            </li>
                        <!-- category dropdown list -->
                        <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="icon-folder-open"></i>category<b class="caret"></b>
                           </a>
                           <ul class="dropdown-menu">
                               <li><a href="http://blog.dornea.nu/category/blog">
                                      <i class="icon-pencil"></i>blog
                                      (113)</a></li>
                               <li><a href="http://blog.dornea.nu/category/low">
                                   <i class="icon-folder-close"></i>LOW
                                      (27)</a></li>
                               <li><a href="http://blog.dornea.nu/category/notes">
                                      <i class="icon-book"></i>notes
                                      (21)</a></li>
                           </ul>
                        </li>
                        <!--  self defined dropdown list -->
                        </ul>
                        
                        <!-- right nav bar -->
                        <ul class="nav navbar-nav navbar-right">
                        <!-- google custom search -->
                        <li>
                        <div id="niu2-cse-wrapper">
                            <div id="niu2-cse-header-box" class="navbar-form navbar-nav">
                                <form action="http://google.com/cse">
                                    <input type="hidden" name="cx" value="008508447409818574933:pxyxuhrgnxi" />
                                    <input type="hidden" name="ie" value="UTF-8" />
                                    <div class="form-group">
                                        <input id="niu2-cse-search-input" class="niu2-cse-header form-control" 
                                            type="text" name="q" 
                                            placeholder="Press enter to search ..."/>
                                    </div>
                                </form>
                           </div>
                           <div id="niu2-cse-ctrl-box" class="navbar-nav">
                            <i id="niu2-cse-search-image" class="icon-search navbar-nav"></i><span id="niu2-cse-search-text">Search</span>
                           </div>
                       </div>
                       </li>
                       </ul>
                    </nav>
                </div>
            </div>
<style>
    #banner{
        background-image:url("http://blog.dornea.nu//images/header.jpg");
    }   
</style>

<div id="banner">
    <div class="container">
        <div class="copy">
            <h2>blog.dornea.nu</h2>
                <p class="intro">Hack, code and drink some țuică. Personal blog of Victor Dorneanu.</p>
        </div>
    </div>
</div>
            <!-- End Banner -->
        </div>

        <div id="body-content">
            <div class="col-md-8 col-md-offset-2">
                <h1 id="content-heading">Some words on CSRF and cookies</h1>
            </div>
            <div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
                <div id="niu2-main-content">
                    <p>Being involved in different projects where web technologies are used, I have to make sure that <a href="http://blog.dornea.nu/tag/appsec/">AppSec</a> related security nightmares
are avoided. One of those security nightmare - and in my own oppinion the most complicated one to explain to a <strong>non-sec</strong> person - is <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">CSRF</a>. I won't go into details since these are freely available. Furthermore I would like to focus on the <strong>countermeasures</strong> one would implement to prevent CSRF. In some cases it's suggested to think of some attack scenarios before relying on the implemented solution. But first let's have a look how a typical CSRF attack works like. </p>
<h2 id="6432f4693afd88598023fe78739fb577">General idea</h2>
<p>Usually we have 3 components involved:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>The <strong>client/browser</strong> communicates with the <strong>server</strong> and the <strong>attacker</strong> will try to <em>lure</em> the user to some previously <strong>prepared site</strong>. This can happen by sending 
<strong>mails</strong> with some malicious link or injecting content into a site the user is visiting (e.g. using <strong>iframes</strong>). This way the attack will cause the client/browser 
to fire requests to the server <strong>without</strong> any user interaction. The user behing the client/browser won't notice anything since this will happen in the background by just visiting the site and/or triggering some JavaScript to execute. </p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<h2 id="c0fa85353677943560ac0bca6672d54d">Some example</h2>
<p>Now let's think of some <strong>real-world</strong> example. User <strong>Bob</strong> has an account on <code>http://bank.nu</code>. Attacker <strong>Victor</strong> will prepare a site <code>http://attacker.nu</code> which once accessed will load following <strong>iframe</strong>:</p>
<div class="highlight"><pre><span class="nt">&lt;iframe</span> <span class="na">style=</span><span class="s">"display:none"</span> <span class="na">name=</span><span class="s">"csrf-frame"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"http://bank.nu/transfer.do"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"csrf-form"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"acct"</span> <span class="na">value=</span><span class="s">"Victor"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"amount"</span> <span class="na">value=</span><span class="s">"10.000"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"View my pictures"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"csrf-form"</span><span class="p">).</span><span class="nx">submit</span><span class="p">()</span><span class="nt">&lt;/script&gt;</span>
</pre></div>
<p>In this case the <strong>iframe</strong> ins't visible at all (<code>display:none</code>) and some JavaScript will trigger the submission of the form once the <code>script</code>tag is loaded aka the user enters the site. In this fictional example the form will trigger a <code>POST</code> request which will <strong>transfer</strong> some money to the <strong>attacker</strong> (Victor). Next the <strong>attacker</strong> will send <strong>Bob</strong> a mail with a link to his site <code>http://attacker.nu</code>. Bob will click on this link and the browser will open the link. Untill now nothing happens. Once the browser will load the attackers site, the whole <strong>voodoo</strong> behind CSRF would take place. </p>
<h2 id="2d4dde52d975a2014c057771fa28ee31">CSRF fundamentals</h2>
<p>At this point I'd like to slow down things a little bit and focus on some details. In the past people have asked me some questions or made some observations regarding the whole process. Among these (I tried to apply the questions/observations to the previous example):</p>
<ol>
<li><em>"In a iframe you are able to load stuff (javascript, images etc.) via GET. How do you trigger a <strong>POST</strong> request at all?"</em></li>
<li><em>"The attackers site is not authentificated to <code>http://bank.nu</code>. Your triggered request is not going to work at all."</em></li>
<li><em>"Why should the browser trigger the request once the user visits the attackers site?"</em></li>
<li><em>"We do protect the session cookies by <code>httponly</code> and the <code>secure</code> flag. Why do you think this is going to work?"</em></li>
</ol>
<p>Well first let's see <strong>why</strong> this kind of attacks are so powerful. Apparently Bob can only trigger the transaction if he has a <strong>valid session</strong>. Otherwise the bank would
show some error message that the request is not allowed and a valid session is necessary. The authentification process usually looks like this:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>The user sends his credentials to the server, the server validates these and sends a <strong>cookie</strong> to the client which serves as authentification characteristic. 
Regardless of the expiration time of the cookie, <strong>every time</strong> the browser/client makes a request to the server, the cookie will be sent <strong>automatically</strong> to the server. 
This is a very important one and <strong>often misunderstood</strong> by non-sec people. </p>
<p>So next time the user wants to visit the site again, the browser will <strong>add</strong> the cookies received from the server to the request:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>That in turn means that every time a request is conducted by your browser - whether intended by the user or not - the session cookie will be <strong>always</strong> be sent 
along with the request. </p>
<h2 id="007233f8fd8f7e131056ddd1a3d73606">The attack</h2>
<p>Recalling a few thoughts made some sentences ago, the attack will consist of following steps:</p>
<ol>
<li>Send a malicious link to <strong>Bob</strong></li>
<li>Bob will click the link and the browser will open the malicious site</li>
<li>The malicious site will trigger a <strong>POST</strong> request to <code>http://bank.nu</code> and try to make a money transfer</li>
<li>This is going to work <strong>only and if</strong> Bob is logged in (has a valid session cookie) on the bank site</li>
</ol>
<p>Trying to be more precise, these are the requests made:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>As you have noticed the <strong>session cookie</strong> is part of the POST request. The attackers site <strong>can't</strong> read the cookie due to several reasons: </p>
<ul>
<li>the <strong>domain</strong> attribute of the cookie restricts the availability of the cookie only to the <code>bank.nu</code> domain<ul>
<li>that means that the browser will only set the cookie if the request is made to <code>bank.nu</code></li>
</ul>
</li>
<li>the <strong>httpOnly</strong> flag is set<ul>
<li>no JavaScript can read the cookie</li>
</ul>
</li>
</ul>
<p>But the attacker doesn't have to know the cookie. In the case of CSRF he/she will fire up a request assuming that the victim is <strong>authentificated</strong> against <code>bank.nu</code>. If not, the 
attack will have no consequences since the POST request won't be accepted by the server.</p>
<h2 id="8304512816e26767b8137d5ab36e7905">The defense</h2>
<p>Since it is the <strong>natural</strong> behaviour of the browser to add the cookies to some specific requests (in order to tell the server that the user is authentificated), 
the mitigation of such attacks has to be done somewhere else. The <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#General_Recommendation:_Synchronizer_Token_Pattern">generic solution</a> consists of adding some <strong>random secure token</strong> which has to be:</p>
<ul>
<li>unique per user/session</li>
<li>tied to only <strong>one</strong> session</li>
<li>generated by a secure PRNG</li>
</ul>
<p>The <strong>client</strong> has to provide this token in its requests. The server will reject the request/action if the token is not valid. Sounds simple, isn't it? There are two ways to do it:</p>
<h3 id="0a74ece5651a0dc38158844dd93f9308">Provide the token in a hidden field (Synchronizer Token Pattern)</h3>
<p>If the client wants to perform an action (like sending a POST request), the server will put inside the <strong>body</strong> content a hidden token which the client has to provide when sending the POST request:</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1gAAAHICAYAAABTZkvCAAAfKklEQVR4nO3dzZLrxt0f4O4GSA5njmRJzodiqVzJJuVF7kRLL7XwNlVZZ/Vek5deuLzMLWSVqiRVjstO7LzROdJ8kQTQWQwhUTz8nOkZzhDPUzV1QBAEmjMkzv+HBhox5xwDAAAAT5ZO3QAAAIBzIWABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUImABAAAUUp+6AacWY+xO3QZOK+fsQAMAFKS+Ysj11eADVggh5JxP3QROJMYYcs4xhJD7xwDA06mvhmvo9dVgkyX0uq6Ly6MscbkzAADgCYZcX+nBYvDatq1jjF1KKccY+8NteWhHWwAAShlyfaUHi8GbzWaTpmlGbdtWXdel5VGW8//2AwA8kyHXV4PuwRpadyWb3d7evhuPx/PRaDQfjUbzEEJIKXUhhLByxAUAOID6ihCGXV8NNmC58JLe999//8V0Or2ZTqc3IYQQY5zFGHOMMeecB3dhJgA8lvqK3pDrq8EGrBAcYeHB+/fv/0XTNHUID0dWqqpqYoxdfOB/CgA4gvqKEIZdXw05YEVHWQghhO++++5fhhBCXdfNaDSa1XU9r6qqzTl38eHwig8KABxGfUUIYdj11ZADVggDudCO3d6/f//L0Wg0u7i4uL28vLzuuq5auRDzbL/8APBM1FcMur4a9CiCjrAQQgg3Nze/uLu7u5rP55OmaUb9DsDnAwCO5/9PQhh2fTXIgLXyh3WEhbD88l80TVMvhxKNq0OJDmFHAABPpb5i1ZDrq0EGrBDO+4/KcZqmGS/v01B3XVeFlTuO+5wAwOH8v0lvyPXVYAMW9Nq2rVdugmf0IwCAJxpyfSVgMXhd16UQQso5pxAMLwsA8FRDrq8ELAjOGwcAKG2o9ZWABQAAUMjQ74N1dh7u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"/></div></p>
<p>The token should change every time the site is loaded again. That means that the server should <strong>not</strong> accept 2 POST requests with the <strong>same</strong> token value.</p>
<h3 id="946a7a2766612c2ed85c65e7dc7a7118">Provide session based CSRF token (Double Submit Cookies)</h3>
<p>Once the client has authentificated against the server, the server will send the client a CSRF token which will be used for <strong>every</strong> request. The token value <strong>doesn't change</strong> and remains the same for the whole session.</p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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IYduvvRFLaa+bwC8HAEL4JXoCvh9h7AdUuT3RzYOOdxwaNmHzNste6yNsf7sO09qbP2G5j+077v6s8+h6zu0jKH1Hft7HXP+m3AF8HoIWACvyK5RnpztnLqcsXmnTJ+6XoeMbA1NGzpMMMe6Tn3t2P7vegzA6+McLAAAgEwELAAAgEwELAAAgEwELAAAgEwELAAAgEwELAAAgExcph3g+dmZBQAz4T99AACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATAQsAACATKpzdwByiDG2KaWiexxCCN3zl+5H9/g5lv/c7QMAcBoBi5MURdFsP98u+sfCwPb0Xd5agHiJYJdSKg59/wAAeHkCFll0hX83krQdNsamh/DTUDL0+BBDo1eHtr3r+VB/+8sYamNsHfetd385Q+u5b/pbC6UAAJdGMcZZbIeuoVBwbFDY/r3ttscOHxx6PvZ4+9+x9vvTD1neIes7Nt+uMAcAwMsTsMji0KDQD1SnBoLtEHSo7VA0NZj0+37o7+2abyikAQDwNinoyGJsJKrvpS9AsS8EHdOfY0Ji9ztCFADAZVPskcXQeUnb08dGfnadO3XIMncdXjh2ntNQ+1OW2Q9tQ+0Prd/29F39GQqFY+/Ta7hyIgAAP3KRC07Stm0ZY0xDr005typ3MOi3N3W5/XOqjm1n7LWp8x+7bAAAXpbCjDdLsAAA4LVRoAIAAGQiYAEAAGQiYAEAAGQiYAEAAGTiKoKcXf+S57vmeY4LWxza9iH9BABg3gQsTjZ2z6ZD9e8jNTbPMX3L6ZB+AgAwbwIWJymKoglhOHyMjfjsGwka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"/></div></p>
<p>The interesting thing about this approach is the fact that the token is sent <strong>twice</strong>. The CSRF token is being sent to the client as a <em>cookie</em>. 
That means that this specific cookie will be sent automatically by the browser when some requests are triggered (<strong>natural</strong> behaviour, remember?). 
At first look this approach doesn't look secure, since the <strong>session</strong> cookie <strong>and</strong> the <strong>csrf</strong> token will be sent automatically by the browser
in case of a <strong>forged</strong> request. Remember that the <strong>attacker</strong> doesn't have to know the cookie values. He/she just <strong>forges</strong> the request and since the
server can't distinguish between a <strong>legitimate</strong> and a <strong>forged</strong> request, the attack will be successful.</p>
<p>However, in the <em>Double Submit Cookies</em> approach the token value <strong>has</strong> to be sent more than once: Either as a <em>GET</em> or <em>POST</em> parameter. So the big question here is: Why is this secure? Well due to the fact that the token value has to be submitted somewhere else, the attacker will have to <strong>read</strong> this value - which is <strong>not possible</strong>. The attacker <em>can</em> forge the request but he can't <em>get</em> the response. The reason therefore is called <strong>SOP</strong> (Same Origin Policy) and prevents <strong>cross-requests</strong> (aka from other domains) to be performed. In our case a script hosted at <code>attacker.nu</code> would <strong>not</strong>  be able to get "ressources" from <code>bank.nu</code> when executed in the browser. </p>
<p><div class="blockdiag" style="align: center;"><img class="img-responsive" src="data:image/png;base64,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"/></div></p>
<p>This is the reason the attacker <strong>can't</strong> read the token value even though he is able to <em>forge</em> requests. Providing the token value <strong>twice</strong> make this approach secure since the attacker can't read the token value and therefore can't forge a valid request (accepted by the server). </p>
<h2 id="6f8b794f3246b0c1e1780bb4d4d5dc53">Conclusion</h2>
<p>There are some other patterns I'm aware of (there might more!):</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#Encrypted_Token_Pattern">Encrypted Token Pattern</a></li>
<li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/csrf.html">token interceptors</a></li>
</ul>
<p>But the most valuable "take-home-lesson" is not about the technical details regarding the solutions. When discussing solutions several things should be always
considered:</p>
<ul>
<li>The browser will <strong>always</strong> send available (regarding to the domain) cookies within the requests (whether its a page, JS, CSS, JPG whatever)</li>
<li>If <strong>XSS</strong> is possible, you have bigger problems<ul>
<li><strong>SOP</strong> offers no protection anymore </li>
</ul>
</li>
<li>Make sure the CSRF token is <strong>random</strong> and <strong>unique</strong> per session</li>
<li>When storing the CSRF token as a <strong>cookie</strong>, make sure you <strong>double</strong> check the value<ul>
<li>The client <strong>has</strong> to provide the token as a GET/POST parameter</li>
<li>Don't rely on the validation based on the cookie</li>
</ul>
</li>
</ul>
                </div>
<hr/>
<div style="float:left;">
	Prev: <a href="http://blog.dornea.nu/2016/01/15/howto-put-nginx-and-php-to-jail-in-debian-8" align='left'>
	 HowTo: Put nginx and PHP to jail in Debian 8
	</a>
</div>
<div style="float:right;">
    Next: <a href="http://blog.dornea.nu/2016/02/01/steve-jobs-by-walter-isaacson" align='right'>
	 Steve Jobs by Walter Isaacson
	</a>
</div>
</p>

                <!-- Add comments -->
<div id="content-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname="dorneanu";
				var disqus_identifier = 'some-words-on-csrf-and-cookies';
			var disqus_url = 'http://blog.dornea.nu/2016/01/26/some-words-on-csrf-and-cookies';

		var disqus_config = function () {
			this.language = "en";
		};
 
        
        (function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
            </div>
            <div class="niu2-right-container col-md-2">
                <div id="niu2-sidebar-meta" class="niu2-sidebar">
                    <div class="niu2-sidebar-label"><i class="icon-calendar"></i>Published:</div>
                    <div class="niu2-sidebar-value">2016-01-26 00:00</div>
                    <div class="niu2-sidebar-label"><i class="icon-pencil"></i>category:</div>
                    <div class="niu2-sidebar-value"><a href="http://blog.dornea.nu/category/blog">blog</a></div>
                    <div class="niu2-sidebar-label"><i class="icon-tag"></i>Tag:</div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/appsec/">appsec</a><sup>25</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/web/">web</a><sup>14</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/javascript/">javascript</a><sup>5</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/csrf/">csrf</a><sup>2</sup></div>
                </div>

                <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
                    <div class="niu2-sidebar-label">
                        <i id="niu2-sidebar-toc-ctrl" class="icon-open-tocs"></i>Table of contents
                    </div>
                    <ul id="niu2-sidebar-toc-list">
                        <li><a href="#content-heading">Some words on CSRF and cookies</a></li>
                        <li><a href='#6432f4693afd88598023fe78739fb577'>General idea</a></li><li><a href='#c0fa85353677943560ac0bca6672d54d'>Some example</a></li><li><a href='#2d4dde52d975a2014c057771fa28ee31'>CSRF fundamentals</a></li><li><a href='#007233f8fd8f7e131056ddd1a3d73606'>The attack</a></li><li><a href='#8304512816e26767b8137d5ab36e7905'>The defense</a><ul><li><a href='#0a74ece5651a0dc38158844dd93f9308'>Provide the token in a hidden field (Synchronizer Token Pattern)</a></li><li><a href='#946a7a2766612c2ed85c65e7dc7a7118'>Provide session based CSRF token (Double Submit Cookies)</a></li></ul></li><li><a href='#6f8b794f3246b0c1e1780bb4d4d5dc53'>Conclusion</a></li>
                        <li><a href="#content-comments">Comments</a></li>
                    </ul>
                </div>
            </div>
            <div id="niu2-toolbar">
                <ul class="list-unstyled">
                    <li><a id="niu2-toolbar-ctrlsidebar" href="#" title="Hide Sidebar"><i class="icon-3x icon-hide-sidebar"></i></a></li>
                </ul>
                <div id="niu2-toolbar-showsidebar" data-title="Show Sidebar"></div>
                <div id="niu2-toolbar-github" data-repo=""></div>
                <div id="niu2-toolbar-bitbucket" data-repo=""></div>
            </div>
            <div id="niu2-toc" data-style="fixed"></div>
        </div>

        <div class="niu2-footer">
            <div id="body-footer" class="col-md-6 col-md-offset-2">
                <hr/>
                <p>
                    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
                    <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="https://github.com/twbs/bootstrap">Bootstrap3</a>
                    by <a href="https://blog.mawenbao.com">Ma Wenbao</a>, icons by 
                    <a href="https://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
                </p>
                <p>
                    © 2008 - 2016
                    <a class="niu2-footer-link" href="http://blog.dornea.nu">Victor Dorneanu</a>
                </p>
                <p class="niu2-icons">
                    <a class="niu2-footer-icon" href="https://pgp.mit.edu/pks/lookup?op=get&search=0x18F1AD46FB05E1B7" title="my public key">
                        <i class="icon-key icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="mailto: no-spam ÄATT dornea DOT nu" title="my email address">
                        <i class="icon-envelope-o icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="http://github.com/dorneanu" title="my github page">
                        <i class="icon-github-alt icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="/feeds/rss.xml" title="subscribe my blog">
                        <i class="icon-rss icon-lg"></i>
                    </a>
                </p>
            </div>
        </div>

        <script type="text/javascript">
            var _gaq=_gaq||[];
            _gaq.push(["_setAccount","UA-7161767-3"]);
            _gaq.push(["_trackPageview"]);
            (function(){
                var b=document.createElement("script");
                b.type="text/javascript";
                b.async=true;
                b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";
                var a=document.getElementsByTagName("script")[0];
                a.parentNode.insertBefore(b,a)
            })();
        </script>
        <div id="niu2-pygments" data-theme="github"></div>
        <div id="niu2-lazy-load" data-loading-txt="Loading image" data-loading-icon="icon-spin icon-spinner"></div>
        <div id="niu2-toolbar-load" data-loading-icon="icon-spin icon-4x icon-spinner"></div>
        <script type="text/javascript" src="/js/custom.js"></script>
        <script type="text/javascript">
            onContentLoaded();
        </script>
    </body>
</html>