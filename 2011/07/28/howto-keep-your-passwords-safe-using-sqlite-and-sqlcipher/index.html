<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="security, crypto, sqlite, howto, sql">
        <meta name="description" content="I was recently doing some hacks and realized that there must be a way to store gained information in a secure manner. I usually encrypt sensitive information (like passwords, accounts etc.) using GPG. But that's quite unhandy: You always need your private key and the encrypted data is stored ...">
        <title>HowTo: Keep your passwords safe using SQLite and SQLCipher - blog.dornea.nu</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
        <link rel="stylesheet" href="/css/ipython.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/font-icons/style.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/niu2.min.css" type="text/css" />
        <link rel="stylesheet" href="/css/custom.css" type="text/css" />
		
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/niu2.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>
        
        <link rel="canonical" href="http://blog.dornea.nu/2011/07/28/howto-keep-your-passwords-safe-using-sqlite-and-sqlcipher" />
        <script type="text/javascript">window.onload=function(){};</script>
        <!--[if lt IE 9]>
            <script src="http://blog.dornea.nu/theme/js/html5shiv.js"></script>
            <script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>
        <![endif]-->
    </head>
    <body> 
        <div id="body-header">
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="col-md-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://blog.dornea.nu">
                            <i class="icon-home"></i>blog.dornea.nu
                        </a>
                    </div>
                    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="http://dornea.nu" title="about">
                                <i class="icon-user"></i>about</a>
                            </li>
                            <li><a href="/archives.html" title="archives">
                                <i class="icon-archive"></i>archives</a>
                            </li>
                            <li><a href="/tags.html" title="tags">
                                <i class="icon-tag"></i>tags</a>
                            </li>
                            <li><a href="/feeds/rss.xml" title="feeds">
                                <i class="icon-rss"></i>feeds</a>
                            </li>
                        <!-- category dropdown list -->
                        <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="icon-folder-open"></i>category<b class="caret"></b>
                           </a>
                           <ul class="dropdown-menu">
                               <li><a href="http://blog.dornea.nu/category/blog">
                                      <i class="icon-pencil"></i>blog
                                      (116)</a></li>
                               <li><a href="http://blog.dornea.nu/category/low">
                                   <i class="icon-folder-close"></i>LOW
                                      (27)</a></li>
                               <li><a href="http://blog.dornea.nu/category/notes">
                                      <i class="icon-book"></i>notes
                                      (21)</a></li>
                           </ul>
                        </li>
                        <!--  self defined dropdown list -->
                        </ul>
                        
                        <!-- right nav bar -->
                        <ul class="nav navbar-nav navbar-right">
                        <!-- google custom search -->
                        <li>
                        <div id="niu2-cse-wrapper">
                            <div id="niu2-cse-header-box" class="navbar-form navbar-nav">
                                <form action="http://google.com/cse">
                                    <input type="hidden" name="cx" value="008508447409818574933:pxyxuhrgnxi" />
                                    <input type="hidden" name="ie" value="UTF-8" />
                                    <div class="form-group">
                                        <input id="niu2-cse-search-input" class="niu2-cse-header form-control" 
                                            type="text" name="q" 
                                            placeholder="Press enter to search ..."/>
                                    </div>
                                </form>
                           </div>
                           <div id="niu2-cse-ctrl-box" class="navbar-nav">
                            <i id="niu2-cse-search-image" class="icon-search navbar-nav"></i><span id="niu2-cse-search-text">Search</span>
                           </div>
                       </div>
                       </li>
                       </ul>
                    </nav>
                </div>
            </div>
<style>
    #banner{
        background-image:url("http://blog.dornea.nu//images/header.jpg");
    }   
</style>

<div id="banner">
    <div class="container">
        <div class="copy">
            <h2>blog.dornea.nu</h2>
                <p class="intro">Hack, code and drink some țuică. Personal blog of Victor Dorneanu.</p>
        </div>
    </div>
</div>
            <!-- End Banner -->
        </div>

        <div id="body-content">
            <div class="col-md-8 col-md-offset-2">
                <h1 id="content-heading">HowTo: Keep your passwords safe using SQLite and SQLCipher</h1>
            </div>
            <div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
                <div id="niu2-main-content">
                    <p>I was recently doing some hacks and realized that there must be a way to store gained information in a secure manner. I usually encrypt sensitive information (like passwords, accounts etc.) using GPG. But that's quite unhandy: You always need your private key and the encrypted data is stored unencrypted on the device (unless you're using full disk encryption which shouldn't be a problem since data is stored encrypted on the device). Like you probably also do, I have several account types: Mail, SSH, FTP, LDAP etc. Finding a good structure to store all that information could be a headache. Besides that you usually have several <code>organizations</code> offering specific services: Firm A offers Service 1 and Service 2; Firm B also offers Service 1 but on different port and so on...</p>
<p>Pondering about all this stuff, I came up with an idea which might be useful to some of you: Relational Database Management Systems (RDBMS). The concept should be able to:</p>
<ul>
<li>store ALL information in ONE place</li>
<li>provide simple functionalities in order to ADD, DELETE, MODIFY data</li>
<li>encrypt ALL data</li>
</ul>
<p>Well these are the requirements. What about real-life tools to satisfy them?</p>
<h2 id="497757a9c5b2ec17ded656170b51c788">SQLite</h2>
<blockquote>
<p>"SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine. SQLite is the most widely deployed SQL database engine in the world. The source code for SQLite is in the public domain." (Source: <a class="http" href="http://www.sqlite.org">http://www.sqlite.org</a>) </p>
</blockquote>
<p>What does this mean?
<em>   We got relations! Enjoy the magic of simple SQL queries.
</em>   No configuration! You don't have to configure any server nor the SQL client. Just create the DB and you're done.
<em>   The data base is stored in ONE file.
</em>   You can have multiple data bases within each file.</p>
<p>Pretty much for a DB! The really cool thing about SQLite is the fact that there are no additional steps required in order to create and maintain the DB. I really like PostgreSQL/MySQL &amp; Co. but the whole configuration process is driving me nuts. With SQLite you just create the file, put some schema to it and you're done. Last but not least: It's fast! Although the document is outdated you could have a look at the speed comparsion <a class="http" href="http://www.sqlite.org/speed.html">here</a>.</p>
<h2 id="78506d286e5bf48c73e3274c76102dc5">Database schema</h2>
<p>Now let's have a closer look at the interna of our DB. Let's start with the simplest table: the <strong>organization</strong> table.</p>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="ss">"organization"</span> <span class="p">(</span>
    <span class="ss">"id"</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="ss">"name"</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">);</span>
</pre></div>
<p>That should do the job since you need only the organizations name and some primary key. Usually an organization offers serveral services. So we'll create the 2nd table: the <strong>service</strong> table.</p>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="ss">"service"</span> <span class="p">(</span>
    <span class="ss">"id"</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="ss">"host"</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="ss">"port"</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="ss">"organization_id"</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>

    <span class="k">CONSTRAINT</span> <span class="n">fk_service_organization_id</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">organization_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">organization</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
<p>Assuming we have <code>Firm A</code> in our organization table, then its services will be stored in this way:</p>
<div class="highlight"><pre><span></span>sqlite&gt; SELECT * FROM organization<span class="p">;</span>
id          name
----------  ----------
<span class="m">1</span>           Firm A

sqlite&gt; SELECT * FROM service<span class="p">;</span>
id          host         port        organization_id
----------  -----------  ----------  ---------------
<span class="m">1</span>           smtp.a.com   <span class="m">25</span>          1
</pre></div>
<p>I think you got the point. You'll need a PK (primary key) , a host (actually this should be called <code>url</code>), a port number and the organization ID offering the service.</p>
<p>By now the schema was quite simple. We got the organization and its services. The <strong>account</strong> will interfere with both of them. First let's have a look the table:
</p>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="ss">"account"</span> <span class="p">(</span>
        <span class="ss">"id"</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
        <span class="ss">"created"</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
        <span class="ss">"expires"</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
        <span class="ss">"user"</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
        <span class="ss">"passwd"</span> <span class="nb">TEXT</span><span class="p">,</span>
        <span class="ss">"service_id"</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>

        <span class="k">CONSTRAINT</span> <span class="n">fk_account_service_id</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">service_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">service</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
<p>I think the attributes are self-explanatory. Here are some sample entries:</p>
<div class="highlight"><pre><span></span>sqlite&gt; SELECT * FROM accounts<span class="p">;</span>
id          created     expires     user                    passwd      host         port
----------  ----------  ----------  ----------------------  ----------  -----------  ----------
<span class="m">1</span>           2011-07-23  2012-07-26  victor.dorneanu@blab    XXXXXX      smtp.kjs.de  25
<span class="m">2</span>           2011-07-23  2012-07-26  victor.dorneanu@bla2    XXXXXX      pop3.kjs.de  995
<span class="m">3</span>           2011-07-23  2012-07-26  victor@gmail            XXXXXX      smtp.gmail.  25
</pre></div>
<h2 id="f54d76464c6b397c5275d406d5059dc1">Entity-Relationship-Modell</h2>
<p>This is for the ER-Modell freaks among you...</p>
<p><img alt="ER model" class="img-responsive" src="http://dl.dornea.nu/img/2011/255/er-modell.png"/></p>
<p>Graphviz code:</p>
<div class="highlight"><pre><span></span>graph ER {
    node [shape=box, style=filled, color=yellow]; organization; service; account;
    node [shape=ellipse, style=filled, color=green]; acc_id; created; expires; user; passwd; org_id; org_name; serv_id; host;
    port;
    node [shape=diamond,style=filled,color=lightgrey]; {node [label="has"] has0;
    has1;}

    organization -- org_id;
    organization -- org_name;

    account -- acc_id;
    account -- created;
    account -- expires;
    account -- user;
    account -- passwd;

    service -- serv_id;
    service -- host;
    service -- port;

    organization -- "has0" [label="M",len=1.00];
    "has0" -- service [label="N",len=1.00];

    service -- "has1" [label="1",len=1.00];
    "has1" -- account [label="N",len=1.00];

    label = "

ER Modell (dornea.nu)";
    fontsize=9;
}
</pre></div>
<h2 id="2fae32629d4ef4fc6341f1751b405e45">Security</h2>
<p>Ok. So we got our DB, our tables and inserted some dummy data. What about security? What if our SQLite file gets in the wrong hands? <a class="http" href="http://sqlcipher.net/">SQLCipher</a> could help us to minimize the potential impact. What is it?</p>
<blockquote>
<p>"SQLCipher is an SQLite xtension that provides transparent 256-bit AES encryption of database files. Pages are encrypted before being written to disk and are decrypted when read back. Due to the small footprint and great performance it’s ideal for protecting embedded application databases and is well suited for mobile development."" (Source: <a class="http" href="http://sqlcipher.net/">http://sqlcipher.net/</a>) </p>
</blockquote>
<p>Advantages:</p>
<ul>
<li>EVERYTHING is encrypted</li>
<li>you have a small percentage of overhead (for encryption routines): 5-15%</li>
<li>uses OpenSSL crypto library</li>
<li>good security (CBC mode, key derivation)</li>
</ul>
<p>In order to use SQLCipher you'll have to build the SQLite package with the enhanced features. Just follow the instructions on <a class="http" href="http://sqlcipher.net/introduction/">http://sqlcipher.net/introduction/</a> and use following command to configure and build the package:</p>
<div class="highlight"><pre><span></span>./configure --prefix<span class="o">=</span>/usr/local --enable-tempstore<span class="o">=</span>yes <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">"-DSQLITE_HAS_CODEC"</span> <span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">"-lcrypto"</span>
make
make install
</pre></div>
<p>Then you should have a working binary in /usr/local/bin. I suggest you create a new encrypted DB rather than encrypt an existing one. There are several <a class="http" href="http://sqlcipher.net/sqlcipher-api/">hints</a> how to do this, but I recommend you starting with a new fresh DB. Let's get started:</p>
<div class="highlight"><pre><span></span>$ /usr/local/bin/sqlite3 new_db.db
SQLite version 3.7.2
Enter <span class="s2">".help"</span> <span class="k">for</span> instructions
Enter SQL statements terminated with a <span class="s2">";"</span>
sqlite&gt; PRAGMA <span class="nv">key</span> <span class="o">=</span> <span class="s1">'crackme'</span><span class="p">;</span>
sqlite&gt; PRAGMA <span class="nv">cipher</span> <span class="o">=</span> <span class="s1">'aes-256-cfb'</span><span class="p">;</span>
sqlite&gt; PRAGMA <span class="nv">kdf_iter</span> <span class="o">=</span> <span class="s1">'1000'</span><span class="p">;</span>
sqlite&gt;
</pre></div>
<p>Now you're ready to create your DB schema. I'd create some SQL file, set the DB key and afterwards create the table. Create some new file (e.g. dump.sql) and paste these line to it:</p>
<div class="highlight"><pre><span></span>PRAGMA <span class="nv">key</span> <span class="o">=</span> <span class="s1">'crackme'</span><span class="p">;</span>
PRAGMA <span class="nv">cipher</span> <span class="o">=</span> <span class="s1">'aes-256-cfb'</span><span class="p">;</span>
PRAGMA <span class="nv">kdf_iter</span> <span class="o">=</span> <span class="s1">'1000'</span><span class="p">;</span>
BEGIN TRANSACTION<span class="p">;</span>
-- CREATE Tables
CREATE TABLE <span class="s2">"organization"</span> <span class="o">(</span>
    <span class="s2">"id"</span> INTEGER PRIMARY KEY NOT NULL,
    <span class="s2">"name"</span> TEXT NOT NULL
<span class="o">)</span><span class="p">;</span>

CREATE TABLE <span class="s2">"service"</span> <span class="o">(</span>
    <span class="s2">"id"</span> INTEGER PRIMARY KEY NOT NULL,
    <span class="s2">"host"</span> TEXT NOT NULL,
    <span class="s2">"port"</span> INTEGER NOT NULL,
    <span class="s2">"organization_id"</span> INTEGER NOT NULL,

    CONSTRAINT fk_service_organization_id FOREIGN KEY <span class="o">(</span>organization_id<span class="o">)</span> REFERENCES organization<span class="o">(</span>id<span class="o">)</span>
<span class="o">)</span><span class="p">;</span>

CREATE TABLE <span class="s2">"account"</span> <span class="o">(</span>
        <span class="s2">"id"</span> INTEGER PRIMARY KEY NOT NULL,
        <span class="s2">"created"</span> TEXT NOT NULL,
        <span class="s2">"expires"</span> TEXT NOT NULL,
        <span class="s2">"user"</span> TEXT NOT NULL,
        <span class="s2">"passwd"</span> TEXT,
        <span class="s2">"service_id"</span> INTEGER NOT NULL,

        CONSTRAINT fk_account_service_id FOREIGN KEY <span class="o">(</span>service_id<span class="o">)</span> REFERENCES service<span class="o">(</span>id<span class="o">)</span>
<span class="o">)</span><span class="p">;</span>

END TRANSACTION<span class="p">;</span>
</pre></div>
<p>Then create your encrypted DB using:</p>
<div class="highlight"><pre><span></span>$ /usr/local/bin/sqlite3 -init dump.sql encrypted.db
SQLite version 3.7.2
Enter <span class="s2">".help"</span> <span class="k">for</span> instructions
Enter SQL statements terminated with a <span class="s2">";"</span>
sqlite&gt; .tables
account       organization  service
sqlite&gt;
</pre></div>
<p>Voila! Is the file <code>encrypted.db</code> really encrypted? Let's have a look:</p>
<div class="highlight"><pre><span></span>$ file encrypted.db
encrypted.db: data
$ hexdump -C encrypted.db
<span class="m">00000000</span>  e4 2a <span class="nb">cd</span> <span class="m">22</span> 4f d4 <span class="m">30</span> a6  b7 <span class="m">95</span> 9c <span class="m">28</span> <span class="m">19</span> f5 4a <span class="m">45</span>  <span class="p">|</span>.*.<span class="s2">"O.0....(..JE|</span>
<span class="s2">00000010  c9 b6 c4 28 49 0b 3b c3  91 ef 06 95 e7 6a aa 03  |...(I.;......j..|</span>
<span class="s2">00000020  ff b7 ef 2f cd 48 c9 b3  01 36 24 4b dd 4c 95 ef  |.../.H...6</span><span class="nv">$K</span><span class="s2">.L..|</span>
<span class="s2">00000030  93 df be 94 ff 8a 0e 04  c4 fc b0 bf 67 97 fc 43  |............g..C|</span>
<span class="s2">00000040  38 2b b3 6e e2 88 2e 26  e7 ef 19 e3 e5 b8 0f 04  |8+.n...&amp;........|</span>
<span class="s2">00000050  50 44 5a d9 83 1d ac 33  d9 21 cd d1 40 c6 d8 3d  |PDZ....3.!..@..=|</span>
<span class="s2">00000060  ab 11 5d 77 6d 94 08 59  64 5f ac e6 99 20 05 03  |..]wm..Yd_... ..|</span>
<span class="s2">00000070  da 08 8a b7 a3 cf d4 22  44 c2 de 4c 00 48 51 4d  |......."</span>D..L.HQM<span class="p">|</span>
<span class="m">00000080</span>  <span class="m">74</span> 0b 3b f6 5d f9 <span class="m">07</span> <span class="m">07</span>  1b <span class="m">77</span> a0 8b 9e 5e bd bb  <span class="p">|</span>t.<span class="p">;</span>.<span class="o">]</span>....w...^..<span class="p">|</span>
<span class="m">00000090</span>  d4 ca <span class="m">25</span> <span class="m">75</span> f2 f7 <span class="m">56</span> <span class="m">48</span>  ea <span class="m">03</span> <span class="m">02</span> c5 da <span class="m">50</span> <span class="m">41</span> f6  <span class="p">|</span>..%u..VH.....PA.<span class="p">|</span>
000000a0  <span class="m">91</span> <span class="m">01</span> d1 3d cb <span class="m">34</span> <span class="m">12</span> 5c  eb <span class="m">49</span> <span class="m">05</span> da 4f <span class="m">13</span> <span class="m">65</span> e7  <span class="p">|</span>...<span class="o">=</span>.4..I..O.e.<span class="p">|</span>
000000b0  1c ae <span class="m">60</span> <span class="m">13</span> e1 0d ef <span class="m">11</span>  <span class="m">33</span> bc 8f <span class="m">55</span> a5 e3 9c <span class="m">56</span>  <span class="p">|</span>..<span class="sb">`</span>.....3..U...V<span class="p">|</span>
000000c0  d5 <span class="m">78</span> <span class="m">16</span> 7f <span class="m">20</span> ee <span class="m">54</span> c0  4b a9 7c <span class="m">70</span> <span class="m">41</span> <span class="m">56</span> 8c e3  <span class="p">|</span>.x.. .T.K.<span class="p">|</span>pAV..<span class="p">|</span>
000000d0  e3 d1 <span class="m">81</span> f8 <span class="nb">fc</span> aa <span class="m">31</span> ac  c1 e0 5c <span class="m">92</span> <span class="m">59</span> 0b <span class="m">26</span> e9  <span class="p">|</span>......1....Y.<span class="p">&amp;</span>.<span class="p">|</span>
000000e0  <span class="m">89</span> <span class="m">68</span> <span class="m">96</span> 3c d4 <span class="m">87</span> d2 ef  d7 8a ee 9a <span class="m">29</span> <span class="m">78</span> c4 <span class="m">12</span>  <span class="p">|</span>.h.&lt;........<span class="o">)</span>x..<span class="p">|</span>
000000f0  <span class="m">88</span> <span class="m">28</span> fb db <span class="m">51</span> 8b <span class="m">66</span> <span class="nb">fc</span>  <span class="m">96</span> 2e d9 3c d4 <span class="m">90</span> ea d5  <span class="p">|</span>.<span class="o">(</span>..Q.f....&lt;....<span class="p">|</span>
<span class="m">00000100</span>  d9 <span class="m">49</span> <span class="m">04</span> da dc <span class="m">61</span> f0 <span class="m">54</span>  0e 3f c9 e2 a9 a4 7b 8c  <span class="p">|</span>.I...a.T.?....<span class="o">{</span>.<span class="p">|</span>
<span class="m">00000110</span>  <span class="m">67</span> 5d 0f <span class="m">15</span> bb 7e <span class="m">30</span> b8  5b 6b 0a <span class="m">78</span> ee <span class="m">81</span> f2 b0  <span class="p">|</span>g<span class="o">]</span>...~0.<span class="o">[</span>k.x....<span class="p">|</span>
<span class="m">00000120</span>  fd <span class="m">60</span> cf d0 <span class="m">79</span> <span class="m">92</span> <span class="m">60</span> <span class="m">06</span>  6f d7 b6 <span class="m">15</span> aa <span class="m">39</span> eb 6e  <span class="p">|</span>.<span class="sb">`</span>..y.<span class="sb">`</span>.o....9.n<span class="p">|</span>
<span class="m">00000130</span>  7c d6 <span class="m">38</span> <span class="m">38</span> <span class="m">44</span> <span class="m">47</span> 4f c1  <span class="m">54</span> d4 6c <span class="m">51</span> <span class="m">53</span> a3 6e <span class="m">99</span>  <span class="o">||</span>.88DGO.T.lQS.n.<span class="p">|</span>
<span class="m">00000140</span>  <span class="m">65</span> <span class="m">13</span> <span class="m">32</span> <span class="m">88</span> <span class="m">71</span> a3 c3 <span class="m">67</span>  dd b9 7a 4d <span class="m">33</span> 7d 0a <span class="m">47</span>  <span class="p">|</span>e.2.q..g..zM3<span class="o">}</span>.G<span class="p">|</span>
<span class="m">00000150</span>  2b ca b0 ff b7 dd d6 9b  0b 4f 8f 5f <span class="m">31</span> b3 <span class="m">85</span> <span class="m">92</span>  <span class="p">|</span>+........O._1...<span class="p">|</span>
<span class="m">00000160</span>  8e cc <span class="m">63</span> 5a <span class="m">91</span> <span class="m">06</span> ce <span class="m">94</span>  cf ba 7d <span class="m">52</span> 2d 4e <span class="m">22</span> d5  <span class="p">|</span>..cZ......<span class="o">}</span>R-N<span class="s2">".|</span>
<span class="s2">00000170  43 37 95 27 2a a6 a1 89  65 2c fc c4 e6 47 6f 0c  |C7.'*...e,...Go.|</span>
<span class="s2">00000180  28 fb ed ad 16 fb 7c 2a  50 bc e2 b1 b7 22 39 c0  |(.....|*P...."</span>9.<span class="p">|</span>
<span class="m">00000190</span>  7f <span class="m">23</span> <span class="m">68</span> <span class="m">80</span> 9e c9 1d <span class="m">44</span>  eb bf f0 <span class="m">01</span> <span class="m">49</span> ed <span class="m">71</span> 6b  <span class="p">|</span>.#h....D....I.qk<span class="p">|</span>
000001a0  af 4b <span class="m">35</span> e4 <span class="m">52</span> de <span class="m">14</span> <span class="m">75</span>  e2 <span class="m">30</span> ae 7b <span class="m">39</span> <span class="m">34</span> bc <span class="m">72</span>  <span class="p">|</span>.K5.R..u.0.<span class="o">{</span>94.r<span class="p">|</span>
000001b0  c4 2b <span class="m">20</span> 1c fa <span class="m">58</span> d1 5c  4e 4c de <span class="m">50</span> ac <span class="m">67</span> <span class="m">24</span> be  <span class="p">|</span>.+ ..X.NL.P.g$.<span class="p">|</span>
000001c0  e2 d0 ed <span class="m">98</span> ae <span class="m">60</span> <span class="m">67</span> <span class="m">24</span>  c2 b2 c2 <span class="m">46</span> 1b ab <span class="m">96</span> bb  <span class="p">|</span>.....<span class="sb">`</span>g$...F....<span class="p">|</span>
000001d0  4e 2e <span class="m">67</span> <span class="m">63</span> cb ca bc c6  ea <span class="m">48</span> db b2 ed 7d <span class="m">34</span> 5a  <span class="p">|</span>N.gc.....H...<span class="o">}</span>4Z<span class="p">|</span>
000001e0  0b 7d 5a 6a <span class="m">38</span> 8c <span class="m">59</span> <span class="m">21</span>  <span class="m">01</span> e2 7c 7c <span class="m">42</span> <span class="m">80</span> <span class="m">05</span> <span class="m">36</span>  <span class="p">|</span>.<span class="o">}</span>Zj8.Y!..<span class="o">||</span>B..6<span class="p">|</span>
000001f0  d5 b9 b8 <span class="m">02</span> <span class="m">31</span> f1 cf <span class="m">80</span>  <span class="m">75</span> 7a a3 5f <span class="m">38</span> b6 c7 <span class="m">07</span>  <span class="p">|</span>....1...uz._8...<span class="p">|</span>
<span class="m">00000200</span>  bd 2a <span class="m">29</span> <span class="m">61</span> <span class="m">80</span> b2 <span class="m">19</span> <span class="m">05</span>  2c <span class="m">07</span> 2c b6 <span class="m">35</span> ef <span class="m">26</span> <span class="m">32</span>  <span class="p">|</span>.*<span class="o">)</span>a....,.,.5.<span class="p">&amp;</span>2<span class="p">|</span>
<span class="m">00000210</span>  <span class="m">18</span> <span class="m">61</span> <span class="m">27</span> 4c <span class="m">27</span> <span class="m">38</span> d1 a1  <span class="m">07</span> ca 1a <span class="m">23</span> d4 <span class="m">97</span> 8f d1  <span class="p">|</span>.a<span class="s1">'L'</span>8.....#....<span class="p">|</span>
<span class="m">00000220</span>  <span class="m">88</span> db <span class="m">87</span> <span class="m">07</span> <span class="m">88</span> <span class="m">97</span> cf <span class="m">64</span>  <span class="m">88</span> f6 <span class="m">53</span> a5 e6 <span class="m">05</span> <span class="m">62</span> <span class="m">02</span>  <span class="p">|</span>.......d..S...b.<span class="p">|</span>
<span class="m">00000230</span>  0f c3 <span class="m">04</span> c5 0b de <span class="m">66</span> <span class="m">45</span>  dd 1e <span class="m">62</span> bf 7d ff 8a <span class="m">03</span>  <span class="p">|</span>......fE..b.<span class="o">}</span>...<span class="p">|</span>
<span class="m">00000240</span>  <span class="m">23</span> <span class="m">41</span> b3 6a d1 2d <span class="m">60</span> e7  3f <span class="m">34</span> <span class="m">03</span> 9f 8c a0 3c <span class="m">37</span>  <span class="p">|</span><span class="c1">#A.j.-`.?4....&lt;7|</span>
<span class="m">00000250</span>  5c bc <span class="m">78</span> c9 <span class="m">06</span> f1 e4 2c  f2 <span class="m">38</span> e6 cb a1 <span class="m">18</span> 1a 5a  <span class="p">|</span>.x....,.8.....Z<span class="p">|</span>
<span class="m">00000260</span>  bc 4d 2d 4f 9e <span class="m">40</span> de f2  <span class="m">73</span> d2 <span class="m">25</span> c7 1f dd d4 <span class="m">00</span>  <span class="p">|</span>.M-O.@..s.%.....<span class="p">|</span>
<span class="m">00000270</span>  3c 0e 9c <span class="m">66</span> <span class="m">09</span> <span class="m">56</span> <span class="m">37</span> bf  <span class="m">08</span> <span class="m">12</span> e8 f0 d0 fa <span class="m">67</span> a2  <span class="p">|</span>&lt;..f.V7.......g.<span class="p">|</span>
<span class="m">00000280</span>  f8 <span class="m">12</span> 9a <span class="m">46</span> ae 8e e4 4c  <span class="m">31</span> db <span class="m">74</span> 8a d9 ed <span class="m">36</span> <span class="m">97</span>  <span class="p">|</span>...F...L1.t...6.<span class="p">|</span>
<span class="m">00000290</span>  <span class="m">62</span> <span class="m">25</span> 6c <span class="m">28</span> <span class="m">22</span> 5e <span class="m">08</span> <span class="m">80</span>  <span class="m">40</span> <span class="m">07</span> <span class="m">83</span> <span class="m">47</span> e0 <span class="m">62</span> dc <span class="nb">cd</span>  <span class="p">|</span>b%l<span class="o">(</span><span class="s2">"^..@..G.b..|</span>
<span class="s2">000002a0  ce f8 4b 48 48 19 c9 cd  ba 2c 11 9b 0b 0c 90 ea  |..KHH....,......|</span>
<span class="s2">000002b0  fe 17 9e 30 02 33 46 c0  49 7d c1 e4 f0 5b de e4  |...0.3F.I}...[..|</span>
<span class="s2">000002c0  08 52 66 b4 be 7b e7 58  54 52 11 0c 76 6e 75 99  |.Rf..{.XTR..vnu.|</span>
<span class="s2">000002d0  26 84 b1 42 b4 a5 6e a5  eb dd 17 d7 86 07 a0 b9  |&amp;..B..n.........|</span>
<span class="s2">000002e0  17 d8 86 70 3f 9a d0 4f  3b b7 00 9f fb dd bc 94  |...p?..O;.......|</span>
<span class="s2">000002f0  aa f5 08 94 a8 98 22 2b  88 84 14 76 d9 d9 bd 35  |......"</span>+...v...5<span class="p">|</span>
<span class="m">00000300</span>  f1 <span class="m">19</span> <span class="m">66</span> 0f <span class="m">25</span> <span class="m">31</span> 7d <span class="m">57</span>  <span class="m">43</span> 7b <span class="m">66</span> c5 <span class="m">79</span> b5 4a <span class="m">94</span>  <span class="p">|</span>..f.%1<span class="o">}</span>WC<span class="o">{</span>f.y.J.<span class="p">|</span>
<span class="m">00000310</span>  7b 5a <span class="m">66</span> <span class="m">63</span> 3a 7f e5 d4  e6 6b c7 f1 bf 7c <span class="m">46</span> <span class="m">76</span>  <span class="p">|</span><span class="o">{</span>Zfc:....k...<span class="p">|</span>Fv<span class="p">|</span>
<span class="m">00000320</span>  <span class="m">94</span> d7 4a d6 <span class="m">60</span> b3 5b f2  fb <span class="m">74</span> 3d ec 3c dc 8e <span class="m">08</span>  <span class="p">|</span>..J.<span class="sb">`</span>.<span class="o">[</span>..t<span class="o">=</span>.&lt;...<span class="p">|</span>
<span class="m">00000330</span>  e9 b0 1f <span class="m">42</span> a4 <span class="m">90</span> 6f <span class="m">40</span>  5d <span class="m">48</span> f1 9d <span class="m">28</span> c2 <span class="m">66</span> <span class="m">28</span>  <span class="p">|</span>...B..o@<span class="o">]</span>H..<span class="o">(</span>.f<span class="o">(</span><span class="p">|</span>
<span class="m">00000340</span>  <span class="m">51</span> a6 <span class="m">67</span> e2 c8 b8 f9 <span class="m">46</span>  3f <span class="m">42</span> e8 <span class="m">67</span> <span class="m">91</span> 8a <span class="m">25</span> e6  <span class="p">|</span>Q.g....F?B.g..%.<span class="p">|</span>
<span class="m">00000350</span>  e6 4c <span class="m">35</span> a7 9c d1 2d 4f  8e 6a <span class="m">24</span> ba b0 ca a3 <span class="m">22</span>  <span class="p">|</span>.L5...-O.j$....<span class="s2">"|</span>
<span class="s2">00000360  8e 75 b1 b4 f3 58 ce c9  9e 59 39 10 04 be 37 f8  |.u...X...Y9...7.|</span>
<span class="s2">00000370  ca d4 1e 88 54 cd f8 92  9a 54 7a 70 94 8b b0 11  |....T....Tzp....|</span>
<span class="s2">00000380  ee e8 ae 4a 59 3b bc 32  e5 8e aa 16 0f a0 81 e6  |...JY;.2........|</span>
<span class="s2">00000390  54 15 bc 9a 58 1b 4d a0  2e d5 f0 7e 0f 60 6e b0  |T...X.M....~.`n.|</span>
<span class="s2">000003a0  29 48 f4 4a 5c 1a d5 92  d3 1a 9d 9d d2 d9 8e 77  |)H.J..........w|</span>
<span class="s2">000003b0  b5 63 0d 59 c7 8d d7 f5  f6 42 7c 45 cb dd 05 05  |.c.Y.....B|E....|</span>
<span class="s2">...</span>
</pre></div>
<p>As you can see, there is a lot of ... garbage inside the file! No SQL commands, nothing!</p>
<h2 id="87557f11575c0ad78e4e28abedc13b6e">End</h2>
<p>I hope you've enjoyed this one as much as I did. Don't hesitate to write comments and keep it clean.</p>
                </div>
<hr/>
<div style="float:left;">
	Prev: <a href="http://blog.dornea.nu/2011/06/24/free-pptp-vpn-servers" align='left'>
	 Free PPTP VPN servers
	</a>
</div>
<div style="float:right;">
    Next: <a href="http://blog.dornea.nu/2011/11/07/howto-redmine-lighttpd-with-debian" align='right'>
	 HowTo: Redmine, Lighttpd with Debian
	</a>
</div>
</p>

                <!-- Add comments -->
<div id="content-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname="dorneanu";
				var disqus_identifier = 'howto-keep-your-passwords-safe-using-sqlite-and-sqlcipher';
			var disqus_url = 'http://blog.dornea.nu/2011/07/28/howto-keep-your-passwords-safe-using-sqlite-and-sqlcipher';

		var disqus_config = function () {
			this.language = "en";
		};
 
        
        (function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
            </div>
            <div class="niu2-right-container col-md-2">
                <div id="niu2-sidebar-meta" class="niu2-sidebar">
                    <div class="niu2-sidebar-label"><i class="icon-calendar"></i>Published:</div>
                    <div class="niu2-sidebar-value">2011-07-28 00:00</div>
                    <div class="niu2-sidebar-label"><i class="icon-pencil"></i>category:</div>
                    <div class="niu2-sidebar-value"><a href="http://blog.dornea.nu/category/blog">blog</a></div>
                    <div class="niu2-sidebar-label"><i class="icon-tag"></i>Tag:</div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/security/">security</a><sup>35</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/crypto/">crypto</a><sup>19</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/sqlite/">sqlite</a><sup>3</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/howto/">howto</a><sup>22</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/sql/">sql</a><sup>2</sup></div>
                </div>

                <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
                    <div class="niu2-sidebar-label">
                        <i id="niu2-sidebar-toc-ctrl" class="icon-open-tocs"></i>Table of contents
                    </div>
                    <ul id="niu2-sidebar-toc-list">
                        <li><a href="#content-heading">HowTo: Keep your passwords safe using SQLite and SQLCipher</a></li>
                        <li><a href='#497757a9c5b2ec17ded656170b51c788'>SQLite</a></li><li><a href='#78506d286e5bf48c73e3274c76102dc5'>Database schema</a></li><li><a href='#f54d76464c6b397c5275d406d5059dc1'>Entity-Relationship-Modell</a></li><li><a href='#2fae32629d4ef4fc6341f1751b405e45'>Security</a></li><li><a href='#87557f11575c0ad78e4e28abedc13b6e'>End</a></li>
                        <li><a href="#content-comments">Comments</a></li>
                    </ul>
                </div>
            </div>
            <div id="niu2-toolbar">
                <ul class="list-unstyled">
                    <li><a id="niu2-toolbar-ctrlsidebar" href="#" title="Hide Sidebar"><i class="icon-3x icon-hide-sidebar"></i></a></li>
                </ul>
                <div id="niu2-toolbar-showsidebar" data-title="Show Sidebar"></div>
                <div id="niu2-toolbar-github" data-repo=""></div>
                <div id="niu2-toolbar-bitbucket" data-repo=""></div>
            </div>
            <div id="niu2-toc" data-style="fixed"></div>
        </div>

        <div class="niu2-footer">
            <div id="body-footer" class="col-md-6 col-md-offset-2">
                <hr/>
                <p>
                    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
                    <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="https://github.com/twbs/bootstrap">Bootstrap3</a>
                    by <a href="https://blog.mawenbao.com">Ma Wenbao</a>, icons by 
                    <a href="https://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
                </p>
                <p>
                    © 2008 - 2016
                    <a class="niu2-footer-link" href="http://blog.dornea.nu">Victor Dorneanu</a>
                </p>
                <p class="niu2-icons">
                    <a class="niu2-footer-icon" href="https://pgp.mit.edu/pks/lookup?op=get&search=0x18F1AD46FB05E1B7" title="my public key">
                        <i class="icon-key icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="mailto: no-spam ÄATT dornea DOT nu" title="my email address">
                        <i class="icon-envelope-o icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="http://github.com/dorneanu" title="my github page">
                        <i class="icon-github-alt icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="/feeds/rss.xml" title="subscribe my blog">
                        <i class="icon-rss icon-lg"></i>
                    </a>
                </p>
            </div>
        </div>

        <script type="text/javascript">
            var _gaq=_gaq||[];
            _gaq.push(["_setAccount","UA-7161767-3"]);
            _gaq.push(["_trackPageview"]);
            (function(){
                var b=document.createElement("script");
                b.type="text/javascript";
                b.async=true;
                b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";
                var a=document.getElementsByTagName("script")[0];
                a.parentNode.insertBefore(b,a)
            })();
        </script>
        <div id="niu2-pygments" data-theme="github"></div>
        <div id="niu2-lazy-load" data-loading-txt="Loading image" data-loading-icon="icon-spin icon-spinner"></div>
        <div id="niu2-toolbar-load" data-loading-icon="icon-spin icon-4x icon-spinner"></div>
        <script type="text/javascript" src="/js/custom.js"></script>
        <script type="text/javascript">
            onContentLoaded();
        </script>
    </body>
</html>