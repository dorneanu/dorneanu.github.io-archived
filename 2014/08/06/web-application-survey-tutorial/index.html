<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="ipython, appsec, web, python">
        <meta name="description" content="Suppose you get a list of some URLs and you are asked to "investigate" them. The list is full of some random URLs related to your company and nobody knows about. You don't have a clue who is responsible for them nor which applications (if any) are running behind ...">
        <title>Web Application Survey Tutorial - blog.dornea.nu</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
        <link rel="stylesheet" href="/css/ipython.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/font-icons/style.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/niu2.min.css" type="text/css" />
        <link rel="stylesheet" href="/css/custom.css" type="text/css" />
		
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/niu2.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>
        
        <link rel="canonical" href="http://blog.dornea.nu/2014/08/06/web-application-survey-tutorial" />
        <script type="text/javascript">window.onload=function(){};</script>
        <!--[if lt IE 9]>
            <script src="http://blog.dornea.nu/theme/js/html5shiv.js"></script>
            <script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>
        <![endif]-->
    </head>
    <body> 
        <div id="body-header">
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="col-md-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://blog.dornea.nu">
                            <i class="icon-home"></i>blog.dornea.nu
                        </a>
                    </div>
                    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="http://dornea.nu" title="about">
                                <i class="icon-user"></i>about</a>
                            </li>
                            <li><a href="/archives.html" title="archives">
                                <i class="icon-archive"></i>archives</a>
                            </li>
                            <li><a href="/tags.html" title="tags">
                                <i class="icon-tag"></i>tags</a>
                            </li>
                            <li><a href="/feeds/rss.xml" title="feeds">
                                <i class="icon-rss"></i>feeds</a>
                            </li>
                        <!-- category dropdown list -->
                        <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="icon-folder-open"></i>category<b class="caret"></b>
                           </a>
                           <ul class="dropdown-menu">
                               <li><a href="http://blog.dornea.nu/category/blog">
                                      <i class="icon-pencil"></i>blog
                                      (107)</a></li>
                               <li><a href="http://blog.dornea.nu/category/low">
                                   <i class="icon-folder-close"></i>LOW
                                      (27)</a></li>
                               <li><a href="http://blog.dornea.nu/category/notes">
                                      <i class="icon-book"></i>notes
                                      (19)</a></li>
                           </ul>
                        </li>
                        <!--  self defined dropdown list -->
                        </ul>
                        
                        <!-- right nav bar -->
                        <ul class="nav navbar-nav navbar-right">
                        <!-- google custom search -->
                        <li>
                        <div id="niu2-cse-wrapper">
                            <div id="niu2-cse-header-box" class="navbar-form navbar-nav">
                                <form action="http://google.com/cse">
                                    <input type="hidden" name="cx" value="008508447409818574933:pxyxuhrgnxi" />
                                    <input type="hidden" name="ie" value="UTF-8" />
                                    <div class="form-group">
                                        <input id="niu2-cse-search-input" class="niu2-cse-header form-control" 
                                            type="text" name="q" 
                                            placeholder="Press enter to search ..."/>
                                    </div>
                                </form>
                           </div>
                           <div id="niu2-cse-ctrl-box" class="navbar-nav">
                            <i id="niu2-cse-search-image" class="icon-search navbar-nav"></i><span id="niu2-cse-search-text">Search</span>
                           </div>
                       </div>
                       </li>
                       </ul>
                    </nav>
                </div>
            </div>
<style>
    #banner{
        background-image:url("http://blog.dornea.nu//images/header.jpg");
    }   
</style>

<div id="banner">
    <div class="container">
        <div class="copy">
            <h2>blog.dornea.nu</h2>
                <p class="intro">Hack, code and drink some țuică. Personal blog of Victor Dorneanu.</p>
        </div>
    </div>
</div>
            <!-- End Banner -->
        </div>

        <div id="body-content">
            <div class="col-md-8 col-md-offset-2">
                <h1 id="content-heading">Web Application Survey Tutorial</h1>
            </div>
            <div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
                <div id="niu2-main-content">
                    <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Suppose you get a list of some URLs and you are asked to "investigate" them. The list is full of some random URLs related to your company and nobody knows about. You don't have a clue who is responsible for them nor which applications (if any) are running behind them. Sounds like a cool task, ugh?</p>
<p>Well in today's post I'll show you how I've managed it to minimize the process of analyzing each URL manually and saved me a lot of time automatizing things.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="994b0dff3ed5e3106513d157298b2b7e">Setup environment<a class="anchor-link" href="#Setup-environment">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [2]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%</span><span class="k">pylab</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="kn">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="kn">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">ipy_table</span>
<span class="kn">import</span> <span class="nn">dnslib</span>
<span class="kn">import</span> <span class="nn">pythonwhois</span>
<span class="kn">import</span> <span class="nn">urlparse</span>
<span class="kn">import</span> <span class="nn">tldextract</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">urllib2</span>


<span class="kn">from</span> <span class="nn">yurl</span> <span class="kn">import</span> <span class="n">URL</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display_pretty</span><span class="p">,</span> <span class="n">display_html</span><span class="p">,</span> <span class="n">display_jpeg</span><span class="p">,</span> <span class="n">display_png</span><span class="p">,</span> <span class="n">display_json</span><span class="p">,</span> <span class="n">display_latex</span><span class="p">,</span> <span class="n">display_svg</span>

<span class="c"># Ipython settings</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.height'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_rows'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_columns'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_colwidth'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.width'</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.column_space'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c"># Change working directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">"/root/work/appsurvey"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Populating the interactive namespace from numpy and matplotlib
height has been deprecated.

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First I'll read the list of targets from some CSV file.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [3]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Fetch list of random URLs (found using Google)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">'http://files.ianonavy.com/urls.txt'</span><span class="p">)</span>
<span class="n">targets_row</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c"># Create DataFrame</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets_row</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"Target"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"First 20 entries in the targets list"</span><span class="p">)</span>
<span class="n">targets</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">First 20 entries in the targets list
</pre>
</div>
</div>
<div class="output_area"><div class="prompt output_prompt">
    Out[3]:</div>
<div class="output_html rendered_html output_subarea output_pyout">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="table table-hover table-striped dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr>
<th>0 </th>
<td>                 http://www.altpress.org/</td>
</tr>
<tr>
<th>1 </th>
<td>              http://www.nzfortress.co.nz</td>
</tr>
<tr>
<th>2 </th>
<td>            http://www.evillasforsale.com</td>
</tr>
<tr>
<th>3 </th>
<td>             http://www.playingenemy.com/</td>
</tr>
<tr>
<th>4 </th>
<td>         http://www.richardsonscharts.com</td>
</tr>
<tr>
<th>5 </th>
<td>                    http://www.xenith.net</td>
</tr>
<tr>
<th>6 </th>
<td>                http://www.tdbrecords.com</td>
</tr>
<tr>
<th>7 </th>
<td>     http://www.electrichumanproject.com/</td>
</tr>
<tr>
<th>8 </th>
<td>        http://tweekerchick.blogspot.com/</td>
</tr>
<tr>
<th>9 </th>
<td> http://www.besound.com/pushead/home.html</td>
</tr>
<tr>
<th>10</th>
<td>   http://www.porkchopscreenprinting.com/</td>
</tr>
<tr>
<th>11</th>
<td>              http://www.kinseyvisual.com</td>
</tr>
<tr>
<th>12</th>
<td>                http://www.rathergood.com</td>
</tr>
<tr>
<th>13</th>
<td>                   http://www.lepoint.fr/</td>
</tr>
<tr>
<th>14</th>
<td>                     http://www.revhq.com</td>
</tr>
<tr>
<th>15</th>
<td>           http://www.poprocksandcoke.com</td>
</tr>
<tr>
<th>16</th>
<td>              http://www.samuraiblue.com/</td>
</tr>
<tr>
<th>17</th>
<td>   http://www.openbsd.org/cgi-bin/man.cgi</td>
</tr>
<tr>
<th>18</th>
<td>                   http://www.sysblog.com</td>
</tr>
<tr>
<th>19</th>
<td>            http://www.voicesofsafety.com</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I'll split the URLs in several parts:</p>
<ul>
<li>schema (HTTP, FTP, SSH etc.)</li>
<li>host</li>
<li>port</li>
<li>path</li>
<li>query (?q=somevalue etc.)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [4]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Join root domain + suffix</span>
<span class="n">extract_root_domain</span> <span class="o">=</span>  <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">'.'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tldextract</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>

<span class="n">target_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'scheme'</span><span class="p">,</span> <span class="s">'userinfo'</span><span class="p">,</span> <span class="s">'host'</span><span class="p">,</span> <span class="s">'port'</span><span class="p">,</span> <span class="s">'path'</span><span class="p">,</span> <span class="s">'query'</span><span class="p">,</span> <span class="s">'fragment'</span><span class="p">,</span> <span class="s">'decoded'</span><span class="p">]</span>
<span class="n">target_component</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">URL</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">[</span><span class="s">'Target'</span><span class="p">]]</span>

<span class="n">df_targets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">target_component</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">target_columns</span><span class="p">)</span>
<span class="n">empty_hosts</span> <span class="o">=</span> <span class="n">df_targets</span><span class="p">[</span><span class="n">df_targets</span><span class="p">[</span><span class="s">'host'</span><span class="p">]</span> <span class="o">==</span> <span class="s">''</span><span class="p">]</span>

<span class="c"># Copy path information to host</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">empty_hosts</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">df_targets</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="p">][</span><span class="s">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_targets</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="p">][</span><span class="s">'path'</span><span class="p">]</span>
    <span class="n">df_targets</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="p">][</span><span class="s">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s">''</span>
    
<span class="c"># Extract root tld</span>
<span class="n">df_targets</span><span class="p">[</span><span class="s">'root_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_targets</span><span class="p">[</span><span class="s">'host'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">extract_root_domain</span><span class="p">)</span>

<span class="c"># Drop unnecessary columns</span>
<span class="n">df_targets</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'query'</span><span class="p">,</span> <span class="s">'fragment'</span><span class="p">,</span> <span class="s">'decoded'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Write df to file (for later use)</span>
<span class="n">df_targets</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"targets_df.csv"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"First 20 Entries"</span><span class="p">)</span>
<span class="n">df_targets</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">First 20 Entries
</pre>
</div>
</div>
<div class="output_area"><div class="prompt output_prompt">
    Out[4]:</div>
<div class="output_html rendered_html output_subarea output_pyout">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="table table-hover table-striped dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>scheme</th>
<th>userinfo</th>
<th>host</th>
<th>port</th>
<th>path</th>
<th>root_domain</th>
</tr>
</thead>
<tbody>
<tr>
<th>0 </th>
<td> http</td>
<td> </td>
<td>               www.altpress.org</td>
<td> </td>
<td>                  /</td>
<td>               altpress.org</td>
</tr>
<tr>
<th>1 </th>
<td> http</td>
<td> </td>
<td>           www.nzfortress.co.nz</td>
<td> </td>
<td> </td>
<td>           nzfortress.co.nz</td>
</tr>
<tr>
<th>2 </th>
<td> http</td>
<td> </td>
<td>         www.evillasforsale.com</td>
<td> </td>
<td> </td>
<td>         evillasforsale.com</td>
</tr>
<tr>
<th>3 </th>
<td> http</td>
<td> </td>
<td>           www.playingenemy.com</td>
<td> </td>
<td>                  /</td>
<td>           playingenemy.com</td>
</tr>
<tr>
<th>4 </th>
<td> http</td>
<td> </td>
<td>      www.richardsonscharts.com</td>
<td> </td>
<td> </td>
<td>      richardsonscharts.com</td>
</tr>
<tr>
<th>5 </th>
<td> http</td>
<td> </td>
<td>                 www.xenith.net</td>
<td> </td>
<td> </td>
<td>                 xenith.net</td>
</tr>
<tr>
<th>6 </th>
<td> http</td>
<td> </td>
<td>             www.tdbrecords.com</td>
<td> </td>
<td> </td>
<td>             tdbrecords.com</td>
</tr>
<tr>
<th>7 </th>
<td> http</td>
<td> </td>
<td>   www.electrichumanproject.com</td>
<td> </td>
<td>                  /</td>
<td>   electrichumanproject.com</td>
</tr>
<tr>
<th>8 </th>
<td> http</td>
<td> </td>
<td>      tweekerchick.blogspot.com</td>
<td> </td>
<td>                  /</td>
<td>  tweekerchick.blogspot.com</td>
</tr>
<tr>
<th>9 </th>
<td> http</td>
<td> </td>
<td>                www.besound.com</td>
<td> </td>
<td> /pushead/home.html</td>
<td>                besound.com</td>
</tr>
<tr>
<th>10</th>
<td> http</td>
<td> </td>
<td> www.porkchopscreenprinting.com</td>
<td> </td>
<td>                  /</td>
<td> porkchopscreenprinting.com</td>
</tr>
<tr>
<th>11</th>
<td> http</td>
<td> </td>
<td>           www.kinseyvisual.com</td>
<td> </td>
<td> </td>
<td>           kinseyvisual.com</td>
</tr>
<tr>
<th>12</th>
<td> http</td>
<td> </td>
<td>             www.rathergood.com</td>
<td> </td>
<td> </td>
<td>             rathergood.com</td>
</tr>
<tr>
<th>13</th>
<td> http</td>
<td> </td>
<td>                 www.lepoint.fr</td>
<td> </td>
<td>                  /</td>
<td>                 lepoint.fr</td>
</tr>
<tr>
<th>14</th>
<td> http</td>
<td> </td>
<td>                  www.revhq.com</td>
<td> </td>
<td> </td>
<td>                  revhq.com</td>
</tr>
<tr>
<th>15</th>
<td> http</td>
<td> </td>
<td>        www.poprocksandcoke.com</td>
<td> </td>
<td> </td>
<td>        poprocksandcoke.com</td>
</tr>
<tr>
<th>16</th>
<td> http</td>
<td> </td>
<td>            www.samuraiblue.com</td>
<td> </td>
<td>                  /</td>
<td>            samuraiblue.com</td>
</tr>
<tr>
<th>17</th>
<td> http</td>
<td> </td>
<td>                www.openbsd.org</td>
<td> </td>
<td>   /cgi-bin/man.cgi</td>
<td>                openbsd.org</td>
</tr>
<tr>
<th>18</th>
<td> http</td>
<td> </td>
<td>                www.sysblog.com</td>
<td> </td>
<td> </td>
<td>                sysblog.com</td>
</tr>
<tr>
<th>19</th>
<td> http</td>
<td> </td>
<td>         www.voicesofsafety.com</td>
<td> </td>
<td> </td>
<td>         voicesofsafety.com</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2dabe6a77ccfda96ebf503860b9427bd">Whois<a class="anchor-link" href="#Whois">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now get WHOIS information based on data in <code>df_targets</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [7]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="k">if</span> <span class="p">[</span> <span class="err">!</span> <span class="o">-</span><span class="n">d</span> <span class="s">"WHOIS"</span> <span class="p">];</span> <span class="n">then</span>
    <span class="n">mkdir</span> <span class="n">WHOIS</span>
<span class="n">fi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [8]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="c"># Get unique values</span>
<span class="n">uniq_roots</span> <span class="o">=</span> <span class="n">df_targets</span><span class="p">[</span><span class="s">'root_domain'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">uniq_subdomains</span> <span class="o">=</span> <span class="n">df_targets</span><span class="p">[</span><span class="s">'host'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [9]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="k">def</span> <span class="nf">date_handler</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">'isoformat'</span><span class="p">)</span> <span class="k">else</span> <span class="n">obj</span>

<span class="n">target_whois</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span> <span class="nf">fetch_whois</span><span class="p">(</span><span class="n">domains</span><span class="p">):</span>
    <span class="sd">""" Fetch WHOIS information for specified domains (list) """</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">domains</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Get WHOIS for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s"> ..."</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>

        <span class="c"># Check if file already exists</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s">"WHOIS/</span><span class="si">%s</span><span class="s">.json"</span> <span class="o">%</span> <span class="n">d</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"File exists already. Aborting."</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c"># Get whois information</span>
            <span class="n">whois_data</span> <span class="o">=</span> <span class="n">pythonwhois</span><span class="o">.</span><span class="n">get_whois</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

            <span class="c"># Convert to JSON$</span>
            <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">whois_data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">date_handler</span><span class="p">)</span>

            <span class="c"># Write contents to file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'WHOIS/</span><span class="si">%s</span><span class="s">.json'</span> <span class="o">%</span> <span class="n">d</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
              <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>

            <span class="c"># Sleep for 20s    </span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[ERROR] Couldn't retrieve WHOIS for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>
            
<span class="c"># I'll only fetch the root domains and only the first 20. Feel free to uncomment this</span>
<span class="c"># and adapt it to your needs.</span>
<span class="c">#fetch_whois(uniq_subdomains)</span>
<span class="n">fetch_whois</span><span class="p">(</span><span class="n">uniq_roots</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
    
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Get WHOIS for	 altpress.org ...
Get WHOIS for	 nzfortress.co.nz ...
Get WHOIS for	 evillasforsale.com ...
Get WHOIS for	 playingenemy.com ...
Get WHOIS for	 richardsonscharts.com ...
Get WHOIS for	 xenith.net ...
Get WHOIS for	 tdbrecords.com ...
Get WHOIS for	 electrichumanproject.com ...
Get WHOIS for	 tweekerchick.blogspot.com ...
Get WHOIS for	 besound.com ...
Get WHOIS for	 porkchopscreenprinting.com ...
Get WHOIS for	 kinseyvisual.com ...
Get WHOIS for	 rathergood.com ...
Get WHOIS for	 lepoint.fr ...
Get WHOIS for	 revhq.com ...
Get WHOIS for	 poprocksandcoke.com ...
Get WHOIS for	 samuraiblue.com ...
Get WHOIS for	 openbsd.org ...
Get WHOIS for	 sysblog.com ...
Get WHOIS for	 voicesofsafety.com ...
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="f18a085f288a90f503d9a5764e393120">Get all DNS records<a class="anchor-link" href="#Get-all-DNS-records">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [10]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="k">if</span> <span class="p">[</span> <span class="err">!</span> <span class="o">-</span><span class="n">d</span> <span class="s">"DNS"</span> <span class="p">];</span> <span class="n">then</span>
    <span class="n">mkdir</span> <span class="n">DNS</span>
<span class="n">fi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [11]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="k">def</span> <span class="nf">fetch_dns</span><span class="p">(</span><span class="n">domains</span><span class="p">):</span>
    <span class="sd">""" Fetch all DNS records for specified domains (list) """</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">domains</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Dig DNS records for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s"> ..."</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>

        <span class="c"># Check if file already exists</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s">"DNS/</span><span class="si">%s</span><span class="s">.txt"</span> <span class="o">%</span> <span class="n">d</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"File exists already. Aborting."</span><span class="p">)</span>
            <span class="k">continue</span>
            
        <span class="c"># Get DNS info</span>
        <span class="n">dig_data</span> <span class="o">=</span> <span class="err">!</span><span class="n">dig</span> <span class="o">+</span><span class="n">nocmd</span> <span class="err">$</span><span class="n">d</span> <span class="nb">any</span> <span class="o">+</span><span class="n">multiline</span> <span class="o">+</span><span class="n">noall</span> <span class="o">+</span><span class="n">answer</span>
        <span class="n">dig_output</span> <span class="o">=</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dig_data</span><span class="p">)</span>
        
        <span class="c"># Write contents to file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'DNS/</span><span class="si">%s</span><span class="s">.txt'</span> <span class="o">%</span> <span class="n">d</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dig_output</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        
<span class="c"># I'll only fetch the root domains and only the first 20. Feel free to uncomment this</span>
<span class="c"># and adapt it to your needs.</span>
<span class="c">#fetch_dns(uniq_subdomains)</span>
<span class="n">fetch_dns</span><span class="p">(</span><span class="n">uniq_roots</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Dig DNS records for	 altpress.org ...
Dig DNS records for	 nzfortress.co.nz ...
Dig DNS records for	 evillasforsale.com ...
Dig DNS records for	 playingenemy.com ...
Dig DNS records for	 richardsonscharts.com ...
Dig DNS records for	 xenith.net ...
Dig DNS records for	 tdbrecords.com ...
Dig DNS records for	 electrichumanproject.com ...
Dig DNS records for	 tweekerchick.blogspot.com ...
Dig DNS records for	 besound.com ...
Dig DNS records for	 porkchopscreenprinting.com ...
Dig DNS records for	 kinseyvisual.com ...
Dig DNS records for	 rathergood.com ...
Dig DNS records for	 lepoint.fr ...
Dig DNS records for	 revhq.com ...
Dig DNS records for	 poprocksandcoke.com ...
Dig DNS records for	 samuraiblue.com ...
Dig DNS records for	 openbsd.org ...
Dig DNS records for	 sysblog.com ...
Dig DNS records for	 voicesofsafety.com ...
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="9db3da1dbe0a6f374a239c637eb8d568">Read WHOIS information<a class="anchor-link" href="#Read-WHOIS-information">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After collecting the data I'll try to manipulate data in a pythonic way in order to export it later to some useful format like Excel. I'll therefor read the collected data from every single file, merge the data and create a <code>DataFrame</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [12]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="c"># Global DF frames</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">read_whois</span><span class="p">(</span><span class="n">domains</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">domains</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Reading WHOIS for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'WHOIS/</span><span class="si">%s</span><span class="s">.json'</span> <span class="o">%</span> <span class="n">d</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">inputfile</span><span class="p">:</span>
                <span class="n">whois</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inputfile</span><span class="p">))</span>

                <span class="c"># Delete raw record</span>
                <span class="n">whois</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">'raw'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

                <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                
                <span class="c"># Iterate contacts -&gt; tech</span>
                <span class="k">if</span> <span class="n">whois</span><span class="p">[</span><span class="s">'contacts'</span><span class="p">][</span><span class="s">'tech'</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">whois</span><span class="p">[</span><span class="s">'contacts'</span><span class="p">][</span><span class="s">'tech'</span><span class="p">]:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="s">'contacts'</span><span class="p">,</span> <span class="s">'tech'</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">whois</span><span class="p">[</span><span class="s">'contacts'</span><span class="p">][</span><span class="s">'tech'</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>

                <span class="c"># Iterate contacts -&gt; admin</span>
                <span class="k">if</span> <span class="n">whois</span><span class="p">[</span><span class="s">'contacts'</span><span class="p">][</span><span class="s">'admin'</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">whois</span><span class="p">[</span><span class="s">'contacts'</span><span class="p">][</span><span class="s">'admin'</span><span class="p">]:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="s">'contacts'</span><span class="p">,</span> <span class="s">'admin'</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">whois</span><span class="p">[</span><span class="s">'contacts'</span><span class="p">][</span><span class="s">'admin'</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>

                <span class="c"># Nameservers</span>
                <span class="k">if</span> <span class="s">"nameservers"</span> <span class="ow">in</span> <span class="n">whois</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">whois</span><span class="p">[</span><span class="s">'nameservers'</span><span class="p">]:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="s">'nameservers'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

                <span class="c"># Create DF only if data is not empty</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'domain'</span><span class="p">,</span> <span class="s">'element'</span><span class="p">,</span> <span class="s">'type'</span><span class="p">,</span> <span class="s">'field'</span><span class="p">,</span> <span class="s">'value'</span><span class="p">])</span>
                    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

                <span class="c"># Close file</span>
                <span class="n">inputfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[ERROR] Couldn't read WHOIS for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>

<span class="c">#read_whois(uniq_subdomains)</span>
<span class="n">read_whois</span><span class="p">(</span><span class="n">uniq_roots</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Reading WHOIS for	 altpress.org
Reading WHOIS for	 nzfortress.co.nz
Reading WHOIS for	 evillasforsale.com
Reading WHOIS for	 playingenemy.com
Reading WHOIS for	 richardsonscharts.com
Reading WHOIS for	 xenith.net
Reading WHOIS for	 tdbrecords.com
Reading WHOIS for	 electrichumanproject.com
Reading WHOIS for	 tweekerchick.blogspot.com
Reading WHOIS for	 besound.com
Reading WHOIS for	 porkchopscreenprinting.com
Reading WHOIS for	 kinseyvisual.com
Reading WHOIS for	 rathergood.com
Reading WHOIS for	 lepoint.fr
Reading WHOIS for	 revhq.com
Reading WHOIS for	 poprocksandcoke.com
Reading WHOIS for	 samuraiblue.com
Reading WHOIS for	 openbsd.org
Reading WHOIS for	 sysblog.com
Reading WHOIS for	 voicesofsafety.com
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [13]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_whois</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [14]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_whois</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s">'domain'</span><span class="p">,</span> <span class="s">'element'</span><span class="p">,</span> <span class="s">'type'</span><span class="p">,</span> <span class="s">'field'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">
    Out[14]:</div>
<div class="output_html rendered_html output_subarea output_pyout">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="table table-hover table-striped dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th></th>
<th></th>
<th>value</th>
</tr>
<tr>
<th>domain</th>
<th>element</th>
<th>type</th>
<th>field</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="22" valign="top">altpress.org</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                            Baltimore</td>
</tr>
<tr>
<th>handle</th>
<td>                                                        AB10045-GANDI</td>
</tr>
<tr>
<th>name</th>
<td>                                                           a.h.s. boy</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.4102358565</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MD</td>
</tr>
<tr>
<th>street</th>
<td>                                                   2710 N. Calvert St</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                21218</td>
</tr>
<tr>
<th>organization</th>
<td>                                                            dada typo</td>
</tr>
<tr>
<th>email</th>
<td>           29bcde81a3c0e645a9f2a60290ecf2df-1566139@contact.gandi.net</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                            Baltimore</td>
</tr>
<tr>
<th>handle</th>
<td>                                                        AB10045-GANDI</td>
</tr>
<tr>
<th>name</th>
<td>                                                           a.h.s. boy</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.4102358565</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MD</td>
</tr>
<tr>
<th>street</th>
<td>                                                   2710 N. Calvert St</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                21218</td>
</tr>
<tr>
<th>organization</th>
<td>                                                            dada typo</td>
</tr>
<tr>
<th>email</th>
<td>           29bcde81a3c0e645a9f2a60290ecf2df-1566139@contact.gandi.net</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                  DNS.NOTHINGNESS.ORG</td>
</tr>
<tr>
<th></th>
<td>                                                     DNS.DADATYPO.NET</td>
</tr>
<tr>
<th rowspan="20" valign="top">evillasforsale.com</th>
<th rowspan="18" valign="top">contacts</th>
<th rowspan="9" valign="top">tech</th>
<th>city</th>
<td>                                                           Manchester</td>
</tr>
<tr>
<th>name</th>
<td>                                                          Andy Deakin</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   GB</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       +44.1616605550</td>
</tr>
<tr>
<th>state</th>
<td>                                                   Greater Manchester</td>
</tr>
<tr>
<th>street</th>
<td>                                               66 Grosvenor St Denton</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                              M34 3GA</td>
</tr>
<tr>
<th>organization</th>
<td>                                PCmend.net Computer Solutions Limited</td>
</tr>
<tr>
<th>email</th>
<td>                                                   domains@pcmend.net</td>
</tr>
<tr>
<th rowspan="9" valign="top">admin</th>
<th>city</th>
<td>                                                           Manchester</td>
</tr>
<tr>
<th>name</th>
<td>                                                          Andy Deakin</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   GB</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       +44.1616605550</td>
</tr>
<tr>
<th>state</th>
<td>                                                   Greater Manchester</td>
</tr>
<tr>
<th>street</th>
<td>                                               66 Grosvenor St Denton</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                              M34 3GA</td>
</tr>
<tr>
<th>organization</th>
<td>                                PCmend.net Computer Solutions Limited</td>
</tr>
<tr>
<th>email</th>
<td>                                                   domains@pcmend.net</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                       NS1.PCMEND.NET</td>
</tr>
<tr>
<th></th>
<td>                                                       NS2.PCMEND.NET</td>
</tr>
<tr>
<th rowspan="2" valign="top">playingenemy.com</th>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                   ns04.a2z-server.jp</td>
</tr>
<tr>
<th></th>
<td>                                                  dns04.a2z-server.jp</td>
</tr>
<tr>
<th rowspan="22" valign="top">richardsonscharts.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                          New Bedford</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.5089926604</td>
</tr>
<tr>
<th>name</th>
<td>                                                 Garrity, Christopher</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.8888396604</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MA</td>
</tr>
<tr>
<th>street</th>
<td>                                           90 Hatch Street, 1st Floor</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                02745</td>
</tr>
<tr>
<th>organization</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>email</th>
<td>                                                 cgarrity@maptech.com</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                          New Bedford</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.5089926604</td>
</tr>
<tr>
<th>name</th>
<td>                                                           Estes, Lee</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.8888396604</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MA</td>
</tr>
<tr>
<th>street</th>
<td>                                           90 Hatch Street, 1st Floor</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                02745</td>
</tr>
<tr>
<th>organization</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>email</th>
<td>                                                   richcharts@aol.com</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                   NS2.TERENCENET.NET</td>
</tr>
<tr>
<th></th>
<td>                                                    NS.TERENCENET.NET</td>
</tr>
<tr>
<th rowspan="22" valign="top">xenith.net</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                         PALM SPRINGS</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.7603255504</td>
</tr>
<tr>
<th>name</th>
<td>                                                            DNS Admin</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.7603254755</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>street</th>
<td>                                        1001 S PALM CANYON DR STE 217</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                           92264-8349</td>
</tr>
<tr>
<th>organization</th>
<td>                                                            DNS Admin</td>
</tr>
<tr>
<th>email</th>
<td>                                                dns@ADVANCEDMINDS.COM</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                      San Luis Obispo</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.7345724470</td>
</tr>
<tr>
<th>name</th>
<td>                                                        Phelan, Kelly</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.7349456066</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>street</th>
<td>                                                    777 Mill St Apt 6</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                93401</td>
</tr>
<tr>
<th>organization</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>email</th>
<td>                                                   centaurus7@AOL.COM</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                              NS2.WEST-DATACENTER.NET</td>
</tr>
<tr>
<th></th>
<td>                                              NS1.WEST-DATACENTER.NET</td>
</tr>
<tr>
<th rowspan="21" valign="top">tdbrecords.com</th>
<th rowspan="18" valign="top">contacts</th>
<th rowspan="9" valign="top">tech</th>
<th>city</th>
<td>                                                               Boston</td>
</tr>
<tr>
<th>name</th>
<td>                                                     Jonah Livingston</td>
</tr>
<tr>
<th>country</th>
<td>                                                        United States</td>
</tr>
<tr>
<th>phone</th>
<td>                                                           6172308529</td>
</tr>
<tr>
<th>state</th>
<td>                                                        Massachusetts</td>
</tr>
<tr>
<th>street</th>
<td>                                                   902 Huntington ave</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                02115</td>
</tr>
<tr>
<th>organization</th>
<td>                                                          TDB Records</td>
</tr>
<tr>
<th>email</th>
<td>                                             bloodbathrecords@aol.com</td>
</tr>
<tr>
<th rowspan="9" valign="top">admin</th>
<th>city</th>
<td>                                                               Boston</td>
</tr>
<tr>
<th>name</th>
<td>                                                     Jonah Livingston</td>
</tr>
<tr>
<th>country</th>
<td>                                                        United States</td>
</tr>
<tr>
<th>phone</th>
<td>                                                           6172308529</td>
</tr>
<tr>
<th>state</th>
<td>                                                        Massachusetts</td>
</tr>
<tr>
<th>street</th>
<td>                                                   902 Huntington ave</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                02115</td>
</tr>
<tr>
<th>organization</th>
<td>                                                          TDB Records</td>
</tr>
<tr>
<th>email</th>
<td>                                             bloodbathrecords@aol.com</td>
</tr>
<tr>
<th rowspan="3" valign="top">nameservers</th>
<th rowspan="3" valign="top"></th>
<th></th>
<td>                                                    NS1.DREAMHOST.COM</td>
</tr>
<tr>
<th></th>
<td>                                                    NS2.DREAMHOST.COM</td>
</tr>
<tr>
<th></th>
<td>                                                    NS3.DREAMHOST.COM</td>
</tr>
<tr>
<th rowspan="20" valign="top">electrichumanproject.com</th>
<th rowspan="18" valign="top">contacts</th>
<th rowspan="9" valign="top">tech</th>
<th>city</th>
<td>                                                              Tsukuba</td>
</tr>
<tr>
<th>name</th>
<td>                                        840Domains Tsukuba 840Domains</td>
</tr>
<tr>
<th>country</th>
<td>                                                                Japan</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       +81.5055349763</td>
</tr>
<tr>
<th>state</th>
<td>                                                              Ibaraki</td>
</tr>
<tr>
<th>street</th>
<td>                        Baien 2-1-15\nSupuringutekku Tsukuba bld. 401</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                             305-0045</td>
</tr>
<tr>
<th>organization</th>
<td>                                                              Tsukuba</td>
</tr>
<tr>
<th>email</th>
<td>                                          domain_resister@yahoo.co.jp</td>
</tr>
<tr>
<th rowspan="9" valign="top">admin</th>
<th>city</th>
<td>                                                              Tsukuba</td>
</tr>
<tr>
<th>name</th>
<td>                                        840Domains Tsukuba 840Domains</td>
</tr>
<tr>
<th>country</th>
<td>                                                                Japan</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       +81.5055349763</td>
</tr>
<tr>
<th>state</th>
<td>                                                              Ibaraki</td>
</tr>
<tr>
<th>street</th>
<td>                        Baien 2-1-15\nSupuringutekku Tsukuba bld. 401</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                             305-0045</td>
</tr>
<tr>
<th>organization</th>
<td>                                                              Tsukuba</td>
</tr>
<tr>
<th>email</th>
<td>                                          domain_resister@yahoo.co.jp</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                             SNS41.WEBSITEWELCOME.COM</td>
</tr>
<tr>
<th></th>
<td>                                             SNS42.WEBSITEWELCOME.COM</td>
</tr>
<tr>
<th rowspan="21" valign="top">besound.com</th>
<th rowspan="19" valign="top">contacts</th>
<th rowspan="9" valign="top">tech</th>
<th>city</th>
<td>                                                            San Diego</td>
</tr>
<tr>
<th>fax</th>
<td>                                                         858-450-0567</td>
</tr>
<tr>
<th>country</th>
<td>                                                        United States</td>
</tr>
<tr>
<th>phone</th>
<td>                                                         858-458-0490</td>
</tr>
<tr>
<th>state</th>
<td>                                                           California</td>
</tr>
<tr>
<th>street</th>
<td>                                                   5266 Eastgate Mall</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                92121</td>
</tr>
<tr>
<th>organization</th>
<td>                                                                A+Net</td>
</tr>
<tr>
<th>email</th>
<td>                                                         dns@abac.com</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                          LINDENHURST</td>
</tr>
<tr>
<th>fax</th>
<td>                                                         999 999 9999</td>
</tr>
<tr>
<th>name</th>
<td>                                                        Richard Lopez</td>
</tr>
<tr>
<th>country</th>
<td>                                                        United States</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       (516) 226-8430</td>
</tr>
<tr>
<th>state</th>
<td>                                                             New York</td>
</tr>
<tr>
<th>street</th>
<td>                                                          180 34TH ST</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                           11757-3243</td>
</tr>
<tr>
<th>organization</th>
<td>                                                   BeSound Multimedia</td>
</tr>
<tr>
<th>email</th>
<td>                                                besound@optonline.net</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                              BDNS.CV.SITEPROTECT.COM</td>
</tr>
<tr>
<th></th>
<td>                                              ADNS.CV.SITEPROTECT.COM</td>
</tr>
<tr>
<th rowspan="18" valign="top">porkchopscreenprinting.com</th>
<th rowspan="16" valign="top">contacts</th>
<th rowspan="8" valign="top">tech</th>
<th>city</th>
<td>                                                             New York</td>
</tr>
<tr>
<th>name</th>
<td>                                                     Domain Registrar</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.9027492701</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   NY</td>
</tr>
<tr>
<th>street</th>
<td>                                            575 8th Avenue 11th Floor</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                10018</td>
</tr>
<tr>
<th>organization</th>
<td>                                                         Register.Com</td>
</tr>
<tr>
<th rowspan="8" valign="top">admin</th>
<th>city</th>
<td>                                                              Seattle</td>
</tr>
<tr>
<th>name</th>
<td>                                                        Damon Baldwin</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.2067064764</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   WA</td>
</tr>
<tr>
<th>street</th>
<td>                                                      9218 9th ave NW</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                98117</td>
</tr>
<tr>
<th>organization</th>
<td>                                            Pork Chop Screen Printing</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                            ns1.hosting-advantage.com</td>
</tr>
<tr>
<th></th>
<td>                                            ns2.hosting-advantage.com</td>
</tr>
<tr>
<th rowspan="22" valign="top">kinseyvisual.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                          Culver City</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.8186498230</td>
</tr>
<tr>
<th>name</th>
<td>                                                ADMINISTRATOR, DOMAIN</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.8775784000</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>street</th>
<td>                                               8520 National Blvd. #A</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                90232</td>
</tr>
<tr>
<th>organization</th>
<td>                                                         Media Temple</td>
</tr>
<tr>
<th>email</th>
<td>                                             dnsadmin@MEDIATEMPLE.NET</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                            SAN DIEGO</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.6195449594</td>
</tr>
<tr>
<th>name</th>
<td>                                                         Kinsey, Dave</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.6195449595</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>street</th>
<td>                                                         705 12TH AVE</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                           92101-6507</td>
</tr>
<tr>
<th>organization</th>
<td>                                                         BlkMkrt Inc.</td>
</tr>
<tr>
<th>email</th>
<td>                                                     dave@BLKMRKT.COM</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                  NS1.MEDIATEMPLE.NET</td>
</tr>
<tr>
<th></th>
<td>                                                  NS2.MEDIATEMPLE.NET</td>
</tr>
<tr>
<th rowspan="23" valign="top">rathergood.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                               London</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.9999999999</td>
</tr>
<tr>
<th>name</th>
<td>                                                         Veitch, Joel</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   UK</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       +1.08072547734</td>
</tr>
<tr>
<th>state</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>street</th>
<td>                                                    10 Croston Street</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>organization</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>email</th>
<td>                                                  joel@rathergood.com</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                               London</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.9999999999</td>
</tr>
<tr>
<th>name</th>
<td>                                                         Veitch, Joel</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   UK</td>
</tr>
<tr>
<th>phone</th>
<td>                                                       +1.08072547734</td>
</tr>
<tr>
<th>state</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>street</th>
<td>                                                    10 Croston Street</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>organization</th>
<td>                                                                 null</td>
</tr>
<tr>
<th>email</th>
<td>                                                  joel@rathergood.com</td>
</tr>
<tr>
<th rowspan="3" valign="top">nameservers</th>
<th rowspan="3" valign="top"></th>
<th></th>
<td>                                                    NS1.DREAMHOST.COM</td>
</tr>
<tr>
<th></th>
<td>                                                    NS3.DREAMHOST.COM</td>
</tr>
<tr>
<th></th>
<td>                                                    NS2.DREAMHOST.COM</td>
</tr>
<tr>
<th rowspan="22" valign="top">lepoint.fr</th>
<th rowspan="19" valign="top">contacts</th>
<th rowspan="9" valign="top">tech</th>
<th>city</th>
<td>                                                                Paris</td>
</tr>
<tr>
<th>handle</th>
<td>                                                          GR283-FRNIC</td>
</tr>
<tr>
<th>name</th>
<td>                                                           GANDI ROLE</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   FR</td>
</tr>
<tr>
<th>street</th>
<td>                                        Gandi\n15, place de la Nation</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                75011</td>
</tr>
<tr>
<th>type</th>
<td>                                                                 ROLE</td>
</tr>
<tr>
<th>email</th>
<td>                                                        noc@gandi.net</td>
</tr>
<tr>
<th>changedate</th>
<td>                                                  2006-03-03T00:00:00</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                                Paris</td>
</tr>
<tr>
<th>handle</th>
<td>                                                        SDED175-FRNIC</td>
</tr>
<tr>
<th>name</th>
<td>                    SOCIETE D'EXPLOITATION DE L'HEBDOMADAIRE LE POINT</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   FR</td>
</tr>
<tr>
<th>phone</th>
<td>                                                    +33 1 44 10 10 10</td>
</tr>
<tr>
<th>street</th>
<td>                                                  74, avenue du maine</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                75014</td>
</tr>
<tr>
<th>type</th>
<td>                                                         ORGANIZATION</td>
</tr>
<tr>
<th>email</th>
<td>            b396c2138803c796a2cc37d347a1797c-857941@contact.gandi.net</td>
</tr>
<tr>
<th>changedate</th>
<td>                                                  2013-07-10T00:00:00</td>
</tr>
<tr>
<th rowspan="3" valign="top">nameservers</th>
<th rowspan="3" valign="top"></th>
<th></th>
<td>                                                      b.dns.gandi.net</td>
</tr>
<tr>
<th></th>
<td>                                                      a.dns.gandi.net</td>
</tr>
<tr>
<th></th>
<td>                                                      c.dns.gandi.net</td>
</tr>
<tr>
<th rowspan="24" valign="top">revhq.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                     HUNTINGTON BEACH</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.5555555555</td>
</tr>
<tr>
<th>name</th>
<td>                                                        JORDAN COOPER</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.7148427584</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>street</th>
<td>                                                        P.O. BOX 5232</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                92615</td>
</tr>
<tr>
<th>organization</th>
<td>                                                     REV DISTRIBUTION</td>
</tr>
<tr>
<th>email</th>
<td>                                                    JCOOPER@REVHQ.COM</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                     HUNTINGTON BEACH</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.5555555555</td>
</tr>
<tr>
<th>name</th>
<td>                                                        JORDAN COOPER</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.7148427584</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>street</th>
<td>                                                        P.O. BOX 5232</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                92615</td>
</tr>
<tr>
<th>organization</th>
<td>                                                     REV DISTRIBUTION</td>
</tr>
<tr>
<th>email</th>
<td>                                                    JCOOPER@REVHQ.COM</td>
</tr>
<tr>
<th rowspan="4" valign="top">nameservers</th>
<th rowspan="4" valign="top"></th>
<th></th>
<td>                                                      NS1.CLOUDNS.NET</td>
</tr>
<tr>
<th></th>
<td>                                                      NS2.CLOUDNS.NET</td>
</tr>
<tr>
<th></th>
<td>                                                      NS3.CLOUDNS.NET</td>
</tr>
<tr>
<th></th>
<td>                                                      NS4.CLOUDNS.NET</td>
</tr>
<tr>
<th rowspan="18" valign="top">poprocksandcoke.com</th>
<th rowspan="16" valign="top">contacts</th>
<th rowspan="8" valign="top">tech</th>
<th>city</th>
<td>                                                            Ljubljana</td>
</tr>
<tr>
<th>name</th>
<td>                                                         Matija Zajec</td>
</tr>
<tr>
<th>country</th>
<td>                                                             Slovenia</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +386.30363699</td>
</tr>
<tr>
<th>state</th>
<td>                                                    Osrednjeslovenska</td>
</tr>
<tr>
<th>street</th>
<td>                                                  Krizevniska ulica 7</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                 1000</td>
</tr>
<tr>
<th>email</th>
<td>                                                     kukmak@gmail.com</td>
</tr>
<tr>
<th rowspan="8" valign="top">admin</th>
<th>city</th>
<td>                                                            Ljubljana</td>
</tr>
<tr>
<th>name</th>
<td>                                                         Matija Zajec</td>
</tr>
<tr>
<th>country</th>
<td>                                                             Slovenia</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +386.30363699</td>
</tr>
<tr>
<th>state</th>
<td>                                                    Osrednjeslovenska</td>
</tr>
<tr>
<th>street</th>
<td>                                                  Krizevniska ulica 7</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                 1000</td>
</tr>
<tr>
<th>email</th>
<td>                                                     kukmak@gmail.com</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                        NS3.WEBDNS.PW</td>
</tr>
<tr>
<th></th>
<td>                                                        NS4.WEBDNS.PW</td>
</tr>
<tr>
<th rowspan="22" valign="top">samuraiblue.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                           Louisville</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.5025692774</td>
</tr>
<tr>
<th>name</th>
<td>                                                      MaximumASP, LLC</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.5025692771</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   KY</td>
</tr>
<tr>
<th>street</th>
<td>                                                    540 Baxter Avenue</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                40204</td>
</tr>
<tr>
<th>organization</th>
<td>                                                      MaximumASP, LLC</td>
</tr>
<tr>
<th>email</th>
<td>                                                   noc@maximumasp.com</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                                Tampa</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.9999999999</td>
</tr>
<tr>
<th>name</th>
<td>                                                         Meronek, Rob</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                         +1.838575819</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   FL</td>
</tr>
<tr>
<th>street</th>
<td>                                         777 North Ashley Drive #1212</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                33602</td>
</tr>
<tr>
<th>organization</th>
<td>                                                           The Boardr</td>
</tr>
<tr>
<th>email</th>
<td>                                                      rob@meronek.com</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                    DNS1.MIDPHASE.COM</td>
</tr>
<tr>
<th></th>
<td>                                                    DNS2.MIDPHASE.COM</td>
</tr>
<tr>
<th rowspan="27" valign="top">openbsd.org</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                      Calgary Alberta</td>
</tr>
<tr>
<th>handle</th>
<td>                                                           CR32086106</td>
</tr>
<tr>
<th>name</th>
<td>                                                       Theos Software</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>phone</th>
<td>                                                          +1.40323798</td>
</tr>
<tr>
<th>state</th>
<td>                                                              Alberta</td>
</tr>
<tr>
<th>street</th>
<td>                                                      812 23rd ave SE</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                              T2G 1N8</td>
</tr>
<tr>
<th>organization</th>
<td>                                                       Theos Software</td>
</tr>
<tr>
<th>email</th>
<td>                                                    deraadt@theos.com</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                              Calgary</td>
</tr>
<tr>
<th>handle</th>
<td>                                                           CR32086107</td>
</tr>
<tr>
<th>name</th>
<td>                                                        Theo de Raadt</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   CA</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.4032379834</td>
</tr>
<tr>
<th>state</th>
<td>                                                              Alberta</td>
</tr>
<tr>
<th>street</th>
<td>                                                      812 23rd Ave SE</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                               T2G1N8</td>
</tr>
<tr>
<th>organization</th>
<td>                                                       Theos Software</td>
</tr>
<tr>
<th>email</th>
<td>                                                    deraadt@theos.com</td>
</tr>
<tr>
<th rowspan="7" valign="top">nameservers</th>
<th rowspan="7" valign="top"></th>
<th></th>
<td>                                                      NS1.TELSTRA.NET</td>
</tr>
<tr>
<th></th>
<td>                                                     NS.SIGMASOFT.COM</td>
</tr>
<tr>
<th></th>
<td>                                                   NS1.SUPERBLOCK.NET</td>
</tr>
<tr>
<th></th>
<td>                                                   NS2.SUPERBLOCK.NET</td>
</tr>
<tr>
<th></th>
<td>                                                       ZEUS.THEOS.COM</td>
</tr>
<tr>
<th></th>
<td>                                                         C.NS.BSWS.DE</td>
</tr>
<tr>
<th></th>
<td>                                                         A.NS.BSWS.DE</td>
</tr>
<tr>
<th rowspan="22" valign="top">sysblog.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                              Waltham</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.7818392801</td>
</tr>
<tr>
<th>name</th>
<td> Toll Free: 866-822-9073 Worldwide: 339-222-5132 This Domain For Sale</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.8668229073</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MA</td>
</tr>
<tr>
<th>street</th>
<td>                                                 738 Main Street #389</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                02451</td>
</tr>
<tr>
<th>organization</th>
<td>                                                       BuyDomains.com</td>
</tr>
<tr>
<th>email</th>
<td>                                             brokerage@buydomains.com</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                              Waltham</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.7818392801</td>
</tr>
<tr>
<th>name</th>
<td> Toll Free: 866-822-9073 Worldwide: 339-222-5132 This Domain For Sale</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.8668229073</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MA</td>
</tr>
<tr>
<th>street</th>
<td>                                                 738 Main Street #389</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                02451</td>
</tr>
<tr>
<th>organization</th>
<td>                                                       BuyDomains.com</td>
</tr>
<tr>
<th>email</th>
<td>                                             brokerage@buydomains.com</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                                    NS.BUYDOMAINS.COM</td>
</tr>
<tr>
<th></th>
<td>                                             THIS-DOMAIN-FOR-SALE.COM</td>
</tr>
<tr>
<th rowspan="22" valign="top">voicesofsafety.com</th>
<th rowspan="20" valign="top">contacts</th>
<th rowspan="10" valign="top">tech</th>
<th>city</th>
<td>                                                           Burlington</td>
</tr>
<tr>
<th>fax</th>
<td>                                                         +1.782722915</td>
</tr>
<tr>
<th>name</th>
<td>                                                    BizLand.com, Inc.</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                         +1.782725585</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   MA</td>
</tr>
<tr>
<th>street</th>
<td>                                               121 Middlesex Turnpike</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                01803</td>
</tr>
<tr>
<th>organization</th>
<td>                                                    BizLand.com, Inc.</td>
</tr>
<tr>
<th>email</th>
<td>                                               DomReg@BIZLAND-INC.COM</td>
</tr>
<tr>
<th rowspan="10" valign="top">admin</th>
<th>city</th>
<td>                                                      NORTHE COLDWELL</td>
</tr>
<tr>
<th>fax</th>
<td>                                                        +1.9732280276</td>
</tr>
<tr>
<th>name</th>
<td>                                                  VOICESOFSAFTY INT'L</td>
</tr>
<tr>
<th>country</th>
<td>                                                                   US</td>
</tr>
<tr>
<th>phone</th>
<td>                                                        +1.9732282258</td>
</tr>
<tr>
<th>state</th>
<td>                                                                   NJ</td>
</tr>
<tr>
<th>street</th>
<td>                                                         264 park ave</td>
</tr>
<tr>
<th>postalcode</th>
<td>                                                                07006</td>
</tr>
<tr>
<th>organization</th>
<td>                                                  VOICESOFSAFTY INT'L</td>
</tr>
<tr>
<th>email</th>
<td>                                         webmaster@voicesofsafety.com</td>
</tr>
<tr>
<th rowspan="2" valign="top">nameservers</th>
<th rowspan="2" valign="top"></th>
<th></th>
<td>                                              CLICKME2.CLICK2SITE.COM</td>
</tr>
<tr>
<th></th>
<td>                                               CLICKME.CLICK2SITE.COM</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1bff3d5c0a0b50883a1dc1277d2da5a1">Read DNS information<a class="anchor-link" href="#Read-DNS-information">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do the same with the DNS files... </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [15]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">traceback</span>

<span class="c"># Global DF frames</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">read_dns</span><span class="p">(</span><span class="n">domains</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">domains</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Reading WHOIS for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'DNS/</span><span class="si">%s</span><span class="s">.txt'</span> <span class="o">%</span> <span class="n">d</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">inputfile</span><span class="p">:</span>
                <span class="n">dns</span> <span class="o">=</span> <span class="n">inputfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">dns</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
                    <span class="n">records</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    
                    <span class="c"># Check only for NS, MX, A, CNAME, TXT</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">"^(NS|MX|A|CNAME|TXT)$"</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
                            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="n">records</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">records</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
                
                <span class="c"># Create DF only if data is not empty</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'domain'</span><span class="p">,</span> <span class="s">'dns_record'</span><span class="p">,</span> <span class="s">'value'</span><span class="p">])</span>
                    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>      
                    
                <span class="c"># Close file</span>
                <span class="n">inputfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[ERROR] Couldn't read WHOIS for</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>

<span class="c">#read_dns(uniq_subdomains)            </span>
<span class="n">read_dns</span><span class="p">(</span><span class="n">uniq_roots</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Reading WHOIS for	 altpress.org
Reading WHOIS for	 nzfortress.co.nz
Reading WHOIS for	 evillasforsale.com
Reading WHOIS for	 playingenemy.com
Reading WHOIS for	 richardsonscharts.com
Reading WHOIS for	 xenith.net
Reading WHOIS for	 tdbrecords.com
Reading WHOIS for	 electrichumanproject.com
Reading WHOIS for	 tweekerchick.blogspot.com
Reading WHOIS for	 besound.com
Reading WHOIS for	 porkchopscreenprinting.com
Reading WHOIS for	 kinseyvisual.com
Reading WHOIS for	 rathergood.com
Reading WHOIS for	 lepoint.fr
Reading WHOIS for	 revhq.com
Reading WHOIS for	 poprocksandcoke.com
Reading WHOIS for	 samuraiblue.com
Reading WHOIS for	 openbsd.org
Reading WHOIS for	 sysblog.com
Reading WHOIS for	 voicesofsafety.com
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [16]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_dns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [17]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_dns</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s">'domain'</span><span class="p">,</span> <span class="s">'dns_record'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">
    Out[17]:</div>
<div class="output_html rendered_html output_subarea output_pyout">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="table table-hover table-striped dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>value</th>
</tr>
<tr>
<th>domain</th>
<th>dns_record</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">altpress.org</th>
<th>NS</th>
<td>                 dns.dadatypo.net.</td>
</tr>
<tr>
<th>NS</th>
<td>              dns.nothingness.org.</td>
</tr>
<tr>
<th rowspan="4" valign="top">nzfortress.co.nz</th>
<th>NS</th>
<td>          ns-1637.awsdns-12.co.uk.</td>
</tr>
<tr>
<th>NS</th>
<td>             ns-913.awsdns-50.net.</td>
</tr>
<tr>
<th>NS</th>
<td>             ns-203.awsdns-25.com.</td>
</tr>
<tr>
<th>NS</th>
<td>            ns-1284.awsdns-32.org.</td>
</tr>
<tr>
<th rowspan="2" valign="top">evillasforsale.com</th>
<th>NS</th>
<td>                   ns2.pcmend.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                   ns1.pcmend.net.</td>
</tr>
<tr>
<th rowspan="2" valign="top">playingenemy.com</th>
<th>NS</th>
<td>              dns04.a2z-server.jp.</td>
</tr>
<tr>
<th>NS</th>
<td>               ns04.a2z-server.jp.</td>
</tr>
<tr>
<th rowspan="8" valign="top">richardsonscharts.com</th>
<th>NS</th>
<td>               ns2.interbasix.net.</td>
</tr>
<tr>
<th>A</th>
<td>                     207.97.239.35</td>
</tr>
<tr>
<th>MX</th>
<td>                                10</td>
</tr>
<tr>
<th>TXT</th>
<td>                           "v=spf1</td>
</tr>
<tr>
<th>NS</th>
<td>                ns.interbasix.net.</td>
</tr>
<tr>
<th>MX</th>
<td>                                30</td>
</tr>
<tr>
<th>MX</th>
<td>                                40</td>
</tr>
<tr>
<th>MX</th>
<td>                                20</td>
</tr>
<tr>
<th rowspan="4" valign="top">xenith.net</th>
<th>NS</th>
<td>          ns1.west-datacenter.net.</td>
</tr>
<tr>
<th>NS</th>
<td>          ns2.west-datacenter.net.</td>
</tr>
<tr>
<th>A</th>
<td>                    206.130.121.98</td>
</tr>
<tr>
<th>MX</th>
<td>                                10</td>
</tr>
<tr>
<th rowspan="6" valign="top">tdbrecords.com</th>
<th>NS</th>
<td>                ns2.dreamhost.com.</td>
</tr>
<tr>
<th>NS</th>
<td>                ns1.dreamhost.com.</td>
</tr>
<tr>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>NS</th>
<td>                ns3.dreamhost.com.</td>
</tr>
<tr>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>A</th>
<td>                     75.119.220.89</td>
</tr>
<tr>
<th rowspan="3" valign="top">electrichumanproject.com</th>
<th>NS</th>
<td>         sns41.websitewelcome.com.</td>
</tr>
<tr>
<th>NS</th>
<td>         sns42.websitewelcome.com.</td>
</tr>
<tr>
<th>A</th>
<td>                       67.18.68.14</td>
</tr>
<tr>
<th rowspan="4" valign="top">tweekerchick.blogspot.com</th>
<th>CNAME</th>
<td> blogspot.l.googleusercontent.com.</td>
</tr>
<tr>
<th>A</th>
<td>                     173.194.44.10</td>
</tr>
<tr>
<th>A</th>
<td>                     173.194.44.12</td>
</tr>
<tr>
<th>A</th>
<td>                     173.194.44.11</td>
</tr>
<tr>
<th rowspan="2" valign="top">besound.com</th>
<th>NS</th>
<td>          bdns.cv.siteprotect.com.</td>
</tr>
<tr>
<th>NS</th>
<td>          adns.cv.siteprotect.com.</td>
</tr>
<tr>
<th rowspan="4" valign="top">porkchopscreenprinting.com</th>
<th>NS</th>
<td>        ns1.hosting-advantage.com.</td>
</tr>
<tr>
<th>NS</th>
<td>        ns2.hosting-advantage.com.</td>
</tr>
<tr>
<th>A</th>
<td>                      64.92.121.42</td>
</tr>
<tr>
<th>MX</th>
<td>                                 5</td>
</tr>
<tr>
<th rowspan="4" valign="top">kinseyvisual.com</th>
<th>A</th>
<td>                   205.186.183.161</td>
</tr>
<tr>
<th>NS</th>
<td>              ns1.mediatemple.net.</td>
</tr>
<tr>
<th>MX</th>
<td>                                10</td>
</tr>
<tr>
<th>NS</th>
<td>              ns2.mediatemple.net.</td>
</tr>
<tr>
<th rowspan="6" valign="top">rathergood.com</th>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>NS</th>
<td>                ns2.dreamhost.com.</td>
</tr>
<tr>
<th>NS</th>
<td>                ns1.dreamhost.com.</td>
</tr>
<tr>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>NS</th>
<td>                ns3.dreamhost.com.</td>
</tr>
<tr>
<th>A</th>
<td>                      64.90.57.150</td>
</tr>
<tr>
<th rowspan="3" valign="top">lepoint.fr</th>
<th>NS</th>
<td>                  c.dns.gandi.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                  b.dns.gandi.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                  a.dns.gandi.net.</td>
</tr>
<tr>
<th rowspan="4" valign="top">revhq.com</th>
<th>NS</th>
<td>                  ns1.cloudns.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                  ns4.cloudns.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                  ns3.cloudns.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                  ns2.cloudns.net.</td>
</tr>
<tr>
<th rowspan="4" valign="top">poprocksandcoke.com</th>
<th>A</th>
<td>                   184.164.147.132</td>
</tr>
<tr>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>NS</th>
<td>                    ns3.webdns.pw.</td>
</tr>
<tr>
<th>NS</th>
<td>                    ns4.webdns.pw.</td>
</tr>
<tr>
<th rowspan="5" valign="top">samuraiblue.com</th>
<th>NS</th>
<td>               dns1.anhosting.com.</td>
</tr>
<tr>
<th>NS</th>
<td>               dns2.anhosting.com.</td>
</tr>
<tr>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>TXT</th>
<td>                           "v=spf1</td>
</tr>
<tr>
<th>A</th>
<td>                   174.127.110.249</td>
</tr>
<tr>
<th rowspan="10" valign="top">openbsd.org</th>
<th>NS</th>
<td>                     c.ns.bsws.de.</td>
</tr>
<tr>
<th>NS</th>
<td>               ns2.superblock.net.</td>
</tr>
<tr>
<th>A</th>
<td>                     129.128.5.194</td>
</tr>
<tr>
<th>NS</th>
<td>                     a.ns.bsws.de.</td>
</tr>
<tr>
<th>NS</th>
<td>               ns1.superblock.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                 ns.sigmasoft.com.</td>
</tr>
<tr>
<th>NS</th>
<td>                  ns1.telstra.net.</td>
</tr>
<tr>
<th>NS</th>
<td>                   zeus.theos.com.</td>
</tr>
<tr>
<th>MX</th>
<td>                                10</td>
</tr>
<tr>
<th>MX</th>
<td>                                 6</td>
</tr>
<tr>
<th rowspan="3" valign="top">sysblog.com</th>
<th>MX</th>
<td>                                 0</td>
</tr>
<tr>
<th>A</th>
<td>                     66.151.181.49</td>
</tr>
<tr>
<th>TXT</th>
<td>                           "v=spf1</td>
</tr>
<tr>
<th rowspan="2" valign="top">voicesofsafety.com</th>
<th>NS</th>
<td>           clickme.click2site.com.</td>
</tr>
<tr>
<th>NS</th>
<td>          clickme2.click2site.com.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="d913d15f4a6c7f95548e4ec9c64ea2ec">Connect to targets<a class="anchor-link" href="#Connect-to-targets">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For every single target I'll connect to it per HTTP(s) using <code>urllib2</code> and store the HTTP headers. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [19]:
</div>
<div class="collapseheader box-flex1"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area box-flex1" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">httplib</span>


<span class="n">c_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">[</span><span class="s">'Target'</span><span class="p">][:</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># Collect here all URLs failed to connect to</span>
<span class="n">error_urls</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">send_request</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">""" Sends a single request to the target """</span>            
    
    <span class="c"># Set own headers</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'User-Agent'</span> <span class="p">:</span> <span class="s">'Mozilla 5.10'</span><span class="p">}</span>

    <span class="c"># Create request</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
    
    <span class="c"># Default response</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">None</span>
        
    <span class="k">try</span><span class="p">:</span>
        <span class="c"># Send request</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="c"># Add headers</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">info</span><span class="p">():</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">target</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">info</span><span class="p">()[</span><span class="n">h</span><span class="p">]])</span>
        
    <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[ERROR] HTTPError = '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">target</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">])</span>
            
    <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[ERROR] URLError = '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">))</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">target</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">])</span>
            
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="c"># Most probably the target didn't have any schema</span>
        <span class="c"># So send the request again with HTTP</span>
        <span class="n">error_urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[ERROR] ValueError = '</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            
    <span class="k">except</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[ERROR] HTTPException'</span><span class="p">)</span>
            
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">traceback</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[ERROR] Exception: '</span> <span class="o">+</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
        
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span>
        

    
    
<span class="k">def</span> <span class="nf">open_connection</span><span class="p">(</span><span class="n">targets</span><span class="p">):</span>
    <span class="sd">""" Iterate through targets and send requests """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Connecting to</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="n">send_request</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        
    <span class="c"># Create DF only if data is not empty</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'url'</span><span class="p">,</span> <span class="s">'response'</span><span class="p">,</span> <span class="s">'header'</span><span class="p">,</span> <span class="s">'value'</span><span class="p">])</span>
        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>    
        

<span class="c"># Open connection to targets and collect information</span>
<span class="n">open_connection</span><span class="p">(</span><span class="n">c_targets</span><span class="p">)</span>

<span class="c"># If there are any urls not having been tested, then</span>
<span class="c"># prepend http:// to &lt;target&gt; and run again</span>
<span class="n">new_targets</span> <span class="o">=</span>  <span class="p">[</span><span class="s">"http://"</span><span class="o">+</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">error_urls</span><span class="p">]</span>
<span class="n">open_connection</span><span class="p">(</span><span class="n">new_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Connecting to	 http://www.altpress.org/
Connecting to	 http://www.nzfortress.co.nz
Connecting to	 http://www.evillasforsale.com
Connecting to	 http://www.playingenemy.com/
[ERROR] URLError = timed out
Connecting to	 http://www.richardsonscharts.com
Connecting to	 http://www.xenith.net
[ERROR] Exception: Traceback (most recent call last):
  File "&lt;ipython-input-19-d057092f77b5&gt;", line 26, in send_request
    response = urllib2.urlopen(request, timeout=5)
  File "/usr/lib/python2.7/urllib2.py", line 127, in urlopen
    return _opener.open(url, data, timeout)
  File "/usr/lib/python2.7/urllib2.py", line 401, in open
    response = self._open(req, data)
  File "/usr/lib/python2.7/urllib2.py", line 419, in _open
    &amp;apos;_open&amp;apos;, req)
  File "/usr/lib/python2.7/urllib2.py", line 379, in _call_chain
    result = func(*args)
  File "/usr/lib/python2.7/urllib2.py", line 1211, in http_open
    return self.do_open(httplib.HTTPConnection, req)
  File "/usr/lib/python2.7/urllib2.py", line 1184, in do_open
    r = h.getresponse(buffering=True)
  File "/usr/lib/python2.7/httplib.py", line 1034, in getresponse
    response.begin()
  File "/usr/lib/python2.7/httplib.py", line 407, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python2.7/httplib.py", line 365, in _read_status
    line = self.fp.readline()
  File "/usr/lib/python2.7/socket.py", line 447, in readline
    data = self._sock.recv(self._rbufsize)
timeout: timed out

Connecting to	 http://www.tdbrecords.com
Connecting to	 http://www.electrichumanproject.com/
Connecting to	 http://tweekerchick.blogspot.com/
Connecting to	 http://www.besound.com/pushead/home.html
Connecting to	 http://www.porkchopscreenprinting.com/
Connecting to	 http://www.kinseyvisual.com
Connecting to	 http://www.rathergood.com
Connecting to	 http://www.lepoint.fr/
Connecting to	 http://www.revhq.com
Connecting to	 http://www.poprocksandcoke.com
Connecting to	 http://www.samuraiblue.com/
Connecting to	 http://www.openbsd.org/cgi-bin/man.cgi
Connecting to	 http://www.sysblog.com
Connecting to	 http://www.voicesofsafety.com
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [20]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_connection</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [21]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_connection</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s">'url'</span><span class="p">,</span> <span class="s">'response'</span><span class="p">,</span> <span class="s">'header'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">
    Out[21]:</div>
<div class="output_html rendered_html output_subarea output_pyout">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="table table-hover table-striped dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th></th>
<th>value</th>
</tr>
<tr>
<th>url</th>
<th>response</th>
<th>header</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="13" valign="top">http://www.altpress.org/</th>
<th rowspan="13" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               24576</td>
</tr>
<tr>
<th>x-powered-by</th>
<td>                                                                               PHP/5.2.4-2ubuntu5.27</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                                  PHPSESSID=1498f60d82d31ec081debde379e605eb; path=/</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                                     Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>         Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.27 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Wed, 06 Aug 2014 11:42:08 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>etag</th>
<td>                                                                  "8ea9fc88e045b56cd96e6fc8b487cbd9"</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                                                              public,must-revalidate</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:44:55 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=utf-8</td>
</tr>
<tr>
<th rowspan="11" valign="top">http://www.nzfortress.co.nz</th>
<th rowspan="11" valign="top">200</th>
<th>x-powered-by</th>
<td>                                                                               PHP/5.3.10-1ubuntu3.6</td>
</tr>
<tr>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>set-cookie</th>
<td> bblastvisit=1407325495; expires=Thu, 06-Aug-2015 11:44:55 GMT; path=/, bblastactivity=0; expires...</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                          Accept-Encoding,User-Agent</td>
</tr>
<tr>
<th>server</th>
<td>                                                                              Apache/2.2.22 (Ubuntu)</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>x-ua-compatible</th>
<td>                                                                                                IE=7</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                             private</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                                                                             private</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:44:55 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                       text/html; charset=ISO-8859-1</td>
</tr>
<tr>
<th rowspan="9" valign="top">http://www.evillasforsale.com</th>
<th rowspan="9" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               14610</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                               bytes</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                          Accept-Encoding,User-Agent</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                            Apache/2</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Thu, 21 Jan 2010 13:33:43 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>etag</th>
<td>                                                                        "2040cf7-3912-47dacc06c1bc0"</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:46:01 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th>http://www.playingenemy.com/</th>
<th>timed out</th>
<th></th>
<td> </td>
</tr>
<tr>
<th rowspan="10" valign="top">http://www.richardsonscharts.com</th>
<th rowspan="10" valign="top">200</th>
<th>x-powered-by</th>
<td>                                                                                            PleskLin</td>
</tr>
<tr>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                                        PHPSESSID=8cg77frbg8biv0ru8m7udb6877; path=/</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:00 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="9" valign="top">http://www.tdbrecords.com</th>
<th rowspan="9" valign="top">200</th>
<th>content-length</th>
<td>                                                                                                2600</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                               bytes</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                                     Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Mon, 03 Oct 2011 00:02:54 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>etag</th>
<td>                                                                                 "a28-4ae59b253c780"</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:46:45 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="8" valign="top">http://www.electrichumanproject.com/</th>
<th rowspan="8" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               14683</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                               bytes</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                                     Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Tue, 05 Aug 2014 18:19:00 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:06 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="11" valign="top">http://tweekerchick.blogspot.com/</th>
<th rowspan="11" valign="top">200</th>
<th>alternate-protocol</th>
<td>                                                                                             80:quic</td>
</tr>
<tr>
<th>x-xss-protection</th>
<td>                                                                                       1; mode=block</td>
</tr>
<tr>
<th>x-content-type-options</th>
<td>                                                                                             nosniff</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:06 GMT</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                                 GSE</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Wed, 06 Aug 2014 05:34:08 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>etag</th>
<td>                                                              "d6b75768-8b38-4991-b414-a06cc4608563"</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                                                                  private, max-age=0</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:06 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=UTF-8</td>
</tr>
<tr>
<th rowspan="8" valign="top">http://www.besound.com/pushead/home.html</th>
<th rowspan="8" valign="top">200</th>
<th>content-length</th>
<td>                                                                                                3870</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                               bytes</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Fri, 09 Jun 2006 04:34:30 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>etag</th>
<td>                                                                                 "f1e-415c31dd2c180"</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:07 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="11" valign="top">http://www.porkchopscreenprinting.com/</th>
<th rowspan="11" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               11811</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                                                                     HttpOnly;Secure</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                               bytes</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:27 GMT</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>last-modified</th>
<td>                                                                       Tue, 28 Aug 2012 17:44:17 GMT</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>etag</th>
<td>                                                                              "b893e5-2e23-503d0371"</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                                                                          max-age=20</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:07 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="11" valign="top">http://www.kinseyvisual.com</th>
<th rowspan="11" valign="top">200</th>
<th>x-powered-by</th>
<td>                                                                                          PHP/5.3.27</td>
</tr>
<tr>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                                  PHPSESSID=b5f9f0af80bf4e08f41eeb02be6e6ad1; path=/</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                          User-Agent,Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                       Apache/2.2.22</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:08 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="11" valign="top">http://www.rathergood.com</th>
<th rowspan="11" valign="top">200</th>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                 c6ef959f4780c6a62e86c7a2d2e5ccea=4ilfnp83k67evmmn281i9qcnu3; path=/</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                                     Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                                                       no-cache, max-age=0, no-cache</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:08 GMT</td>
</tr>
<tr>
<th>p3p</th>
<td>                                                  CP="NOI ADM DEV PSAi COM NAV OUR OTRo STP IND DEM"</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=utf-8</td>
</tr>
<tr>
<th>x-mod-pagespeed</th>
<td>                                                                                       1.6.29.7-3566</td>
</tr>
<tr>
<th rowspan="10" valign="top">http://www.lepoint.fr/</th>
<th rowspan="10" valign="top">200</th>
<th>x-xss-protection</th>
<td>                                                                                       1; mode=block</td>
</tr>
<tr>
<th>x-content-type-options</th>
<td>                                                                                             nosniff</td>
</tr>
<tr>
<th>x-powered-by</th>
<td>                                                                                           PHP/5.5.9</td>
</tr>
<tr>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                          User-Agent,Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>                                                                      Apache/2.2.25 (Unix) PHP/5.5.9</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:09 GMT</td>
</tr>
<tr>
<th>x-frame-options</th>
<td>                                                                                          SAMEORIGIN</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="11" valign="top">http://www.revhq.com</th>
<th rowspan="11" valign="top">200</th>
<th>x-powered-by</th>
<td>                                                                  Atari TT posix / Python / php 5.3x</td>
</tr>
<tr>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                                        PHPSESSID=e1jmcg9c2pgbi9rhgcdkhq5ge4; path=/</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
</tr>
<tr>
<th>vary</th>
<td>                                                                                     Accept-Encoding</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                       Apache/2.2.22</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:19 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th rowspan="7" valign="top">http://www.poprocksandcoke.com</th>
<th rowspan="7" valign="top">200</th>
<th>x-powered-by</th>
<td>                                                                                          PHP/5.3.24</td>
</tr>
<tr>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:10 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=UTF-8</td>
</tr>
<tr>
<th>x-pingback</th>
<td>                                                           http://www.poprocksandcoke.com/xmlrpc.php</td>
</tr>
<tr>
<th rowspan="7" valign="top">http://www.samuraiblue.com/</th>
<th rowspan="7" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               54005</td>
</tr>
<tr>
<th>x-powered-by</th>
<td>                                                                                          PHP/5.4.31</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:12 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=UTF-8</td>
</tr>
<tr>
<th>x-pingback</th>
<td>                                                                   http://samuraiblue.com/xmlrpc.php</td>
</tr>
<tr>
<th rowspan="7" valign="top">http://www.openbsd.org/cgi-bin/man.cgi</th>
<th rowspan="7" valign="top">200</th>
<th>transfer-encoding</th>
<td>                                                                                             chunked</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:13 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=utf-8</td>
</tr>
<tr>
<th rowspan="15" valign="top">http://www.sysblog.com</th>
<th rowspan="15" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               48663</td>
</tr>
<tr>
<th>x-varnish</th>
<td>                                                                                 718735313 718731229</td>
</tr>
<tr>
<th>x-cache</th>
<td>                                                                                                 HIT</td>
</tr>
<tr>
<th>x-powered-by</th>
<td>                                                                                          PHP/5.3.16</td>
</tr>
<tr>
<th>set-cookie</th>
<td>                                                        PHPSESSID=5vk936712pnke6t5ki26n9frf4; path=/</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                               bytes</td>
</tr>
<tr>
<th>expires</th>
<td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                              Apache</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>via</th>
<td>                                                                                         1.1 varnish</td>
</tr>
<tr>
<th>pragma</th>
<td>                                                                                            no-cache</td>
</tr>
<tr>
<th>cache-control</th>
<td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:14 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                            text/html; charset=UTF-8</td>
</tr>
<tr>
<th>age</th>
<td>                                                                                                  40</td>
</tr>
<tr>
<th rowspan="7" valign="top">http://www.voicesofsafety.com</th>
<th rowspan="7" valign="top">200</th>
<th>content-length</th>
<td>                                                                                               20854</td>
</tr>
<tr>
<th>accept-ranges</th>
<td>                                                                                        bytes, bytes</td>
</tr>
<tr>
<th>server</th>
<td>                                                                                            Apache/2</td>
</tr>
<tr>
<th>connection</th>
<td>                                                                                               close</td>
</tr>
<tr>
<th>date</th>
<td>                                                                       Wed, 06 Aug 2014 11:45:15 GMT</td>
</tr>
<tr>
<th>content-type</th>
<td>                                                                                           text/html</td>
</tr>
<tr>
<th>age</th>
<td>                                                                                                   0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="284dfb0a37f7653f1179259f1d629ac9">Save to Excel<a class="anchor-link" href="#Save-to-Excel">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now feel free to do whatever you want with your DataFrames: Export them to CSV, EXCEL, TXT etc.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [25]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">ExcelWriter</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">ExcelWriter</span><span class="p">(</span><span class="s">'Excel/output.xls'</span><span class="p">)</span>
<span class="n">df_whois</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s">"Sheet - WHOIS"</span><span class="p">)</span>
<span class="n">df_dns</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s">"Sheet - DNS"</span><span class="p">)</span>
<span class="c">#df_connection.to_excel(writer, "Sheet - Connections")</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since I wasn't able to export the <code>df_connection</code> to Excel (<code>Exception: Unexpected data type &lt;class 'socket.timeout'&gt;</code>) I had to export it to CSV:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In [26]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">df_connection</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"Excel/connection.csv"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div></p>
                </div>
<hr/>
<div style="float:left;">
	Prev: <a href="http://blog.dornea.nu/2014/08/05/android-dynamic-code-analysis-mastering-droidbox" align='left'>
	 Android Dynamic Code Analysis - Mastering DroidBox
	</a>
</div>
<div style="float:right;">
    Next: <a href="http://blog.dornea.nu/2014/08/06/python-for-data-analysis" align='right'>
	 Python for Data Analysis
	</a>
</div>
</p>

                <!-- Add comments -->
<div id="content-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname="dorneanu";
				var disqus_identifier = 'web-application-survey-tutorial';
			var disqus_url = 'http://blog.dornea.nu/2014/08/06/web-application-survey-tutorial';

		var disqus_config = function () {
			this.language = "en";
		};
 
        
        (function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
            </div>
            <div class="niu2-right-container col-md-2">
                <div id="niu2-sidebar-meta" class="niu2-sidebar">
                    <div class="niu2-sidebar-label"><i class="icon-calendar"></i>Published:</div>
                    <div class="niu2-sidebar-value">2014-08-06 00:00</div>
                    <div class="niu2-sidebar-label"><i class="icon-pencil"></i>category:</div>
                    <div class="niu2-sidebar-value"><a href="http://blog.dornea.nu/category/blog">blog</a></div>
                    <div class="niu2-sidebar-label"><i class="icon-tag"></i>Tag:</div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/ipython/">ipython</a><sup>16</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/appsec/">appsec</a><sup>23</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/web/">web</a><sup>14</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/python/">python</a><sup>24</sup></div>
                </div>

                <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
                    <div class="niu2-sidebar-label">
                        <i id="niu2-sidebar-toc-ctrl" class="icon-open-tocs"></i>Table of contents
                    </div>
                    <ul id="niu2-sidebar-toc-list">
                        <li><a href="#content-heading">Web Application Survey Tutorial</a></li>
                        <li><a href='#994b0dff3ed5e3106513d157298b2b7e'>Setup environment¶</a></li><li><a href='#2dabe6a77ccfda96ebf503860b9427bd'>Whois¶</a></li><li><a href='#f18a085f288a90f503d9a5764e393120'>Get all DNS records¶</a></li><li><a href='#9db3da1dbe0a6f374a239c637eb8d568'>Read WHOIS information¶</a></li><li><a href='#1bff3d5c0a0b50883a1dc1277d2da5a1'>Read DNS information¶</a></li><li><a href='#d913d15f4a6c7f95548e4ec9c64ea2ec'>Connect to targets¶</a></li><li><a href='#284dfb0a37f7653f1179259f1d629ac9'>Save to Excel¶</a></li>
                        <li><a href="#content-comments">Comments</a></li>
                    </ul>
                </div>
            </div>
            <div id="niu2-toolbar">
                <ul class="list-unstyled">
                    <li><a id="niu2-toolbar-ctrlsidebar" href="#" title="Hide Sidebar"><i class="icon-3x icon-hide-sidebar"></i></a></li>
                </ul>
                <div id="niu2-toolbar-showsidebar" data-title="Show Sidebar"></div>
                <div id="niu2-toolbar-github" data-repo=""></div>
                <div id="niu2-toolbar-bitbucket" data-repo=""></div>
            </div>
            <div id="niu2-toc" data-style="fixed"></div>
        </div>

        <div class="niu2-footer">
            <div id="body-footer" class="col-md-6 col-md-offset-2">
                <hr/>
                <p>
                    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
                    <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="https://github.com/twbs/bootstrap">Bootstrap3</a>
                    by <a href="https://blog.mawenbao.com">Ma Wenbao</a>, icons by 
                    <a href="https://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
                </p>
                <p>
                    © 2008 - 2016
                    <a class="niu2-footer-link" href="http://blog.dornea.nu">Victor Dorneanu</a>
                </p>
                <p class="niu2-icons">
                    <a class="niu2-footer-icon" href="https://pgp.mit.edu/pks/lookup?op=get&search=0x18F1AD46FB05E1B7" title="my public key">
                        <i class="icon-key icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="mailto: no-spam ÄATT dornea DOT nu" title="my email address">
                        <i class="icon-envelope-o icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="http://github.com/dorneanu" title="my github page">
                        <i class="icon-github-alt icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="/feeds/rss.xml" title="subscribe my blog">
                        <i class="icon-rss icon-lg"></i>
                    </a>
                </p>
            </div>
        </div>

        <script type="text/javascript">
            var _gaq=_gaq||[];
            _gaq.push(["_setAccount","UA-7161767-3"]);
            _gaq.push(["_trackPageview"]);
            (function(){
                var b=document.createElement("script");
                b.type="text/javascript";
                b.async=true;
                b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";
                var a=document.getElementsByTagName("script")[0];
                a.parentNode.insertBefore(b,a)
            })();
        </script>
        <div id="niu2-pygments" data-theme="github"></div>
        <div id="niu2-lazy-load" data-loading-txt="Loading image" data-loading-icon="icon-spin icon-spinner"></div>
        <div id="niu2-toolbar-load" data-loading-icon="icon-spin icon-4x icon-spinner"></div>
        <script type="text/javascript" src="/js/custom.js"></script>
        <script type="text/javascript">
            onContentLoaded();
        </script>
    </body>
</html>