<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="python, coding, ipython, ssl, x.509, tls, crypto, openssl, appsec">
        <meta name="description" content="In times of NSA, surveillance and data privacy, protecting your data has become an essential part of your every day life. A good understanding of basic principles is half the battle. In this post I just wanted to have look at SSL/TLS from a developer point of view but ...">
        <title>Validating and pinning X.509 certificates - blog.dornea.nu</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
        <link rel="stylesheet" href="/css/ipython.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/font-icons/style.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/niu2.min.css" type="text/css" />
        <link rel="stylesheet" href="/css/custom.css" type="text/css" />
		
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/niu2.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>
        
        <link rel="canonical" href="http://blog.dornea.nu/2015/05/24/validating-and-pinning-x509-certificates" />
        <script type="text/javascript">window.onload=function(){};</script>
        <!--[if lt IE 9]>
            <script src="http://blog.dornea.nu/theme/js/html5shiv.js"></script>
            <script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>
        <![endif]-->
    </head>
    <body> 
        <div id="body-header">
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="col-md-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://blog.dornea.nu">
                            <i class="icon-home"></i>blog.dornea.nu
                        </a>
                    </div>
                    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="http://dornea.nu" title="about">
                                <i class="icon-user"></i>about</a>
                            </li>
                            <li><a href="/archives.html" title="archives">
                                <i class="icon-archive"></i>archives</a>
                            </li>
                            <li><a href="/tags.html" title="tags">
                                <i class="icon-tag"></i>tags</a>
                            </li>
                            <li><a href="/feeds/rss.xml" title="feeds">
                                <i class="icon-rss"></i>feeds</a>
                            </li>
                        <!-- category dropdown list -->
                        <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="icon-folder-open"></i>category<b class="caret"></b>
                           </a>
                           <ul class="dropdown-menu">
                               <li><a href="http://blog.dornea.nu/category/blog">
                                      <i class="icon-pencil"></i>blog
                                      (117)</a></li>
                               <li><a href="http://blog.dornea.nu/category/low">
                                   <i class="icon-folder-close"></i>LOW
                                      (27)</a></li>
                               <li><a href="http://blog.dornea.nu/category/notes">
                                      <i class="icon-book"></i>notes
                                      (21)</a></li>
                           </ul>
                        </li>
                        <!--  self defined dropdown list -->
                        </ul>
                        
                        <!-- right nav bar -->
                        <ul class="nav navbar-nav navbar-right">
                        <!-- google custom search -->
                        <li>
                        <div id="niu2-cse-wrapper">
                            <div id="niu2-cse-header-box" class="navbar-form navbar-nav">
                                <form action="http://google.com/cse">
                                    <input type="hidden" name="cx" value="008508447409818574933:pxyxuhrgnxi" />
                                    <input type="hidden" name="ie" value="UTF-8" />
                                    <div class="form-group">
                                        <input id="niu2-cse-search-input" class="niu2-cse-header form-control" 
                                            type="text" name="q" 
                                            placeholder="Press enter to search ..."/>
                                    </div>
                                </form>
                           </div>
                           <div id="niu2-cse-ctrl-box" class="navbar-nav">
                            <i id="niu2-cse-search-image" class="icon-search navbar-nav"></i><span id="niu2-cse-search-text">Search</span>
                           </div>
                       </div>
                       </li>
                       </ul>
                    </nav>
                </div>
            </div>
<style>
    #banner{
        background-image:url("http://blog.dornea.nu//images/header.jpg");
    }   
</style>

<div id="banner">
    <div class="container">
        <div class="copy">
            <h2>blog.dornea.nu</h2>
                <p class="intro">Hack, code and drink some țuică. Personal blog of Victor Dorneanu.</p>
        </div>
    </div>
</div>
            <!-- End Banner -->
        </div>

        <div id="body-content">
            <div class="col-md-8 col-md-offset-2">
                <h1 id="content-heading">Validating and pinning X.509 certificates</h1>
            </div>
            <div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
                <div id="niu2-main-content">
                    <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In times of NSA, surveillance and data privacy, protecting your data has become an essential part of your every day life. A good understanding of basic principles is half the battle. In this post I just wanted to have look at SSL/TLS from a developer point of view but also from an users one. On the one hand I wanted to use <code>openssl</code> as a CLI utility to <em>inspect</em> and <em>validate</em> <a href="http://en.wikipedia.org/wiki/X.509">X.509 certificates</a>. On the other hand I wanted to have code I could use in my own projects. I've found <a href="https://github.com/pyca/pyopenssl">pyOpenSSL</a> to be a quite useful library to use on a regular daily basis. Regardless the programming language you'll find pretty generic ways of <em>validating</em> the certificates and <em>pinning</em> the presented data. For the sake of simplicity I've chosen to analyze <a href="https://www.google.com">Googles</a> SSL certificate. But first let's start with <strong>certificate pinning</strong>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="collapseheader inner_cell"><span style="font-weight: bold;">Expand Code</span>
<div class="input_area" style="display:none">
<div class="highlight-ipynb"><pre class="ipynb"><span></span><span class="c1"># Init ipython notebook stuff</span>
<span class="c1"># Import crypto modules</span>
<span class="kn">import</span> <span class="nn">ssl</span>
<span class="kn">import</span> <span class="nn">OpenSSL</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">Crypto.Util</span> <span class="kn">import</span> <span class="n">asn1</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="c1"># Import ipython specific modules</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.height'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_rows'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_columns'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.width'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="o">%</span><span class="k">install_ext</span> https://raw.githubusercontent.com/dorneanu/ipython/master/extensions/diagmagic.py
<span class="o">%</span><span class="k">load_ext</span> diagmagic

<span class="o">%</span><span class="k">install_ext</span> https://raw.github.com/cjdrake/ipython-magic/master/gvmagic.py
<span class="o">%</span><span class="k">load_ext</span> gvmagic
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">height has been deprecated.

Installed diagmagic.py. To use it, type:
  %load_ext diagmagic
Installed gvmagic.py. To use it, type:
  %load_ext gvmagic
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="aecf981176c1700646d09f448cb429e3">What is it?<a class="anchor-link" href="#What-is-it?">¶</a></h2><p>Having to implement <em>certificate pinning</em> most developers have a poor knowledge about it and the impact it <em>could</em> have on an end-user if not done properly. I think MITM attacks are nowadays widely understood (generally speaking) and developers seem to accept the importance of security measurements against this specific type of attacks. Certificate pinning referrs to the <strong>authenticity</strong> of data and the process of comparing some <em>presented</em> to <em>expected</em> data. Take a look at the <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">OWASP site</a> for a more detailed introduction. But first let's have a look how client communicates to a server using a secure (SSL/TLS) channel:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">seqdiag</span> 
// &lt;!-- collapse=True --&gt;
{
  Client -&gt; Server [label="Connect to port 443 ... "];
  Server -&gt; Client [label="Send X.509 certificate"];

  // Separator
  === Secure Connection ===

  Client -&gt; Server [label="GET /index.html"];
  Server -&gt; Client [label="200 OK Success"];
}
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img class="img-responsive" src="data:image/png;base64,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
mzyLcOWgP0UlqWTYBaru1BACcDuFr7RrI9w8fRe5G+Elqd8zANWdGsIvkDTTdY9BGoSSVBIMQHVn
ACEAq7HLXFIZMQDVnbQFWEnPfv9Skvo1A1DdSc8Bghe5SCojBqC6k14F2oY/NyWpjBiA6k56H+B2
QmtQksqCFzWoO+kvwWRvhJekkmcAqjuV5K4AtbxIKhtWaOpOsX+NJEklzQpN3UkDsArLi6QyYoWm
7lSQ+6/wklQ2DEDtiAoMQkllxgCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQk
RckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJ
AJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCU
JEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRF
qbqvN0BK1CWDyl9DMkh9ygBUf1E3ZcqUS1//+tf39XZoN3rsscdYuHAhGIDqBwxA9Ruvf/3r+djH
PtbXm6HdLAlAqc95DlCSFCUDUJIUJQNQkhQlA1CSFKVSuAimvq83oIzUNSxopP66WwBoWNAI0P46
XzL9YOBUoBloAo7ZXdvWk5m3b9/Oyy+/THV1NaNGjdpNm7Tr2traWLlyJTU1Nf16O1Pz589n6tSp
DBgwYHeupo6+2a87lP98e7i8x6K+rzegK6UQgFIH9957L9deey3jx49n8+bNrF27lp/97GcMHTq0
rzetg4aGBq655hoGDhzIoEGDWLduHXPnzuWUU07p600DYOnSpdx555187nOfax83b948jj766N0d
gFK/UAoBWN/XG1BG6uumTp5e/5mzwovkSDh93Wnm625h/oLGpcDdwEZgPfDL3bVtwPTuZmptbeWy
yy7jhz/8Ia997WsBWL16NQMHDuww36pVqxgxYkSn8a2tre3TBg8evMMbl65j+PDhALz88ssMGTKE
IUOGFJx/yZIlXHzxxdxwww1MmTIFgDVr1vD444932JaXXnqJUaNGUV3deVdcv349lZWVDBs2rOC0
qqqqTqHf0tLC6tWrGT16NJWVHc9wNDU18corrzB69Giqq6vZsGEDTz31VId5br755h1eHsDatWsZ
NGhQj/6WhHsA63vyhl7Sofx3mrhny7v6gVIIQKndtm3b2Lp1a4fA2HfffdufP/HEE9TX17Pffvvx
3HPPcdZZZ/He974XgF/84hfceOON1NbW8tJLL3HRRRdx0EEHceaZZ3L/Csv6igAAF3BJREFU/fcD
0NzczIknnsgjjzxCU1MTJ554IrNmzeK5557j1FNP5ZhjjuGiiy5ixIgRrFq1ipkzZ/KJT3yi03b+
9Kc/5R3veEd7+AHss88+zJo1C4A//elPXHLJJYwfP55//OMffOITn+C0005j8+bNzJgxg9NPP52l
S5eybNkyPvWpT3H66aezfv16Zs+ezdve9jaWLVvGsmXL+PSnP82pp54KwJ133sm8efOYMGECy5cv
p76+nilTptDa2srVV1/NQw89xIQJE3juuee47bbbuP7663n22Wf56Ec/ysSJE/nCF77AjBkz+PGP
f8w+++zD73//e66++momTpzI8uXLufjiizn++ONZtmwZc+fO5eijj2blypUsW7aMyy+/nOOPP773
v3BpNyqFAKzv6w0oIyV/DnDgwIF85CMfYc6cObzuda/jDW94A7Nnz2bs2LG0tLRw8cUXc+2113Lo
oYeyZcsW5syZQ11dHU1NTdxwww3cfvvt7efitm3bxqZNm7pcX1NTE3V1dZx88skAnH322Xzyk5/k
+OOPp6Wlhfe///2cdNJJTJo0qcP7li1bxpw5cwous62tjUsvvZQvfelLTJ06lRdeeIH3vve9TJs2
jcGDB7N582bq6uq48MILeeaZZ/j0pz/N6aefDsCGDRuYNWsWU6ZMYcmSJXzhC1/g1FNPZfny5cyb
N49bb72VYcOGsXTpUj73uc9x5513cvfdd/PMM89wxx13MGDAAFpaWqioqGDu3Ll84xvf4Dvf+U6n
bdy0aROXX3458+bN46CDDmLx4sWcf/753HPPPQC88MILXH/99dTW1vKHP/yBH/zgBz0JwDo8BxiL
+r7egK6UQgBKHZx33nm8853v5NFHH+WPf/wjc+bM4Uc/+hFVVVWsWbOG3/zmN/zmN78BoKqqiqef
fpo1a9Zw3HHHdbgQpaamptt1VVZWMn166JndvHkzixcv5vHHH+/wayZPPvlkpwDsyiuvvMKrr77K
1KlTARg7diyHHHIITz31FMcccwwDBw7kuOOOA+Dggw9m5cqV7e8dMmRIe6vykEMOaZ+2cOFCampq
mDdvXvu8L774Ihs3buSxxx5j9uzZ7ef1qqqqut3GZcuWMXr0aA466CAAjjzySAYNGsSKFSuorKxk
7Nix1NbWtm/HqlWrdvjzS/1FKQRgfV9vQBkp+XOAqf3224/TTjuN0047jc9+9rPcd999zJo1i8GD
BzNz5sz2+WbOnMm4ceP4/e9/X3A5FRUVtLa2tr/etm1bh+k1NTXt3a1tbW1UV1czY8aM9vNhM2fO
ZL/99uu03NraWpYsWcLs2bMLrretra3oZ6uurqaiogIIAZydNxva2Wmtra2MGzeu02cfNGhQt+sr
JF1/sfHZi2Ty/4Y7oAHPAaof8D5AlZTm5mb+8pe/tL/etm0bK1euZNSoUYwfP56BAweyceNGJk2a
xKRJk5gwYUJ7q+nRRx9l9erVHd47fPhwtm3bxksvvQSE2wCKGTp0KIceeijLly9vX/5BBx1U8EKY
d73rXdx5550dLnp55ZVXuPfeexk5ciQjRoxgwYIFQOhOXLp0aY9akfmOPfZYnn76aUaPHt2+bWPH
jqW6upo3vOEN3HPPPTQ3NwPhFpLW1laGDh3K+vXrCy6vtraW1atX8+yzzwKwePFitm7dyvjx43d6
G6X+phRagFK7lpYWrrzyStavX8+YMWP45z//yZQpUzjttNOorq7mmmuu4ZJLLmHEiBFAuEpx3rx5
HHDAAcydO5ezzz6bCRMmsGbNGi688EKmTJnCRz/6Uc466ywOOOAAjjzyyC7X/5WvfIUvfvGL3H77
7QwaNIjVq1dz3XXXceCBB3aYb9KkSVx11VVcdtllVFVVMXjwYNavX8/5559PRUUFV1xxBZdccgn7
778/K1as4IILLmCfffZh8+bNO/V3mThxIp/61Kc455xzGD9+PJs2bWLvvffmG9/4Bm9729t48skn
OfPMMxk/fjwvvvgit956KwcffDBjx47ljDPO4IgjjuArX/lK+/KGDBnCpZdeyr//+78zfvx4nnvu
OS6//HJvj1BZKdzPoXJVf+ln3ndpT7pAL7vuf+8F7mQPdIF+7GMfu3RH/xtEev/fqFGjOt3qAOGW
g9bWVkaOHNmhOy+9DWKfffbp8L4NGzZQWVm5w/cSrlu3jm3btjFy5MiCtwdkvfTSS1RVVTFy5MgO
49va2li9ejX77LNPwdsgdkZ6a8WQIUPab9lINTU1tf/NdnR9ra2tvPzyy4waNarbz7kjbrzxRm68
8cbL6KMu0Gz57zRxz5Z39QO2AFWSuroHD8ItB4VUVlay//77dxq/11579Wj9aQtzR4wePbrg+IqK
iqLTdlZlZSVjxowpOG3gwIFFp3W1vN7eRqm/8BygJClKtgDVbzz22GN9vQnazfyO1Z8YgOovGhYu
XOh/C49DQ19vgAQGoPqPBqwYJe1BngOUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJ
AJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCU
JEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRF
yQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckA
lCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQkRckAlCRFyQCUJEXJAJQk
RckAVG8bAdQCQ/bAul4HHLQT7zuGsI29oRI4s5eWle+duI9Ku407l3rLaOBO4K/AzcAS4GHgyGT6
Z4ANwLOZ4WrgiszrLcCqzOvDi6zrLuD1wDuAN+zEtn4EmLET7yukCrili2m/3oVl/wio2YX3S+pC
dV9vgMpCBfAL4M/AAUBzMv4EYO/MfHcCHyjw/kuSxweAG4Hbu1jXUEIwPg48VmB6FTAGeBFozYyv
BMYn4wsZBWwH1nWx7u6MSB7TZVQAby4y70BgJPBC8npkMv/Lu7B+ST1gAKo3TAFeS6jsmzPjH9wN
6zoF+C3QBnwDWEwIzevJdb8OIgTh8cBm4BDgbmAFMIzQ0lyULG9/4Lbk+XDgL8C/EkL218A04Dng
GkJIfqjANlUA1wH/J3nfZck2XUXYx+5L5ntLsh2vABMJQX1vsl2zk3FfT9YlaTezC1S94XDgKUKw
QAiSKckwPjPfDEIYpMO7d2JdpwO/LDJtf6CO0D36AvD2ZPzVhICcCbwVOCLznv8ktDinE84NjgDO
AJ4E6oFbk+W8Ffj3IusdANxPOAA4iVyL9iJCq3JmMrQk418lhPPRwFmEAD0ReCPwxS4+u6ReZAtQ
vaEt7/VrgSsJF6j8Ejg/Gb+IXDgAPN/D9VQTulX/rcj035ALmUZy4TsNOC95vo4QVqmTk3FXJa/3
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
JEmSJPXQ/we545MPH1w7RAAAAABJRU5ErkJggg==
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before establishing the secure connection the client must <strong>validate</strong> the <em>presented</em> certificate.</p>
<blockquote><p>Regarding the validation: Here I won't go into much details because this is a quite complicated story from a technical point of view.</p>
</blockquote>
<p>After the successfull validation the <strong>authenticity</strong> of the server is guaranteed - at least that's what the client is assuming. Now let's have a look what happens during a <strong>MITM attack</strong>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">seqdiag</span> 
// &lt;!-- collapse=True --&gt;
{
  Client -&gt; Eve [label="Connect to port 443 ... "];
  Eve -&gt; Server [label="Connect to port 443 ..."];

  Server -&gt; Eve [label="Send Servers certificate"];
  Eve -&gt; Client [label="Send Eves certificate", color=red];

  // Separator
  === "Secure" Connection ===

  Client -&gt; Eve [label="GET /index.html"];
  Eve -&gt; Server [label="GET /index.html"];
  
  Server -&gt; Eve [label="200 OK Success"];
  Eve -&gt; Client [label="200 OK Success"];
}
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img class="img-responsive" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAALoCAYAAADoakQUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAACAASURB
VHic7N17nFR14f/x1+wF5CKSXEQIuWgpKph3MS/rDVHTUr9YaUqWpVh+Lfulpqnr5ZumZmV91bLM
e5laml00MkENTEWTVdG+3iBFboKCglx25/fH55zds8PMLgsLy87n9Xw85jEz58yc85mZz5x9z+dy
FiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRtQLmOLsBGwvdBWfmOLsAGZv1XlvVfMYum/sdc8Vt67TG/LzFq6Qtf
rgcD679S1v81X6fyE2P9B+Ks6MVecy5zXeo9ifG9KkelvtD5zLpijymXA4H1P27W/9LLrP/lL/b6
30xslbrw9eZo/qUvdVvlqfBLX3i78Evf2Q8C1n9lWf+t/zGLrf6vJqYKXuzLfwCwP82/9MWuW9uW
Nm4t/ep7DJhM8y99Q7K+ochzO+tBwPofL+u/9T9m1v8Sqjq6AB2kgvAl3n///fe/oKampoOLo44w
adIkJk+e/H1gCk1f/HpC3Wgg1JPsAaFcWP9l/bf+Ry3i+t8olgCYK7idIzkI1NTUUFtb2yGFUseq
ra1l8uTJlUBXwhe/nlAv6pOHpF/+HE2//LK3Owvrv1Zj/bf+xyyi+l9SLAEw1fjFz9xW3KqBTYBV
mUsq/TVYQfHugM7G+q9C1n/FLKb6v5oYA2B6XUnzX4aKUzXQHViZXFbQvF6k40LK4Zef9V+FrP+K
WUz1fzUxBcDsr74KwgGgskNLpI1BF6AH4Yu/vMj67IDgznwQsP6rGOu/YhZL/S8qhgBYbPZXJU1d
AYpbV8IBoLBFIB0QXMnqX/rOdCCw/qsl1n/FrNzrf4tiCICp7Dmf0l+AjgFR+gswrQvpF39Vcp3+
8ksvnfWLb/1XMdZ/xSyW+l9UjAEw2wXgAUBdgJ40Tf1PBwKvpOkgkA4C7swtBtZ/FWP9V8xiqf9F
xRQAU+mBwAOAIBwAutH0q28F4cufjhFK60u5sP4ry/qvmMVW/5uJ5QuQnf2VPRVALK9fpVURTgPQ
lTAjrJrwxa9i9dNGQOc8GFj/VYr1XzGLof6XFNsXIPtBOghYEL7oXQm/BKuT+1U0dRVB+fwKtP6r
kPVfMYup/q8mtgCYyn64ilslzb/42RmC5VpPyvV1qe2s/4pZjPW/UVm/uALFEnxZpnq1SQWlv/yF
OnN9sf6rGOu/YhZL/S8qpgBYqOw+TK2V7C+9sh7vUaCcX5vWnPVfMYu1/gNxBsCoPmC1KjvQF4of
BMqpnlj/lWX9V8xiq//NxBgAU2X7oWqtFPvSl3MdKefXpraz/itmsdV/IO4AKEHzL3vZf+GlAtZ/
xSzq+m8ALCNLlizhtddeY9myZY3LFi1axMMPP9y4/qGHHuqo4kmS2tGyZct47bXXePfddzu6KOqE
DIBl4IMPPuDkk09m+PDhnHjiiWy33XYcccQRLFq0iFdffZXzzz8fgPnz53PNNdes074mTpzIVVdd
1R7FltabpUuXksvlGDZsGFtvvXXjZfny5R1dNKldnH/++WyzzTaccsop7LHHHhx66KEdXSR1MjH+
K7iyc8opp7B06VJef/11evbsCcDvf/97li5d2uxxw4cPX60FcOXKlcyZM4dBgwZRUbH674HZs2fT
r18/qqurAXj77bd58cUX19MrkdpXXV1d43eiLebPn0+XLl3YbLPN1kOppHXz7LPPctNNN/Hyyy/T
q1cvAGbNmtXsMatWreLtt99myy23pKqq+Z/6hoYGZs6cycCBA+natWuL+/rwww9ZsGABH/3oR1db
t3z5ct566y2GDRtGLhddD2qnZwtgJzd//nzuvvturr/++mZ/6I4++mgGDRrU7LEvv/wyO+ywQ+P9
n/zkJ2y//fZ89atfZcSIETz11FMA3HLLLYwdO5YxY8Zw/PHHM3z4cP7v//6PhQsXcuWVV/LQQw9x
yCGHcNlll22YFym1oxNPPJHrr7++8f4///lPdtxxRyD8ER09ejSf/exn2XfffTn99NM7qphSSe++
+y7V1dXNQtdWW23VePvWW29lxIgRnHrqqWy33XY88sgjAPzxj39kr732Yv/99+eLX/wiN9xwA7vt
tluzbe+0005MnToVgPPOO4+dd96ZL3/5y4waNYpXXnkFgEsvvZQjjjiCvffem5NOOsmW9U7KFsBO
7qWXXmLAgAEMHDiwTc979tlnueGGG3juuefo3r07U6dO5fTTT28MgS+++CLPP/88vXr14sILL+Tn
P/85V111FWeffTaPPPIIv/rVr9bHy5Ha1VFHHUVlZSUAAwcO5JZbbuGLX/wi559/PhMmTABoXAZw
xhlncNpppzF+/HgaGhoYO3YsDz74IGPHju2olyCtZt9992XkyJEMGDCAMWPGcPDBB3PiiSfSq1cv
Xn31VS6++GKmTZtG7969mTFjBkceeWRjeHvxxReZMWMGgwYNIp/P85Of/IS6ujpGjhzJs88+y/Ll
yxk9ejQPPPAAU6ZMoa6ujqqqKu666y7OOecc7r33XgBmzpzJU089Rbdu3TryrdA6MACWgXw+3+bn
PPLII3Tt2pVLLrmkcVldXR2rVq0CwgEm7VoYNWoU99xzT/sUVtqALr74Yrp37w7Q2NV1wAEHMGfO
HF566SWGDRvGPffcw/Tp08nn8zz88MMMHTqUGTNmAKH768knnzQAaqNSVVXFn/70J+rq6pg8eTK/
+c1vuPbaa3n22Wd57LHH6NKlC1dccUXj4+fMmcM777wDwB577NHYO5TL5TjppJO45ZZbuPrqq7nl
llsYP348QOPkwe9+97tAGGueNhAAjB071vDXyRkAO7ntttuOuXPn8tZbb63W5duS+vp6PvaxjzFu
3LjGZePGjWscB5gdF1JRUUFDQ0P7FVraQHbeeefVxgBWVFRw4okncsstt7DLLruwxx57MGDAABoa
Gsjn8xx99NFsuummQPhODBgwoCOKLrVq5MiRjBw5kgkTJjBkyBCmTJlCQ0MDQ4YMWe3YntbpHj16
NNvGSSedxCc/+UkuvfRS7rrrrsaQV19fz0477dRsO6ecckrj7cLtqPMxAHZy/fr147jjjmPChAnc
eeedjX/s7r33Xvbaa6+SzzvooIO47rrrGDp0KH369AHgnXfeKToRJKtXr14sWrSo/V6A1AHGjx/P
gQceyHPPPcfJJ58MhGB44IEH8uyzz/LNb34TCJOksqdVkjYGs2bNYsWKFWyzzTYAzJs3jyVLljBg
wACGDh3KBRdcwIABAxobBd555x26dOlSdFtDhw5lu+2248wzz2TUqFGNkz0OOeQQLrnkEi6//PLG
VvS0FVHlwUkgZeDGG2+kf//+DB8+nL322ovBgwdz6623tvgLbZddduHcc89lt91249BDD2WPPfZY
owHvBx54IPPmzWPUqFF85zvfac+XIbW7wYMHs/nmmzdeZs6cCcA222zD0KFD+ec//8lRRx3V+Pjr
r7+e+++/n912240xY8YwatQonn/++Y4qvlTU/PnzGTt2LCNGjGC//fZj55135tvf/jY77rgj22yz
DVdddRX77rsvY8aMYa+99uL4449vcXvjx4/nxhtvbOz+hTB+9qijjmKHHXbgsMMOY5dddnHinzqd
9H/9VQObAL2AfsAQ4H8vuuiifLlYunRp/tVXX80vW7ZsjZ+zatWq/MyZM/PvvvvueizZxumiiy7K
A48D5wFfA44HxgKjgR2SOtIvqTObJHUo+38jO4No6n97WrRoUf4///lPfuXKlR1dlPXG+t/56//8
+fPzM2fOzK9YsWK1dfX19flZs2blFy5cuE77WLFiRf7111/Pv//+++u0nY1NJPW/RXYBl5Fu3box
fPjwNj2nsrKy2ekDJEHv3r3p3bt3RxdDalHfvn1LrquoqGDw4MHrvI/q6mqGDh26ztvRxscuYEmS
pMgYACVJkiJjAJQkSYqMAVCSJCkyBkBJkqTIGAAlSZIiYwCUJEmKjAFQkiQpMgZAxS5fcJFiYv1X
zKKu/zEHwOg+bLUoewCI4YBQzq9NbWf9V8xiq/9AnAGw8INW3PJAA011Ib1deDAoF9Z/ZVn/FbPY
6n8zMf8v4DzApEmTqK2t7eCiqCNMmjQJmg4A6SWWPxDW/8hZ/63/MYu8/gOQ6+gCbAC55FJBCLzV
QFegG1AD7Jvc3yS5dE0u1cmlMnluekm3WQ76J9fzOrQU61/21116qQdWAv8G6oD3ksu7wOLkshRY
BixPHruK1Q8SGzvrf2nWf+u/9d/6X871v0WxtgCmleCfwIvApsBmyaUX0BPoQThIdKH5gSA9oJSD
nZPrZzu0FOtf+oXNfvFXEL7cH9D05V6VrG+g+S/DcmP9D6z/1n/rv/U/tvrfKLYAmE3u6YebfvBp
pVhO0xeezGOyB4BysTK5XtqhpdgwsgeAVYTP+cPkejnhs88eCLJf/nL5xWf9b876b/23/lv/Y6n/
q4klABYO6EwTfpr4VyaXYl/+lYT3qRwPACuS6/c7tBQbRuEBYCXhALCMpgNBWg/Sx2TrSmceF2L9
L876b/23/lv/y73+lxRLAMxKP8x6mjcHf0jTF53MuupkeToGpJwOAMuT68UdWooNI9uknx4A0l+B
6UHgQ5p+Cab1o9x+/Vn/m1j/rf/Wf+t/TPW/mZgCYPbXX+EvgfQAUEHTwSGtIFU0HQBylNcYkA+T
6/c6tBTrX/a8Ttlun7TLZxlNB4FsV0A6HqQcBv5a/1dn/bf+W/+t/zHU/6JiDIDFmoLT5n1oqiBp
d0D6qzBH+R4AFnVoKda/fMGl8OCf/hIsdQDIPrezsv6vzvpv/bf+W/9jqP9FxRAA8zT/wqYVoCK5
XlFk3Qqaf/nLsfkfwq8egIUdWooNp1QLQOGBYAVNX/60G6BwO52F9b8067/13/pv/S/n+t+icqvQ
paSvM/0Sp+eEqqTpfE9dMrerMusLf/1lt6fOoXAQeHYMUHYWYHogKBwMnD0tQHZ7nYX1P27W/8D6
H6fY639JMbQAZqW/BtMKkF2eHRyafvFLnQDUA0DnUjiDq/CEoNkDQfZ8UPVFntuZWf/jZP0PrP9x
sv6XEGMAbKD5YN9Utlk4+8Uv9svPA0DnUvglLhwQnj0QZG9nH1cOBwDrf5ys/4H1P07W/xJiqsjZ
15r9Yqe3s+d5yv7qqyixDXU+2S9xQ+Y628RfT/Mvfbbpv3AbnYn1X9b/wPofp5jrf1ExVejC15p+
0WH1Kf7ZJv9i71G5vG/fSa4v79BSrH/FvrTZWV2FM70aCpa3tq3OwPq/Out/YP23/pcz638JMXUB
F5sN1pAsSz/w9AtfT+kvfzlJu0BWtPio8pU9CBS7XU5ffuv/6qz/1n/rv/W/1O1yqv9FxRQAofhB
ILuspS99OR4M0gNffYuPKi+lvsSFB4A1fV5nYv1vzvrffLn13/pf7mKu/6uJLQBC0wdZeCAota6c
pa83pgNAMS19ucvti2/9b2L9D6z/pdeVM+t/EFP9bybGAJjKfrCFX/iy/tAzWvrFE7MY3g/rv/W/
lBjeD+u/9b+UaN6PmANgVjQfeAmxv/7Yxf75x/76Yxf75x/7649WResPkSRJUjkxAEqSJEmSJEmS
JEmSJEmSJEmSJEkbudrkIsWoFuu/4lWL9T9qzgKWJEmKjAFQkiQpMgZASZKkyBgAJUmSImMAlCRJ
iowBUJIkKTIGQEmSJEmSJEmSJEmSJEmSJEmSJGkjV4v/C1LxqsX6r3jVYv2PmrOAJUmSImMAlCRJ
iowBUJIkKTIGQEmSpMgYACVJkiJjAJQkSYqMAVCSJElSuxgEfBR/ZGxsegHDgR4dXRBJklQ+9gLq
gFeAJ4A3gW90aIma2xz4dQvrdwO+t4HKUsoXgJPW4HE7AcuBK4usG5Wsuyqz7PuEz2UqMBe4fN2K
KUmSFFr8FgGfyyzrCXyx4HGDgG4lttET6FNi3aYl1lUAg4EuRdZVA0OBrsn9LQmhtJRDgT8XWd4l
2ceatGhuDvRtoZzVJZ43EOgNXEjrZ+ivAh4D7mb1AFgFPJqsywbA7pnbfYD3gG1b2Y8kSVKLzgUe
aGH9dsCLwMPA68D5mXVzgGuAR4BZwMWZde8AP0jW/Qe4ILPuMODfwF+AV4HjMuvOAd4gBLoXCGHn
FuBDYCLwu4Ly5YBngAXJ+quT5V9OyjQx2cfoEq9vEqF18VHgeeB2mgLjvsBrwF+TbaUtfD2BJclj
HyMEtleS/UwETimxr+8A3wauYPUAeG6y7nKaB8CsXsB8YKsS6yVJUpmqpX3/F+QtrWzvr8CE5PZm
hJa4XZL7c4CvJrf7AItpatF7B/hScrsfITBVEVrLZgFDknX9CQGxByFwvZLsB0K4q6btLYCDkv1/
NLl/JDCjxHMnAb9MblcBjwP/lez7FWBMsm4osBDYghAA88l2U621AI4A/pHsozAAbpdZVywAHgf8
HXiLEGxjVov/C1XxqsX6H7Wqji6AopED9qape/g94KFk2TPJsj8l1+8QWuEGEAJedt184F1C2NsO
qKQpVJLc3xY4ALg32Q+EkLVyLcq9K/A0TaHxAUIrX9+kjIXSVsVVwP2E1/cPQrfwX5N1bwDTCeH3
MWBF5vW1phL4GXBGso+sihbWpf5KaJ3cl9DK+iAhDEqSImIAVHuaAezTymNyLaxbkbldT/PxdsXW
VRAC4d2ZdXcTuoRb29eGlKflsnwINKzhtj5GCKU/T+4PSrZdAdxImMRSbN23kmXvJpcXgU8BY2lq
texsPgssI4TyfAeXRZI6FU/REa9cwe1Sl7a4jdDidXxm2abAyYQ/0P8AxiXLNyN0tz7e1oJnTCO0
BK5Ibk8jjC38gDDO8BhW7wJenJSp1I+fxcBHMvefJgSuQcn9IwmtksVa/wCOTa6rgM8QXvPc5PHZ
LuCRSXlLlaF3iXWvJs89LrncD/yB0NX7WsG6+wjhKO0GHpjZTl/CLOJXSuxnHE2nitkB2KPEuo40
Avg98DJwFG2rr+uj/ktSp2ELoEr9oVubFpW3CC1KPwMuI4SeLWkao/bfwD2ElpuhwP8C/1qL/aQW
AeMJXb2zgE0IgW8UIXj9DHgOeIkw+/ZoQuvg7YQWsDeBAwu2OY0QwJ5PtnEqYULFFEJY2go4sYUy
dQMmEwLWM4SAkifMhL4FmEloxTsTmEcYA1jovuR5/yK0zv0ks24lIeil3iX8kJub3C9cV0UYXwlw
K+F9WEwYN3l9UtZCOeC3hPMFvk4IfMOAJ5P1vwW2LthXR6kgvJ93EFqDzyHUsTWtv+1Z/yVJ2uhV
Apckl6oSl8p12P4WNHVBFhpICGvtaSBhgkihakLY6VpkXVtUU/r1pCYRxtZtQvHT1eSSbZQ6DcyG
0IcQYjuyDO2llhDUspclhGA6jpY/q/Vd/6WNXS1OAomaXRxxqUkuEFpO9k9uP5p5zKM0tQrlaX6q
FrXsi4QZtrNaeZzaRw1NdbjQCuB9wvCDdIxgDW2v/2szcUjqDGoLrhUZu4DjUrP/XiMvqtl7ZOHy
/QAmTalj8hN13yN0fTZgN1hbPUToltbGyfovSQkDYGRq9h5J7VknFF1Xyx1MfqKuktA92JBcajdc
6aQ2qWX1FsD3aWEs4FrU/+XtW2Rpo1Hb0QVQxzIAqlAl4QTM9clF6gxaDH5tYP2XFAUDoApVESYx
rKL0yYSljUUDYXb2t2mf8wFa/yVFwQCoQtU0/QF0ALw2ZjMIp/ZpzxNBW/8lRcEAqELVQHfCLEpP
FK6N2V3rYZvWf8WituBakTEAqlAXwh/AKvwDqPhY/yVFwQCoQmkLSAWeBkPxsf5LioIBUIXSMVAQ
BthLMbH+S4qCAVCF0lmQ/hcExcj6LykKBkAVSs+Dtory+H+xUltY/yVFwUHOKpT+J4Rq/IGg+Fj/
JUXBAKhCFTTNgLR+KDbWf0lR8BeuCuVo+uPnH0DFxvqvWNR2dAHUsTzAqVD6B7AS64fiY/2XFAUP
cCqUSy5SjKz/kqJgAFQxOfxDqHhZ/yWVPQOgJEnxqcVxgFEzAEqSJEXGAChJkhQZA6AkSVJkDICS
JEmRMQBKkiRFxgAoSZIUGQOgJElSZPxfwJIkxae2owugjmULoCRJUmQMgJIkSZExAEqSJEXGAChJ
UnxqcRxg1AyAkiRJkTEASpIkRcYAKEmSFBkDoCRJUmQMgJIkSZExAEqSJEXGAChJkhQZ/xewJEnx
qe3oAqhj2QIoSZIUGQOgJElSZAyAkiRJkTEASpIUn1ocBxg1A6AkSVJkDICSJEmRMQBKkiRFxgAo
SZIUGQOgJElSZAyAkiRJkTEASpIkRcb/BSxJUnxqO7oA6li2AEqSJEXGAChJkhQZA6AkSVJkDICS
JMWnFscBRs0AKEntbxDwUTzGbmx6AcOBHh1dEKmjeXCSpPazF1AHTAbuAWYB3+jQEjW3OfDrFtbv
BnxvA5WllC8AJ63B43YClgNXFlk3Kll3VWbZ94FngDuA14DL162YUudmAJSk9vFR4C/A/wDbEMLg
dsC7BY8bBHQrsY2eQJ8S6zYtsa4CGAx0KbKuGhgKdE3udwX2LbF9ku1/osjyLsk+1uRvxuZA3xbK
WV3ieQOB3oQWuuGt7KMK+Cnwhzasu5jwuYwGtgdOB7ZtZT9S2TIASlL7+ALwOPCbzLL3gZuT29sB
LwK3JtfnZx43B7gGeAB4lhBWUu8APyAEmn8BF2TWHQa8BPwcmAEcl1l3DvB/wHWElq9tgSsI4Wwi
8LuC8ucIrWJ7JOuvTpZ/GXgFuCnZ3ugSr38SoXXxvuT27TT9jdk32cYvgVdpauHrCSxJHntX8p6c
BJyYlOGUEvv6NuH9eLXIuv9HeB9fKVi+NHN7JbACWFZi+1LZ80TQktQ+RgDTWlh/LfAT4HpgM+AF
QovhM8n6l4CzCK1wrxNaElck614AvgX0o6n7sifwM0K4mgn0T/b/J2AX4CuEbtL3COGuCjgXOAg4
pEj58sB3gDOBw5NlgwhdrDsBbwJHEoLgiBKvcSmwX7KvScAxwL3Ar4DTgL8SWiSfAR4CPkhex12E
0AYhEFZQeoLCCOBTwP7AZQXrtkvKuD9waZHnHpeUY1vCezGrxD6ksmcAlKT1LwfsDXwuuf8eIQDt
TVMA/FNy/Q6wABhAU0BJ180ndCn3J4SdSmBCZj+VhHBzACF4vZcszxNavdpqV+BpQviDENJ+TWhF
XFDk8Wmr4irgfsLr+wehW/ivybo3gOmEkPoYIeT+iTVTSQi9ZyT7yKpoYV3qr8DzhNB8MfAg8NYa
7lsqKwZASWofM4B9WnlMroV1KzK362k+RKfYugpCILw7s+5u4N9rsK8NKU/LZfkQaFjDbX2MEEp/
ntwflGy7AriRMIml2LpvJcveTS4vEloRxxK6pTujzxK6sB8gvMdSmzgGUJLax22EFq/jM8s2BU4m
/IH+BzAuWb4ZcChhzODamkZoCVyR3J5G6Dr+AHiY0P26WfLYHGHyxeKkTKV+/C8GPpK5/zQhcA1K
7h9JaJUs1voHcGxyXQV8hvCa5yaPH5OsGwqMpHR3+WLCZJBiXk2ee1xyuZ8wFvAqQtd4dt19hHCU
zgQemNlOX0K3duE4wdQ4mk4VswNhXGSxdR1pBPB74GXgKNoW+HOEFtCLk9ulLipjtgBKUvt4i9Ci
9DPC2LQFwJY0nabkvwmnhvksIQT9L2FSx9paBIwndPXOAjYhBL5RhOD1M+A5wtjCwcDRhNbB2wkt
YG8CBxZscxohgD2fbONUwoSLKYSwtBVhgkYp3QinwOlL6Nr+PSH8fhG4hTBW8WOEcYbzCOP/Ct2X
PO9fhNa5n2TWrSQEvdS7hIaMucn9wnVVhAk2ECbfDE5e3xDCWMzJRfafA35LmIn8OiHwDQOeTNb/
Fti6YF8dpYLwft5BaA0+h1DH1rRFsFTIs0UxAgZASWo/TwI7A1sQjq+zafpj+jKhhWogsJDQ9Zka
ULCdj2VuF576ZWjm9kTg48k2VxJCQOoq4EfJujmE8+IBfK2F8q8gtExm/YoQGvsXvJ5irgOeIrSQ
vZNZ/g/CaxpICH7peMT3aWqlTL1BeA/XxLktrPtOwf2DCe9lD+BtSo+JLOyyri1YvzG2jPVMLjcR
znfYWhCsoPXXkScMN1CZMgBKUmm1HV2ATmQoobv7oA4uRyxqiixLg+DtwA2EzyMdI1iTeU6pAPgo
Ta2iBsAyZwCUJLWHhwjd0to41ey/18iLavYeWXTlpCl1TH6i7nuE1toG7AYuewZASSqttqMLIJVQ
SzjfYdb7tDAWsGbvkdSedUKJjd3B5CfqKgmThRqSy/KiD1ZZMABKktS5tRj82qCS8G//6rH7t+wZ
ACVJ6pwaCLOzv037nA+wijCbfBWlT6atMmEAlCSp85lBOLVPe54IupqmALg2/zlGnYgBUJKkzueu
9bDNaqA74XRA/qOIMmcAlCRJEMb/dSdkAwNgmTMASpIkaGoBrMDTwJQ9A6AkSYKmMYAQJpiojBkA
JUkSNM0CzuMkkLJnAJQkSdB0HsBVhNZAlTEHeUqSJAgBsDq52EBU5gyAkiQJQiZIZwCbD8qcH7Ak
SQLI0RT+zAdlzg9YkiRBUwCsxHxQ9vyAJUkShACY6+hCaMMwAEqSpFQOg2AUDICSJEmRMQBKkiRF
xgAoSZIUGQOgJElSZAyAkiRJkTEASpIkRcYAKEmSFBkDoCRJUmQMgJIkSZExAEqSJEXGAChJkhQZ
A6AkSVJkDICSJEmRMQBKkiRFxgAoSZIUGQOgJElSZAyAkiRJkTEASpIkRcYAKEmSFBkDoCRJUmQM
gJIkSZExAEqSJEXGAChJkhQZA6AkSVJkDICSJEmRMQBKkiRFxgAoSZIUGPFzMQAAIABJREFUGQOg
JElSZAyAkiRJkTEASpIkRcYAKEmSFBkDoCRJUmQMgJIkSZExAEqSJEXGAChJkhQZA6AkSVJkDICS
JEmRMQBKUufVDRgO9F4P2/4osFcL66uBrYAB62HfnclBwEcy93cBxgEDgcOB7h1RKKk1BkBJ6py+
B7wC/AJ4EvhLO29/L+CbJdadALwB3JbsdxZxBJ0tgFsLln0NGJTcPhq4A/g44f34H6DPWu6rgvb/
TKVGVR1dAElSm+0KjAe2A5Yky7YqeEwVsCUwG6gvso0tgXeAFQXLtwA+bGHf1cCNwO7AC8myQUW2
81FgQYltDQLeB95rYT/Q9BreBlYVrKsgvOY5yT76ApsSXu/yFra5WeZxDZnlvYBNgHlFntMreV4l
8MmCdcdkbu8L/Az4UXJ/5yLbGpiU752CMm2WlCl9nTlC62IxWwBLafrspTYzAEpS59MbWFmwbFbm
9njgAuDfhNaoU4BJwFHA/wMWAz2AbQndlP8ihJ/fAf2Sbb8J5IvsexOga8H+38rc3pvQKjkL2Br4
AXAD0J8QGCclt+8GLgaGJeUheV4d8GPgeOCSzGs4DfgbcChwKSH05ZPX81VgH0KL6NbAmKT8Wb0J
LZZpaKwEDia01N2cPO+D5HV9hhCu7iUE248D/5dsZ0tgIrAQ+CzwT+B0YCfgv5JtHJE89pPACGBm
8r7cBPyHEEDvTt6bHwJ7AouA7YEvAY8AVxD+Rk9MtjU2KeOvk31/FLgP+A7SWjAASlLn8ygwgxBk
/koIRrcRgtTWhPC3G/AuIVTcRwgxJPdHAPOBbwBfJwTEU4BlwB7J4x4ghJlCSwjh5AXgMeDhZN+z
gC7J7aOB6UDP5PoPhJatvoQw+HCyrX0IoekmQhD7NCHQbEXoPt2VEHY+BjyUvLb0NWyf7HMzQrAd
QAiEueRS6GJCKDwyud8luf5W8j4el9y/AjgTuCy5X0l4L/PAUELL5yFFtn8TocVvBnBdsuy15Loa
uBP4cua1p/s/j/C+Q3jvf5pcn5uUI7uvXySv4w+Ev9//IHTVP1GkPFKLDICS1PmsBA4DRgI1wOcJ
QW5XYD9Cq9W5mccPommiwpOE8Aehte2w5PbewO9pavX7PaElrZjzCUHuIEIL4tmE0FJJGPN2fHKB
0P28EzCNEB4fzmznZkIAuonQ6vZ4Urbjk9dwduaxfQldnyTbSls8lwCvApMJLZi/o3lraOoAQgBL
pV3WBxMC4BXJ/a1pCmcQwnOxltC2SINr9rWn+9+eEEKHJfvdmuI2IXxG+yTXEILu7hgAtRYMgJK0
7nKElqVuwF0bcL91yeV6QjfjXoQQ9gahizF1N02tednxcQ00TQZsa8j5DyHA3UxokTqG0Gq4pMi+
XyO0ghW2KE4kjCfcmtBtnbacVSbbL9zOouR2djsNhNC7H6El8GlCqJ1WsK+0dbBQJSE8/jOzbHHm
9tIiz2mrUu9tJeE9O47QmvcRVu+6TlUQwvS9NI0TvJvm3e/SGnMWsCQ1ybVyKfb4o4CXCC1PIzZM
MRlC85aifoRxZXMJYWYUYeLEtOTyBqtP0ig0hRDi0td6dInHdQNGZ+53IYxHm0sYr1dPGF+Y7vvf
hAkfxdQTZs2el5T5z8nyxwgtY/MLXkOxyR3pmMS/E7q0HwQ+UeRxDwMn0/Q5pq18E5PX82xmX++s
9uxgMaHLua1/O18lBNWDM8u6ED6zbsBThJD4ucz6esLr7ZncX0povd0+U87nKf3eSi2yBVCSSkvD
QrEWnIOBa4HBNP2R3lD6EVoalxNm2n4c+D5Ns3LPJnSnvkKYwfouYRJBS35J6M59OtluqZaoKkJL
XW9CK93WhIkdtxNC5mcJXbrzCEGpL2F2bCk3E8bN/ZCmiSVvEMa/PUIIT5sSxskdWOT5/QljIl8h
fA71hCBY6GLC+MTnCGE1T+ji/j7wc8J79wYhXF9DGG9XaCGha3xG8thDW3hdWasI3do3E2b6dgd+
m+znbkL4fBN4veB5P0zWvUeYKHIy4X0+lRD8BhHOOfj8GpZDamQAlKTmcoTgkl5SeUK46Mjgl3qa
ELz6ElqQ5tB8Vu6dwG9oOt1K2nX6h+SSeiS5QJhVewQhUC1i9VnGqSWEyQ6bJvufQ9MkBghdqTsQ
xuvlkvWpLYts7yWKt67eDdyTvIalhPAFYTLIQ5nHpbONBxA+n+z+st4jtNZuRvjcZifLPwROIryP
/ZPnpy2NxxbZzlcK7u+ZuX1GwbrhmdtPEE7bM5DwfqWfyVcJ79X7hK7tUzPPuTC5pF4hdPNvTmj5
nEvxU/xIrTIASorSpKl1TJo6vdl9YBvgU4SWrOWEP8qTCQHlcMJ4tZ6ELsdiaoDa9VRkqa1qO7oA
2ngZACVFadLU6UyaUkfN3iMBqBk9kprRI4eTtNpMmlLH5CfqXiEMzs/jmGlJZcQAKClaNXuPpPas
E4quq+UOJj9RV0mYvdpAmFzQl5a7gCdhq4ukTsBftJJUWiVhtmY1TT+Y/0aYiXk0YTKAszAldToG
QEkqrYqm04x0KVj3N8JkhxMIpzppQJI6CbuAJam0akIAXEXxWbF5wqzaB2g6EbQkbfQMgJJUWjXh
nG0raLnHJA2CktQpGAAlqbQuhABYhUNmJJURA6AklZa2AFbQ9v+VK0kbLQOgJJWWjgEEJ3lIKiMG
QEkqLZ0FnKf0v0aTpE7HAChJpaXnAVxFaA2UpLLgoGZJKi39TyDZE0FLUqdnAJSk0ipomgHs8VJS
2fCAJkml5WgKfx4vJZUND2iSVFoaACvxeCmpjHhAk6TScslFksqKAVCSWpbDICipzBgAJUmSImMA
lCRJiowBUJIkKTIGQEmSpMgYACVJkiJjAJQkSYqMAVCSJCkyBkBJkqTIGAAlSZIiYwCUJEmKjAFQ
kiQpMgZASZKkyBgAJUmSImMAlCRJiowBUJIkKTIGQEmSpMgYACVJkiJjAJQkSYqMAVCSJCkyBkBJ
kqTIGAAlSZIiYwCUJEmKjAFQkiQpMgZASZKkyBgAJUmSImMAlCRJiowBUJIkKTIGQEmSpMgYACVJ
kiJjAJQkSYqMAVCSJCkyBkBJkqTIGAAlSZIiYwCUJEmKjAFQkiQpMgZASZKkyBgAJUmSImMAVPTy
0DMPw/PQaz1se3gedmnv7W5s8rBvHrbI3N8xD+PyMDQPB+fhIx1ZPklScwZARSsPuTxcB7wE/AJ4
Ng93tvNuDgZOKbH/ujzMzsOrmcse7bz/dpeH7nm4r2Dxl4CPJetrgPuBEcCmwPnA4HXY3+/z0H1t
ny9JWl1VRxdA6kCHAAcC2+TgQ4A8bJV9QB6qgQHAWzloKNxAHgYC83OwssjyxWtQhhNy8EhbC560
Vm6Sg3kFyz9CuLydg2UtPL8nsDnhddUXLO+ZgzlFntMD6AssIoS8Rjk4OXN3H+DOHFyS3D+gyLYG
APU5mJ9ZtmlSptkF72cNRY5VeegHrMjBe6VepySpOAOgYtYbWAHk0gU5mJXezsN/A18HXiN0ZX4h
B0/n4YvA5wgt6F2BYXk4MAevJMHsT8m6SmA2RcJUS/JwBrBzLrSqpaHsDeDjhFD3q+T2knwIb5/J
weI8XAkcTWjRHJqHz+fg+YJtd0uePxL4D9AH2D0fjgU/B3YFFiSP+3QO5ufhxuS92hp4OylLjzxM
BFbl4LA8/AW4Jnncl4CGPOyV7HYP4IAcPJOHnYDbgQVAdR4m5eC7ebgIOJwQCHfMwxk5eCAP3yW8
/vvzsAo4Lrl/F7Ac6JOHKTk4rS3vsSTFzgComP2REPLm5OEhQqC5PQfLknF7pwKfyMHSPHwS+F9g
z+S5I4CRSfC6FPgKcA7wDeDlHJyShKpJtBwAr8qHFrXUscCvgYvy0CMHHwD/Bfw9BwvzoTt1QS4E
UPLwPeAbSRkmAJunrWf5EEALfTu5HpkLIa1Lcv9Uwu1P5CCfh7OB7wBnJet7A7vnoD4JuSfkQgtq
Mzm4Ow87EoLhpUk5ns485DbgkhzcnaxL939lDi5Olm1DCJQP5OCyPHyLEEYXJ+tvAn6eg5vzIbw/
mIfDc/DnFt5nSVKGAVDRSoLdvsDOwH6EEPTVPIwmdA1/CFyYb3rKTvmm78xjuaYu3jrgM8ntvYFr
k+2vyoexcMNaKMaNNA9IS5NQOZnQmnc7ocXxymT9wYRWuSuS+8OBbkloexR4PA/3AL/PwStF9ncA
8P20OzsXWkDT7VYClyevd2BBuf+Q7SpeG0mX7dA0/BXsf1g+BOhtCK2qQ/NQXaRrPQccBPwnD9sl
i7sBu2MAlKQ1ZgBUu0j+MB9JCCN3dXR51lQO8sAzhO7JnxG6IHcgdOH+H5mwktxOxwEuzyxvoGlC
VSYvrpF/52BakeU3A/+dh38QQtFfk+WVhHD4ROaxS5LrIwkB9ChCEDw+B39fw3JUAFMz+wFYWuL2
2mrpvXkA+Fqy/wpCV3cVBQEwUUGYhJKO/bubNnazS1LsnAWsQrlWLs0kM2mPIow7+x2ha7RTyMPH
8s1npw4kTPqYTwhOewCv52BaEtLeKDYRpMAU4Jhk+1XAp9eyeH8hBNHzCRMqViXLJxJC3rOZci1I
9tUzB4/nQvftb4Ddimz3b8DJ+eS7n+mC/Vuy3ecy251X5PkQwmCXfGipW2O5MO7vtXwYx0e6/6Sr
ekvCWL4GQjd49sfpEkIXdBrYHyaMkUzLOZ2mECxJWgMGQLWmaPADyIduwxeAOwiTEoqNOduYfRR4
LDkdy2OE1rZv5cIs1KcJ3a7T8vBQHp4ijAFszY8JwXIq8Dgwt5XH358PY/vSy2cgdB8TTknzZUJr
YOoqwroX8/CXfHj//4swQ3d6Hv6eD/vdh9B9XOgaQsh6Ph9a2x5Lll9HmBQyI9luHc1n9jZKyvbT
ZBtTW3l9hU4CLsjD5KR184Kka/knJO81cBhh7GPqh4TX9XQ+zBI+HfhUcv+vhAA4so3lkKSo2QWs
YnKEHwfpJZUnTAI4mDDObTBhRmanlJx+ZWg+nMC4GpiTaWkjBzckM2AHAe+lpxvJhUB2c+Zx9xAu
JOMC909Oc7Igu70i+28xtOTg/xEu2WUfAuOTWbr9gbmZU9gMI7SkQTgNzGpdrsmpYT6fzCzuTZjV
SxLCTk9a9bZMtrssWfeVIts5m3BJ7x+WuX1RwWN3y9yeDoxM3p9VSasgOTgnD1cDy5P38IuZ5/yQ
cMk6IB/K35OCz02S1DoDYMQmTa1j0tTpze4Txpt9ijA4fznwPjB5G8hNh8O7hUDUk9LdfzV5qF2f
5V6fWhqk1tbBfWv7nPbax5rue12fvy6K7aM93+dcJ66LkrQ+GQAjNmnqdCZNqaNm79AQVTN6JDWj
Rw4nzCxl0pQ6Jj9R9wrwjw8hvwIqunVgeSVJUvswAEauZu+R1J51QtF1tdzB5CfqKoHqN6GhNzwI
9G2lC3iSrS6SJG3cnASi1lQSZopWk/xgyMHfcrA94Tx1MwjdxJIkqZMwAKo1VcAmhDF/XbIrcuHU
ITsAJwD/pvVTpEiSpI2AXcBqTTUhAK6iyEl5k5mmf8iHE/keSZidKkmSNmIGQLWmGuhOmBVcssU4
DYIbqlCSJGntGQDVmi6EAFiFQwYkSSoLBkC1Jm0BrGDDnBpOkiStZwZAtSYdAwhO8pAkqSwYANWa
dBZwniKTQCRJUudjAFRr0vMAriK0BkqSpE7OQf1qTSUh+DWeCFqSJHVuBkC1poKmGcDWF0mSyoB/
0NWaHE3hz/oiSVIZ8A+6WpMGwEqsL5IklQX/oKs1ueQiSZLKhAFQayKHQVCSpLJhAJQkSYqMAVCS
JCkyBkBJkqTIGAAlSZIiYwCUJEmKjAFQkiQpMgZASZKkyBgAJUmSImMAlCRJiowBUJIkKTIGQEmS
pMgYACVJkiJjAJQkSYqMAVCSJCkyBkBJkqTIGAAlSZIiYwCUJEmKjAFQkiQpMgZASZKkyBgAJUmS
ImMAlCRJiowBUJIkKTIGQEmSpMgYACVJkiJjAJQkSYqMAVCSJCkyBkBJkqTIGAAlSZIiYwCUJEmK
jAFQkiQpMgZASZKkyBgAJUmSImMAlCRJiowBUJIkKTIGQEmSpMgYACVJkiJjAJQkSYqMAVCSJCky
BkBJkqTIGAAlSZIiYwCUJEmKjAFQkiQpMlUdXQBJG1RNcolRzaSpddRecwcAk6bWATTeL5Ss3wb4
FLACWA7ssgHK2VEmJRdJETAASnGp2XXXXS/afffdO7ocHWbu0nA9YqdPNrtfaMROn2TETp/cGth6
w5Ss4zz11FNMmzYNDIBSNAyAUmR23313TjvttI4uhjYySQCUFAnHAEqSJEXGAChJkhQZA6AkSVJk
DICSJEmR6QyTQGo7ugBlxNNgqKY9NrJq1SoWLFhAVVUVffv2bY9NblBz5syhoqKCfv36kcvlOro4
LZoyZQo77bQTPXr0WN+7qsHjbTlrdvwv5PF+vajt6AK0xBZASSUde+yxLFq0iOOPP565c+cC8NBD
D3HYYYdx3nnn8fWvf51DDz2UDz74oINLCgcffDANDQ0cfvjhLF++vOhjnnzyST796U9z6qmnctZZ
Z3HYYYfxu9/9bgOXtLS3336bSy65pNmy22+/nYULF3ZQiSSVK1sA41JbM3rk/rVnnRDuJL8E0/ur
PfiaO5g8te4V4I/A+8Bi4A8bpKRaX2qB/df2yQ0NDVx88cXcfPPNfPzjHwdg/vz5dO3atdnj5s6d
S+/evVdb3tDQ0LiuW7dua7zfdB+9evUCYMGCBXTv3p3u3buv8TbeeOMNvvnNb3LFFVew7777ArB4
8WIef/zxxsfk83nmzZvHRz7yEbp06bLaNj744APq6+sby5H1/vvv09DQsNq6hoYG5s2bR79+/ais
rGy2buXKlcyfP59+/fpRXV3NsmXLmD59erPHXHfddUW317dvX6qqVj+Ev/fee1RVVa1Ni+EkPN6W
s2bH/9VWeryPTmcIgJI6SI8ePcjlcnTv3p2KigpWrlzJhx9+2Cx49OvXr/H29OnTqa2tZYsttuDN
N9/khBNO4HOf+xwA999/PzfccAPDhw9n3rx5nHvuuWy99dYce+yxPPzwwwCsWLGC/fbbjyeeeILl
y5ez3377MWbMGN58800+9alPscsuu3DuuefSu3dv5s6dyyGHHMLXvvY1AHr27NnsutB9993HgQce
2Bj+AHr16sXhhx8OwIwZMzjnnHPYcsstmTlzJuPHj+fzn/88EM6dePzxx/Piiy/yxhtvMH78eL7w
hS8AsPPOOzN+/HheeOEFXn/9db785S83Pm/ixIlce+21DBkyhDfeeINzzz2XffbZB4Cf/vSn/OUv
f2HYsGG89dZb3Hjjjfz4xz9m9uzZnHrqqfTv359LL72UY489lquvvpphw4bxxBNPcMkll7DVVlvx
xhtvcNZZZzFmzBgWLFjAcccdx4EHHsjMmTN59dVXOfvssxk7duw61gBJ5aozBMDaji5AGXEMoGra
8uBbb70VgF/84heNy77yla8wbtw4dt55Z/bcc0+OOOIIBg4cSH19Peeffz5XX3012267LcuWLWPc
uHHU1NSwfPlyrr32Wu66667GMYMrV65stet4+fLl1NTUcNBBBwFw0kknccYZZ7DPPvtQX1/PF77w
BQ444AC233577rvvPgB++9vfFt3W66+/zp577llyX5deeimnn346Y8eOZeHChRxzzDHss88+DB48
GIAdd9yRb37zm8yZM4dx48Y1BkCAUaNG8Y1vfIO33nqLE044gc9//vMsWLCAH/zgB9x5551svvnm
zJ49my996Uv8+c9/5tFHH+XRRx/l3nvvZZNNNqGhoYF8Ps+ZZ57J2Wefzc9+9rPVyrdq1SouvPBC
rrzySj7xiU80BtHRo0cDsHDhQo466ihGjRrFc889x2WXXdbWAFiDx9ty5hjADa+2owvQks4QACVt
RCZMmMAxxxzDk08+yeOPP864ceO47bbbqKysZOHChTz44IM8+OCDAFRWVvLyyy+zcOFC9thjj2YT
Rqqrq1vdV0VFBfvvH3qsly5dyvPPP8/TTz/d7L9WvPDCC2y//fbr9JqWL1/Oyy+/zCGHHALA5ptv
zi677EJdXV1jAExb7gYMGACE7uC0mzVtVRw0aBArVqxg+fLlPPfcc1RVVXHbbbc17mfp0qW8/fbb
PPXUU4wdO5ZNNtmk8XW2Zvbs2eRyOT7xiU8AMHToUAYNGsS///1vhgwZwmabbcaoUaMA2GabbZgz
Z846vSeSyltnCIC1HV2AMuIYQNWyDmMAU1tssQVHHnkkRx55JN/61reYOHEiY8aMoVu3bo0hCuCQ
Qw5h0KBB/P3vfy+6nVwuR0NDQ+P9lStXNltfXV3d2N2cz+epqqri4IMPbgxMhxxyCFtsscUalXnY
sGG8+OKLJde3Nhs4OyawoqKiWbmzYTZ9TQ0NDfTv33+19yMNwfl8fo3K3Vr50uXZMhSWbw1NwuNt
OXMMoJpxFrCkNbZixQqee+65xvsrV65kzpw59O3bl8GDB9O1a1fef/99tt9+e7bffnuGDBlC9+7d
2XXXXXnyySeZP39+s+f26tWLlStXMm/ePAAmT55cct89evRg2223ZebMmY3b33rrrdd4IsjRRx/N
I4880mwfixcv5o9//CNdu3Zl2223ZeLEiUDoTn3mmWcYOXJkm96frJ122olZs2bRq1evxvIOHDiQ
rl27sueee/LQQw+xbNkyIEzsqK+vp0ePHixZsqRoOBw4cCBA4/v/+uuv89ZbbzVOxpGktugMLYCS
NhL19fVcfvnlLF68mAEDBvCf//yHXXfdlSOPPJKqqiquuuoqLrjgAnr37g3AokWL+OUvf8lWW23F
mWeeyUknncSQIUNYuHAh55xzDrvuuiunnnoqJ5xwAltttRU77rhji/u/7LLLOO+887jrrrvYZJNN
mD9/Ptdccw3Dhg1rtexDhgzhxz/+Mf/zP//D1VdfzaabbsrChQuZMGECABdeeCHnnHMOv/vd75g1
axYTJkxo7P5dG/379+f8889nwoQJDBw4kGXLllFRUcHNN9/Mfvvtx/Tp0zn22GMZNmwYs2fP5sYb
b2SLLbZg11135eijj2bo0KH86Ec/atxeZWUll1xyCeeddx6DBg1i1qxZfPe736Vnz558+OGHa11O
SXHauM+AqvZWe9FZx1/Uli7gi6+58yHgPuwSKBe1p5122kWnnXbaOm1k6dKlLFq0iL59+652qhcI
LWgNDQ306dOnWddlehqYzTffvNnzlixZQkVFxRqfuuTdd99l5cqV9OnTZ43GzxVasGAB+Xy+2Qzm
VHoamDUZo7gm0lPLdO3atTEYpwpPA7MmGhoaWLBgAX369FnttDJr64YbbuCGG264GLuAy1mz4/9q
Kz3eR8cWQElt1to5+DbffPOiyysqKthyyy1XW77pppu2af+FQaqtWvrvJf3791+nbRfK5XIlxylW
V1c3du2uqYqKinYvo6T4OAZQkiQpMrYASpF56qmnOroI2shYJ6T4GACluEyaNm1as/PoRaRm/9Ej
968ZHWb2pidCT+8XmjS1jslT614FXqLpxLgvb5CSdoxJHV0ASRuOAVCKyyTi/UPveTAlKeEYQEmS
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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you see the client is presented <strong>Eves</strong> certificate which is the <em>evil</em> one. Now the client has 2 options:</p>
<ul>
<li>trust the presented certificate and hope it's from the <strong>Server</strong></li>
<li><strong>pin the certificate</strong></li>
</ul>
<p>In the following I'll take a closer look what's inside the certificate and which options one has to do the pinning.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ee07f188d5803e5756ab1e271dc04ec6">Inside the certificate<a class="anchor-link" href="#Inside-the-certificate">¶</a></h2><p>A <a href="http://en.wikipedia.org/wiki/X.509">X.509 certificate</a> usually consists of three main components:</p>
<ol>
<li>the <em>certificate</em> itself</li>
<li>certificate signature <em>algorithm</em></li>
<li>certificate <em>signature</em></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the rest of post I'll be analyzing the SSL certificate of <a href="https://www.google.com">www.google.com</a>. Now let's get back to work:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="a54237ff28b269dcfbc09717c8ab62c1">Connection settings<a class="anchor-link" href="#Connection-settings">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create new SSL context with several security tunings</span>
<span class="n">ssl_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLSv1</span><span class="p">)</span>

<span class="c1"># Allow NO SSLv2</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">options</span> <span class="o">|=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">OP_NO_SSLv2</span>

<span class="c1"># Prevent CRIME attacks (OpenSSL 1.0+)</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">options</span> <span class="o">|=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">_ssl</span><span class="p">,</span> <span class="s2">"OP_NO_COMPRESSION"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Allow only good ciphers</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">set_ciphers</span><span class="p">(</span><span class="s1">'HIGH:!aNULL:!RC4:!DSS'</span><span class="p">)</span>

<span class="c1"># Validate the server certificate</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span>

<span class="c1"># Check host name</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">check_hostname</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Load CA bundle</span>
<span class="c1"># HINT: This path may differ on your system</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">load_verify_locations</span><span class="p">(</span><span class="s2">"/etc/ssl/certs/ca-certificates.crt"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="8ec66ba8eaf0e99b05a99885ddb90da0">Make connection<a class="anchor-link" href="#Make-connection">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define target information</span>
<span class="n">target_host</span> <span class="o">=</span> <span class="s2">"www.google.com"</span>
<span class="n">target_port</span> <span class="o">=</span> <span class="mi">443</span>

<span class="c1"># Create SSL socket</span>
<span class="n">ssl_socket</span> <span class="o">=</span> <span class="n">ssl_context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span>\
                <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">),</span>\
                <span class="n">server_hostname</span><span class="o">=</span><span class="n">target_host</span><span class="p">)</span>
<span class="n">ssl_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">target_host</span><span class="p">,</span> <span class="n">target_port</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we've established the socket connection, we can fetch the certificate and do the analysis.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="0e7818eae6d2cf9711fed86f846ce554">Fetch the certificate<a class="anchor-link" href="#Fetch-the-certificate">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fetch human readable certificate</span>
<span class="n">cert_string</span> <span class="o">=</span> <span class="n">ssl_socket</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()</span>

<span class="c1"># Fetch certificate in PEM format</span>
<span class="n">cert</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">get_server_certificate</span><span class="p">((</span><span class="n">target_host</span><span class="p">,</span> <span class="n">target_port</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>You don't know nothing about <strong>ASN.1</strong>, <strong>DER</strong> or <strong>PEM</strong>? No problem! Just have a look at this <a href="https://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem">great article</a>. But to summarize it:
<em>DER</em> is binary format, its structure is called <em>ASN.1</em>. <em>PEM</em> format is Base64 encoded representation of <em>DER</em>.</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="0a43ce513d6dfba3f3363e584c036791">PEM format<a class="anchor-link" href="#PEM-format">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">-----BEGIN CERTIFICATE-----
MIIEdjCCA16gAwIBAgIIX7v8fExu/5IwDQYJKoZIhvcNAQEFBQAwSTELMAkGA1UE
BhMCVVMxEzARBgNVBAoTCkdvb2dsZSBJbmMxJTAjBgNVBAMTHEdvb2dsZSBJbnRl
cm5ldCBBdXRob3JpdHkgRzIwHhcNMTUwNTA2MTAyOTI1WhcNMTUwODA0MDAwMDAw
WjBoMQswCQYDVQQGEwJVUzETMBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwN
TW91bnRhaW4gVmlldzETMBEGA1UECgwKR29vZ2xlIEluYzEXMBUGA1UEAwwOd3d3
Lmdvb2dsZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDbQYCq
uMXjaNFVmagkNkToVsTlNpP17Hzps7nJVT+cNcu/bV4mREEG8oRZU1KERHPza3gd
4PmzInZxcMzi90wUoZIQhyMCdCtLDc2cSshJ3TaZM9unjrMzgTT5VhDnoTb72r8W
yqdYvY4wp2cvdfkaLpUirYVYkKww8bMemjXHMzBYHiAdDTLY6sBenM0+t7zfLRTl
t+JTZEx/bK/a7lEkHNFvCn2IW+MYt+668xVYw2TnBhXIJlo0ZrP5Vpa43qIRoykd
4vUVUk3scHyS7XhnDEU/D7IjW6BCWIB4/GrgCMezRTSRPYXufU2aQB9iwAlto7yD
HJW71m3BTUxDaxBnAgMBAAGjggFBMIIBPTAdBgNVHSUEFjAUBggrBgEFBQcDAQYI
KwYBBQUHAwIwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20waAYIKwYBBQUHAQEE
XDBaMCsGCCsGAQUFBzAChh9odHRwOi8vcGtpLmdvb2dsZS5jb20vR0lBRzIuY3J0
MCsGCCsGAQUFBzABhh9odHRwOi8vY2xpZW50czEuZ29vZ2xlLmNvbS9vY3NwMB0G
A1UdDgQWBBSMXZKKlB2MmLIyeqTTdGAZ7y+vRjAMBgNVHRMBAf8EAjAAMB8GA1Ud
IwQYMBaAFErdBhYbvPZotXb1gba7Yhq6WoEvMBcGA1UdIAQQMA4wDAYKKwYBBAHW
eQIFATAwBgNVHR8EKTAnMCWgI6Ahhh9odHRwOi8vcGtpLmdvb2dsZS5jb20vR0lB
RzIuY3JsMA0GCSqGSIb3DQEBBQUAA4IBAQBkJo403MR1GQekBQ5zJCAAcwEuJYn6
oDokSqvR+6Wh6O7L9mBLAkQOkg/uqfGZ8R5KbUSDbnEWl6OboJero8cp9dMnQjck
fZa661zDPoRDWegFm9aZMQLcdnPBi/TI9aEFuUOQLvCk31CrHVFyfSwznBYUZ+Yt
4qxu44/AxEfmLT7p0CF3Y/NvcA2fGRbckj2+3tONI+FTEH/V/SIwRmyXag2/GbPt
RhahlBFXh6VobK8dbFtql6P4+x//7+ze0tXaMRoRsOQfjwWmD6SaA13JJOo8/oBQ
aUYdqnU+Mgkfro7CDpEjOucBzZbsSevm9vPQMhExdju6pKf+nC0bz+7T
-----END CERTIFICATE-----

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="949e76819544dd5261b7fbb6746be5ba">TEXT format<a class="anchor-link" href="#TEXT-format">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">cert_string</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">{'OCSP': ('http://clients1.google.com/ocsp',),
 'caIssuers': ('http://pki.google.com/GIAG2.crt',),
 'crlDistributionPoints': ('http://pki.google.com/GIAG2.crl',),
 'issuer': ((('countryName', 'US'),),
            (('organizationName', 'Google Inc'),),
            (('commonName', 'Google Internet Authority G2'),)),
 'notAfter': 'Aug  4 00:00:00 2015 GMT',
 'notBefore': 'May  6 10:29:25 2015 GMT',
 'serialNumber': '5FBBFC7C4C6EFF92',
 'subject': ((('countryName', 'US'),),
             (('stateOrProvinceName', 'California'),),
             (('localityName', 'Mountain View'),),
             (('organizationName', 'Google Inc'),),
             (('commonName', 'www.google.com'),)),
 'subjectAltName': (('DNS', 'www.google.com'),),
 'version': 3}
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Have a look at <a href="http://www.zytrax.com/tech/survival/ssl.html">this site</a> for great explanations regarding the properties.</p>
</blockquote>
<p>From an attackers perspective generating certificates that contain the same data is easy peasy. So while doing the certificate pinning you shouldn't rely on these values. Furthermore rely on data that can not be manipulated or data that has been generated randomly. Of course there is still a risk with "pseudo-random" data in case of insecure <a href="http://en.wikipedia.org/wiki/Pseudorandom_number_generator">PRNGs</a>. Or don't you remember this <a href="http://article.gmane.org/gmane.linux.debian.security.announce/1614">one</a> anymore? :)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="edb6be217da69094167d4c5f83a48a56">Certificate pinning<a class="anchor-link" href="#Certificate-pinning">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When it comes to pinning you'll have different options what to "pin" for. Let's have a look how this is done using <em>Python</em>, but the procedure should apply to other programming languages as well. First let's do some conversions and extract data we're interested in.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="k">import</span> <span class="n">RSA</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="k">import</span> <span class="n">b64decode</span>

<span class="c1"># Convert PEM format to x509 Object</span>
<span class="n">x509</span> <span class="o">=</span> <span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">load_certificate</span><span class="p">(</span><span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="n">cert</span><span class="p">)</span>

<span class="c1"># Convert x509 object to ASN1</span>
<span class="n">x509_asn1</span> <span class="o">=</span> <span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">dump_certificate</span><span class="p">(</span><span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">FILETYPE_ASN1</span><span class="p">,</span> <span class="n">x509</span><span class="p">)</span>

<span class="c1"># Convert x509 object to PEM</span>
<span class="n">x509_pem</span> <span class="o">=</span> <span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">dump_certificate</span><span class="p">(</span><span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="n">x509</span><span class="p">)</span>

<span class="c1"># Decode the certificate</span>
<span class="n">der</span> <span class="o">=</span> <span class="n">asn1</span><span class="o">.</span><span class="n">DerSequence</span><span class="p">()</span>
<span class="n">der</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">x509_asn1</span><span class="p">)</span>

<span class="c1"># Store the components</span>
<span class="n">der_cert</span> <span class="o">=</span> <span class="n">der</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="c1"># certificate</span>
<span class="n">der_algo</span> <span class="o">=</span> <span class="n">der</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>     <span class="c1"># signing algorithm</span>
<span class="n">der_sign</span> <span class="o">=</span> <span class="n">der</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>     <span class="c1"># certificate signature</span>

<span class="n">der_sign_in</span><span class="o">=</span><span class="n">asn1</span><span class="o">.</span><span class="n">DerObject</span><span class="p">()</span>
<span class="n">der_sign_in</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">der_sign</span><span class="p">)</span>
<span class="n">der_sign_payload</span> <span class="o">=</span> <span class="n">der_sign_in</span><span class="o">.</span><span class="n">payload</span>
<span class="n">cert_sign</span> <span class="o">=</span> <span class="n">der_sign_payload</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># Extract the signing certificate algorithm</span>
<span class="n">sign_algo</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">get_signature_algorithm</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="9041f342bf6ef5c36e062b9bf83b3c03">Pin the certificate<a class="anchor-link" href="#Pin-the-certificate">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can of course check of the X.509 properties you've seen before, but you should not rely on these values. Instead use a digest (e.g. SHA-1, SHA-256 etc.) to <strong>fingerprint</strong> the certificate. If the generated fingerprint is exactly the one you have <em>expected</em> then you can trust the certificate. However certificates may change at regular time intervals, so you'll have to adapt your <em>expected</em> fingerprint value every time this happens. Pinning the <em>public key</em> is a much better solution.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Write x509 (PEM format) to file</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'/tmp/pyopenssl/www.google.com.cert.pem'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x509_pem</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
<span class="c1"># Show certificate fingerprint using openssl</span>
openssl x509 -fingerprint -inform PEM -in  /tmp/pyopenssl/www.google.com.cert.pem -sha256  <span class="p">|</span> grep Fingerprint
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">SHA256 Fingerprint=16:3D:A3:9A:7C:8F:4E:C4:79:59:5E:30:A8:82:2C:A7:58:CD:0A:6B:87:EF:7B:43:10:5A:97:C3:93:90:98:D8
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using this <em>fingerprint</em> you could now verify the authencity of the <em>presented</em> certificate. Besides checking the fingerprint you should check if:</p>
<ul>
<li>the certificate is NULL (this happens when the server has no certificate)</li>
<li>the certificates length &gt; 0</li>
<li>? (did i miss sth?)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="e4d97fb09fcb2e7fbc720ab492d0a75b">Pin the public key<a class="anchor-link" href="#Pin-the-public-key">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I'll first extract the <strong>public key</strong> from the certificate and print it in a human readable way.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="k">import</span> <span class="n">RSA</span>

<span class="c1"># Extract the public key</span>
<span class="n">pub_key</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">get_pubkey</span><span class="p">()</span>

<span class="c1"># Print the public key in TEXT formatboru</span>
<span class="n">pub_key_text</span> <span class="o">=</span> <span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">dump_privatekey</span><span class="p">(</span><span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">FILETYPE_TEXT</span><span class="p">,</span> <span class="n">pub_key</span><span class="p">)</span>

<span class="c1"># Convert to ASN1</span>
<span class="n">pub_key_asn1</span> <span class="o">=</span> <span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">dump_privatekey</span><span class="p">(</span><span class="n">OpenSSL</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">FILETYPE_ASN1</span><span class="p">,</span> <span class="n">pub_key</span><span class="p">)</span>

<span class="c1"># Convert key to DER format</span>
<span class="n">pub_der</span> <span class="o">=</span> <span class="n">asn1</span><span class="o">.</span><span class="n">DerSequence</span><span class="p">()</span>
<span class="n">pub_der</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">pub_key_asn1</span><span class="p">)</span>

<span class="c1"># Construct RSA key</span>
<span class="c1"># In Python 3 you no longer use "long" -&gt; Use "int" instead</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">construct</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">pub_der</span><span class="o">.</span><span class="n">_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">pub_der</span><span class="o">.</span><span class="n">_seq</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>

<span class="c1"># Print public key information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pub_key_text</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">Public-Key: (2048 bit)
Modulus:
    00:db:41:80:aa:b8:c5:e3:68:d1:55:99:a8:24:36:
    44:e8:56:c4:e5:36:93:f5:ec:7c:e9:b3:b9:c9:55:
    3f:9c:35:cb:bf:6d:5e:26:44:41:06:f2:84:59:53:
    52:84:44:73:f3:6b:78:1d:e0:f9:b3:22:76:71:70:
    cc:e2:f7:4c:14:a1:92:10:87:23:02:74:2b:4b:0d:
    cd:9c:4a:c8:49:dd:36:99:33:db:a7:8e:b3:33:81:
    34:f9:56:10:e7:a1:36:fb:da:bf:16:ca:a7:58:bd:
    8e:30:a7:67:2f:75:f9:1a:2e:95:22:ad:85:58:90:
    ac:30:f1:b3:1e:9a:35:c7:33:30:58:1e:20:1d:0d:
    32:d8:ea:c0:5e:9c:cd:3e:b7:bc:df:2d:14:e5:b7:
    e2:53:64:4c:7f:6c:af:da:ee:51:24:1c:d1:6f:0a:
    7d:88:5b:e3:18:b7:ee:ba:f3:15:58:c3:64:e7:06:
    15:c8:26:5a:34:66:b3:f9:56:96:b8:de:a2:11:a3:
    29:1d:e2:f5:15:52:4d:ec:70:7c:92:ed:78:67:0c:
    45:3f:0f:b2:23:5b:a0:42:58:80:78:fc:6a:e0:08:
    c7:b3:45:34:91:3d:85:ee:7d:4d:9a:40:1f:62:c0:
    09:6d:a3:bc:83:1c:95:bb:d6:6d:c1:4d:4c:43:6b:
    10:67
Exponent: 65537 (0x10001)

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's check that with <code>openssl</code> output:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
openssl x509 -inform PEM -in /tmp/pyopenssl/www.google.com.cert.pem -pubkey -noout &gt; /tmp/pyopenssl/pubkey.pem
openssl rsa -inform PEM -pubin -in /tmp/pyopenssl/pubkey.pem -modulus 2&gt;1 <span class="p">|</span> grep Modulus
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">Modulus=DB4180AAB8C5E368D15599A8243644E856C4E53693F5EC7CE9B3B9C9553F9C35CBBF6D5E26444106F284595352844473F36B781DE0F9B322767170CCE2F74C14A19210872302742B4B0DCD9C4AC849DD369933DBA78EB3338134F95610E7A136FBDABF16CAA758BD8E30A7672F75F91A2E9522AD855890AC30F1B31E9A35C73330581E201D0D32D8EAC05E9CCD3EB7BCDF2D14E5B7E253644C7F6CAFDAEE51241CD16F0A7D885BE318B7EEBAF31558C364E70615C8265A3466B3F95696B8DEA211A3291DE2F515524DEC707C92ED78670C453F0FB2235BA042588078FC6AE008C7B34534913D85EE7D4D9A401F62C0096DA3BC831C95BBD66DC14D4C436B1067
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
<span class="c1"># Dump the public key</span>
openssl asn1parse -dump -in /tmp/pyopenssl/pubkey.pem
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">    0:d=0  hl=4 l= 290 cons: SEQUENCE          
    4:d=1  hl=2 l=  13 cons: SEQUENCE          
    6:d=2  hl=2 l=   9 prim: OBJECT            :rsaEncryption
   17:d=2  hl=2 l=   0 prim: NULL              
   19:d=1  hl=4 l= 271 prim: BIT STRING        
      0000 - 00 30 82 01 0a 02 82 01-01 00 db 41 80 aa b8 c5   .0.........A....
      0010 - e3 68 d1 55 99 a8 24 36-44 e8 56 c4 e5 36 93 f5   .h.U..$6D.V..6..
      0020 - ec 7c e9 b3 b9 c9 55 3f-9c 35 cb bf 6d 5e 26 44   .|....U?.5..m^&amp;D
      0030 - 41 06 f2 84 59 53 52 84-44 73 f3 6b 78 1d e0 f9   A...YSR.Ds.kx...
      0040 - b3 22 76 71 70 cc e2 f7-4c 14 a1 92 10 87 23 02   ."vqp...L.....#.
      0050 - 74 2b 4b 0d cd 9c 4a c8-49 dd 36 99 33 db a7 8e   t+K...J.I.6.3...
      0060 - b3 33 81 34 f9 56 10 e7-a1 36 fb da bf 16 ca a7   .3.4.V...6......
      0070 - 58 bd 8e 30 a7 67 2f 75-f9 1a 2e 95 22 ad 85 58   X..0.g/u...."..X
      0080 - 90 ac 30 f1 b3 1e 9a 35-c7 33 30 58 1e 20 1d 0d   ..0....5.30X. ..
      0090 - 32 d8 ea c0 5e 9c cd 3e-b7 bc df 2d 14 e5 b7 e2   2...^..&gt;...-....
      00a0 - 53 64 4c 7f 6c af da ee-51 24 1c d1 6f 0a 7d 88   SdL.l...Q$..o.}.
      00b0 - 5b e3 18 b7 ee ba f3 15-58 c3 64 e7 06 15 c8 26   [.......X.d....&amp;
      00c0 - 5a 34 66 b3 f9 56 96 b8-de a2 11 a3 29 1d e2 f5   Z4f..V......)...
      00d0 - 15 52 4d ec 70 7c 92 ed-78 67 0c 45 3f 0f b2 23   .RM.p|..xg.E?..#
      00e0 - 5b a0 42 58 80 78 fc 6a-e0 08 c7 b3 45 34 91 3d   [.BX.x.j....E4.=
      00f0 - 85 ee 7d 4d 9a 40 1f 62-c0 09 6d a3 bc 83 1c 95   ..}M.@.b..m.....
      0100 - bb d6 6d c1 4d 4c 43 6b-10 67 02 03 01 00 01      ..m.MLCk.g.....
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So one could also check the RSA <strong>modulus</strong> against an <em>expected</em> value. Furthermore you could <strong>hash</strong> the whole public key and then check values:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
sha256sum /tmp/pyopenssl/pubkey.pem
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">618a8d05fce8d0f8f790e0a2fbaaf739ff7049e7da087520e81a31d0af81513a  /tmp/pyopenssl/pubkey.pem
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2fe7927bb0f69c27bca4ad2761afbcac">Validate certificate<a class="anchor-link" href="#Validate-certificate">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get the <em>trust chain</em>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
openssl s_client -showcerts -connect www.google.com:443  <span class="p">|</span> grep -e <span class="s2">"s:"</span> -e <span class="s2">"i:"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb"> 0 s:/C=US/ST=California/L=Mountain View/O=Google Inc/CN=www.google.com
   i:/C=US/O=Google Inc/CN=Google Internet Authority G2
 1 s:/C=US/O=Google Inc/CN=Google Internet Authority G2
   i:/C=US/O=GeoTrust Inc./CN=GeoTrust Global CA
 2 s:/C=US/O=GeoTrust Inc./CN=GeoTrust Global CA
   i:/C=US/O=Equifax/OU=Equifax Secure Certificate Authority
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre class="ipynb">depth=2 C = US, O = GeoTrust Inc., CN = GeoTrust Global CA
verify error:num=20:unable to get local issuer certificate
DONE
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">dot</span>
// &lt;!-- collapse=True --&gt;
digraph trie {
    rankdir="TR";
    graph [label="\n\nChain of trust for www.google.com"];
    node [shape = "Mrecord", width=6];
    equifax [label="{Subject:  GeoTrust Global CA \l | Issuer: Equifax Secure Certificate Authority \l }", color="grey"];
    geotrust [label="{Subject:  Google Internet Authority G2 \l | Issuer: GeoTrust Global CA \l }", color="grey"];
    g2 [label="{Subject: google.com \l | Issuer: Google Internet Authority G2 \l }", color="grey"];
    google_site [label="www.google.com \l", color="red"];
    
    root [width=2, shape="none"];
    leaf [width=2, shape="none"];
    
    equifax -&gt; geotrust;
    root -&gt; equifax [arrowsize=.5, weight=2.];
    geotrust -&gt; g2;
    g2 -&gt; google_site;
    leaf -&gt; google_site [arrowsize=.5, weight=2.];
    
    0 [shape="none", width=1];
    1 [shape="none", width=1];
    2 [shape="none", width=1];
    
    {rank = same; root; equifax}
    {rank = same; g2, 0}
    {rank = same; geotrust, 1}
    {rank = same; leaf; google_site}
    
}
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: trie Pages: 1 -->
<svg height="349pt" viewbox="0.00 0.00 692.00 349.00" width="692pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g class="graph" id="graph0" transform="scale(1 1) rotate(0) translate(4 345)">
<title>trie</title>
<polygon fill="white" points="-4,4 -4,-345 688,-345 688,4 -4,4" stroke="none"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="342" y="-7.8">Chain of trust for www.google.com</text>
<!-- equifax -->
<g class="node" id="node1"><title>equifax</title>
<path d="M174,-294.5C174,-294.5 582,-294.5 582,-294.5 588,-294.5 594,-300.5 594,-306.5 594,-306.5 594,-328.5 594,-328.5 594,-334.5 588,-340.5 582,-340.5 582,-340.5 174,-340.5 174,-340.5 168,-340.5 162,-334.5 162,-328.5 162,-328.5 162,-306.5 162,-306.5 162,-300.5 168,-294.5 174,-294.5" fill="none" stroke="grey"></path>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-325.3">Subject: GeoTrust Global CA </text>
<polyline fill="none" points="162,-317.5 594,-317.5 " stroke="grey"></polyline>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-302.3">Issuer: Equifax Secure Certificate Authority </text>
</g>
<!-- geotrust -->
<g class="node" id="node2"><title>geotrust</title>
<path d="M174,-211.5C174,-211.5 582,-211.5 582,-211.5 588,-211.5 594,-217.5 594,-223.5 594,-223.5 594,-245.5 594,-245.5 594,-251.5 588,-257.5 582,-257.5 582,-257.5 174,-257.5 174,-257.5 168,-257.5 162,-251.5 162,-245.5 162,-245.5 162,-223.5 162,-223.5 162,-217.5 168,-211.5 174,-211.5" fill="none" stroke="grey"></path>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-242.3">Subject: Google Internet Authority G2 </text>
<polyline fill="none" points="162,-234.5 594,-234.5 " stroke="grey"></polyline>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-219.3">Issuer: GeoTrust Global CA </text>
</g>
<!-- equifax&#45;&gt;geotrust -->
<g class="edge" id="edge1"><title>equifax-&gt;geotrust</title>
<path d="M378,-294.366C378,-286.152 378,-276.658 378,-267.725" fill="none" stroke="black"></path>
<polygon fill="black" points="381.5,-267.607 378,-257.607 374.5,-267.607 381.5,-267.607" stroke="black"></polygon>
</g>
<!-- g2 -->
<g class="node" id="node3"><title>g2</title>
<path d="M174,-128.5C174,-128.5 582,-128.5 582,-128.5 588,-128.5 594,-134.5 594,-140.5 594,-140.5 594,-162.5 594,-162.5 594,-168.5 588,-174.5 582,-174.5 582,-174.5 174,-174.5 174,-174.5 168,-174.5 162,-168.5 162,-162.5 162,-162.5 162,-140.5 162,-140.5 162,-134.5 168,-128.5 174,-128.5" fill="none" stroke="grey"></path>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-159.3">Subject: google.com </text>
<polyline fill="none" points="162,-151.5 594,-151.5 " stroke="grey"></polyline>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-136.3">Issuer: Google Internet Authority G2 </text>
</g>
<!-- geotrust&#45;&gt;g2 -->
<g class="edge" id="edge3"><title>geotrust-&gt;g2</title>
<path d="M378,-211.366C378,-203.152 378,-193.658 378,-184.725" fill="none" stroke="black"></path>
<polygon fill="black" points="381.5,-184.607 378,-174.607 374.5,-184.607 381.5,-184.607" stroke="black"></polygon>
</g>
<!-- google_site -->
<g class="node" id="node4"><title>google_site</title>
<path d="M174,-55.5C174,-55.5 582,-55.5 582,-55.5 588,-55.5 594,-61.5 594,-67.5 594,-67.5 594,-79.5 594,-79.5 594,-85.5 588,-91.5 582,-91.5 582,-91.5 174,-91.5 174,-91.5 168,-91.5 162,-85.5 162,-79.5 162,-79.5 162,-67.5 162,-67.5 162,-61.5 168,-55.5 174,-55.5" fill="none" stroke="red"></path>
<text font-family="Times,serif" font-size="14.00" text-anchor="start" x="170" y="-69.8">www.google.com </text>
</g>
<!-- g2&#45;&gt;google_site -->
<g class="edge" id="edge4"><title>g2-&gt;google_site</title>
<path d="M378,-128.109C378,-119.981 378,-110.7 378,-102.171" fill="none" stroke="black"></path>
<polygon fill="black" points="381.5,-101.912 378,-91.9121 374.5,-101.912 381.5,-101.912" stroke="black"></polygon>
</g>
<!-- root -->
<g class="node" id="node5"><title>root</title>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="72" y="-313.8">root</text>
</g>
<!-- root&#45;&gt;equifax -->
<g class="edge" id="edge2"><title>root-&gt;equifax</title>
<path d="M144.018,-317.5C148.288,-317.5 152.558,-317.5 156.828,-317.5" fill="none" stroke="black"></path>
<polygon fill="black" points="156.84,-319.25 161.84,-317.5 156.84,-315.75 156.84,-319.25" stroke="black"></polygon>
</g>
<!-- leaf -->
<g class="node" id="node6"><title>leaf</title>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="72" y="-69.8">leaf</text>
</g>
<!-- leaf&#45;&gt;google_site -->
<g class="edge" id="edge5"><title>leaf-&gt;google_site</title>
<path d="M144.018,-73.5C148.288,-73.5 152.558,-73.5 156.828,-73.5" fill="none" stroke="black"></path>
<polygon fill="black" points="156.84,-75.2501 161.84,-73.5 156.84,-71.7501 156.84,-75.2501" stroke="black"></polygon>
</g>
<!-- 0 -->
<g class="node" id="node7"><title>0</title>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="648" y="-147.8">0</text>
</g>
<!-- 1 -->
<g class="node" id="node8"><title>1</title>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="648" y="-230.8">1</text>
</g>
<!-- 2 -->
<g class="node" id="node9"><title>2</title>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="648" y="-313.8">2</text>
</g>
</g>
</svg>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First of all you'll notice that there has been some problem regarding the validation:</p>
<pre><code>verify error:num=20:unable to get local issuer certificate

</code></pre>
<p>This has to do with the fact that <code>openssl</code> doesn't provide a list of trusted certs by default. You'll have to specify it manually:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash 
openssl s_client -showcerts -connect www.google.com:443 -CApath /etc/ssl/certs 2&gt; /dev/null <span class="p">|</span> grep <span class="s2">"Verify"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">    Verify return code: 0 (ok)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok, so that looks much better. Now let's <strong>verify</strong> the chain:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash 
openssl verify -CApath /etc/ssl/certs /tmp/pyopenssl/www.google.com.pem <span class="p">|</span> grep <span class="s2">"error"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">error 20 at 0 depth lookup:unable to get local issuer certificate
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hmm...Strange error message, even though I've specified the path where to lookup the certs. Another try:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt /tmp/pyopenssl/www.google.com.pem <span class="p">|</span> grep <span class="s2">"error"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">error 20 at 0 depth lookup:unable to get local issuer certificate
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Strange! After some Googling, I've found <a href="http://goobbe.com/questions/4022708/how-to-verify-certificate-chain-with-openssl">this</a>. So let's give it another try:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt <span class="se">\</span>
       -untrusted /tmp/pyopenssl/www.google.com.pem /tmp/pyopenssl/www.google.com.pem <span class="p">|</span> grep <span class="s2">"error"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">error 20 at 0 depth lookup:unable to get local issuer certificate
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>If you have any ideas how to solve this, just drop me a line!</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="6988aab4de844bedbe7984c3e74c1cc2">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Certificate pinning</strong> is a useful step towards authenticity verfication of a X.509 certificate. Keep in mind that <strong>MITM</strong> attacks are no rarity anymore and should be always be taken into consideration. Do <strong>not</strong> just validate the certificate. Make sure it is the one you've been <strong>expecting</strong> while connecting to your site/SSL-backend. Use <strong>fingerprints</strong> (in general <strong>digests</strong>) which you can always compute on the <strong>presented</strong> information and compare it against an expected value.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5cd6478416b226b632eb44888361e8d8">References<a class="anchor-link" href="#References">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="http://www.artur-rodrigues.com/tech/2013/08/19/verifying-x509-signatures-in-python.html">Verifying x509 signatures in Python</a></li>
<li><a href="http://stackoverflow.com/questions/7689941/how-can-i-retrieve-the-tls-ssl-peer-certificate-of-a-remote-host-using-python">How can I retrieve the TLS/SSL peer certificate of a remote host using python?</a></li>
<li><a href="https://www.ietf.org/rfc/rfc3280.txt">Internet X.509 Public Key Infrastructure</a></li>
<li><a href="http://stackoverflow.com/questions/27599985/verify-errorcode-20-unable-to-get-local-issuer-certificate/27606964#27606964">Verify errorcode = 20 : unable to get local issuer certificate</a></li>
</ul>
</div>
</div>
</div></p>
                </div>
<hr/>
<div style="float:left;">
	Prev: <a href="http://blog.dornea.nu/2015/05/06/adding-concurrency-to-smalisca" align='left'>
	 Adding concurrency to smalisca
	</a>
</div>
<div style="float:right;">
    Next: <a href="http://blog.dornea.nu/2015/06/03/usd-ag-hacker-day-in-hamburg" align='right'>
	 usd AG Hacker Day in Hamburg
	</a>
</div>
</p>

                <!-- Add comments -->
<div id="content-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname="dorneanu";
				var disqus_identifier = 'validating-and-pinning-x509-certificates';
			var disqus_url = 'http://blog.dornea.nu/2015/05/24/validating-and-pinning-x509-certificates';

		var disqus_config = function () {
			this.language = "en";
		};
 
        
        (function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
            </div>
            <div class="niu2-right-container col-md-2">
                <div id="niu2-sidebar-meta" class="niu2-sidebar">
                    <div class="niu2-sidebar-label"><i class="icon-calendar"></i>Published:</div>
                    <div class="niu2-sidebar-value">2015-05-24 00:00</div>
                    <div class="niu2-sidebar-label"><i class="icon-pencil"></i>category:</div>
                    <div class="niu2-sidebar-value"><a href="http://blog.dornea.nu/category/blog">blog</a></div>
                    <div class="niu2-sidebar-label"><i class="icon-tag"></i>Tag:</div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/python/">python</a><sup>26</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/coding/">coding</a><sup>26</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/ipython/">ipython</a><sup>16</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/ssl/">ssl</a><sup>6</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/x509/">x.509</a><sup>3</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/tls/">tls</a><sup>6</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/crypto/">crypto</a><sup>19</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/openssl/">openssl</a><sup>8</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/appsec/">appsec</a><sup>25</sup></div>
                </div>

                <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
                    <div class="niu2-sidebar-label">
                        <i id="niu2-sidebar-toc-ctrl" class="icon-open-tocs"></i>Table of contents
                    </div>
                    <ul id="niu2-sidebar-toc-list">
                        <li><a href="#content-heading">Validating and pinning X.509 certificates</a></li>
                        <li><a href='#aecf981176c1700646d09f448cb429e3'>What is it?¶</a></li><li><a href='#ee07f188d5803e5756ab1e271dc04ec6'>Inside the certificate¶</a><ul><li><a href='#a54237ff28b269dcfbc09717c8ab62c1'>Connection settings¶</a></li><li><a href='#8ec66ba8eaf0e99b05a99885ddb90da0'>Make connection¶</a></li><li><a href='#0e7818eae6d2cf9711fed86f846ce554'>Fetch the certificate¶</a><ul><li><a href='#0a43ce513d6dfba3f3363e584c036791'>PEM format¶</a></li><li><a href='#949e76819544dd5261b7fbb6746be5ba'>TEXT format¶</a></li></ul></li></ul></li><li><a href='#edb6be217da69094167d4c5f83a48a56'>Certificate pinning¶</a><ul><li><a href='#9041f342bf6ef5c36e062b9bf83b3c03'>Pin the certificate¶</a></li><li><a href='#e4d97fb09fcb2e7fbc720ab492d0a75b'>Pin the public key¶</a></li></ul></li><li><a href='#2fe7927bb0f69c27bca4ad2761afbcac'>Validate certificate¶</a></li><li><a href='#6988aab4de844bedbe7984c3e74c1cc2'>Conclusion¶</a><ul><li><a href='#5cd6478416b226b632eb44888361e8d8'>References¶</a></li></ul></li>
                        <li><a href="#content-comments">Comments</a></li>
                    </ul>
                </div>
            </div>
            <div id="niu2-toolbar">
                <ul class="list-unstyled">
                    <li><a id="niu2-toolbar-ctrlsidebar" href="#" title="Hide Sidebar"><i class="icon-3x icon-hide-sidebar"></i></a></li>
                </ul>
                <div id="niu2-toolbar-showsidebar" data-title="Show Sidebar"></div>
                <div id="niu2-toolbar-github" data-repo=""></div>
                <div id="niu2-toolbar-bitbucket" data-repo=""></div>
            </div>
            <div id="niu2-toc" data-style="fixed"></div>
        </div>

        <div class="niu2-footer">
            <div id="body-footer" class="col-md-6 col-md-offset-2">
                <hr/>
                <p>
                    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
                    <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="https://github.com/twbs/bootstrap">Bootstrap3</a>
                    by <a href="https://blog.mawenbao.com">Ma Wenbao</a>, icons by 
                    <a href="https://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
                </p>
                <p>
                    © 2008 - 2016
                    <a class="niu2-footer-link" href="http://blog.dornea.nu">Victor Dorneanu</a>
                </p>
                <p class="niu2-icons">
                    <a class="niu2-footer-icon" href="https://pgp.mit.edu/pks/lookup?op=get&search=0x18F1AD46FB05E1B7" title="my public key">
                        <i class="icon-key icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="mailto: no-spam ÄATT dornea DOT nu" title="my email address">
                        <i class="icon-envelope-o icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="http://github.com/dorneanu" title="my github page">
                        <i class="icon-github-alt icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="/feeds/rss.xml" title="subscribe my blog">
                        <i class="icon-rss icon-lg"></i>
                    </a>
                </p>
            </div>
        </div>

        <script type="text/javascript">
            var _gaq=_gaq||[];
            _gaq.push(["_setAccount","UA-7161767-3"]);
            _gaq.push(["_trackPageview"]);
            (function(){
                var b=document.createElement("script");
                b.type="text/javascript";
                b.async=true;
                b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";
                var a=document.getElementsByTagName("script")[0];
                a.parentNode.insertBefore(b,a)
            })();
        </script>
        <div id="niu2-pygments" data-theme="github"></div>
        <div id="niu2-lazy-load" data-loading-txt="Loading image" data-loading-icon="icon-spin icon-spinner"></div>
        <div id="niu2-toolbar-load" data-loading-icon="icon-spin icon-4x icon-spinner"></div>
        <script type="text/javascript" src="/js/custom.js"></script>
        <script type="text/javascript">
            onContentLoaded();
        </script>
    </body>
</html>