<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Debugging Android native shared libraries - blog.dornea.nu</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

/*some stuff for output/input prompts*/
div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
@media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
div.prompt:empty{padding-top:0;padding-bottom:0}
div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
div.inner_cell{width:90%;}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
div.output_prompt{color:darkred;}

a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
/* end stuff for output/input prompts*/


.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}
</style>

<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>

<link rel="canonical" href="http://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries">

        <meta name="author" content="Victor Dorneanu" />
        <meta name="keywords" content="ipython,hacking,security,android,python,mobile,appsec" />
        <meta name="description" content="Since I haven&#39;t done this before, I thought I could share some experiences with you. All this began during some APK analysis which was heavily using JNIs. In my particular case Java Native Interfaces were used to call functions inside libraries written in C/C++. At that time ..." />

        <meta property="og:site_name" content="blog.dornea.nu" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Debugging Android native shared libraries"/>
        <meta property="og:url" content="http://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries"/>
        <meta property="og:description" content="Since I haven&#39;t done this before, I thought I could share some experiences with you. All this began during some APK analysis which was heavily using JNIs. In my particular case Java Native Interfaces were used to call functions inside libraries written in C/C++. At that time ..."/>
        <meta property="article:published_time" content="2015-07-01" />
            <meta property="article:section" content="blog" />
            <meta property="article:tag" content="ipython" />
            <meta property="article:tag" content="hacking" />
            <meta property="article:tag" content="security" />
            <meta property="article:tag" content="android" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="mobile" />
            <meta property="article:tag" content="appsec" />
            <meta property="article:author" content="Victor Dorneanu" />

    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@victordorneanu">
        <meta name="twitter:creator" content="@victordorneanu">
    <meta name="twitter:domain" content="http://blog.dornea.nu">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.spacelab.min.css" type="text/css"/>
    <link href="http://blog.dornea.nu/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.dornea.nu/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/style.css" type="text/css"/>

        <link href="http://blog.dornea.nu/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="blog.dornea.nu ATOM Feed"/>




</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.dornea.nu/" class="navbar-brand">
blog.dornea.nu            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/archives">Archives</a></li>
                    <li><a href="http://dornea.nu">About</a></li>
                         <li><a href="http://blog.dornea.nu/pages/books">
                             Books
                          </a></li>
                        <li class="active">
                            <a href="http://blog.dornea.nu/category/blog">Blog</a>
                        </li>
                        <li >
                            <a href="http://blog.dornea.nu/category/notes">Notes</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://blog.dornea.nu/archives"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="http://blog.dornea.nu" title="blog.dornea.nu"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="http://blog.dornea.nu/category/blog" title="blog">blog</a></li>
                <li class="active">Debugging Android native shared libraries</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries"
                       rel="bookmark"
                       title="Permalink to Debugging Android native shared libraries">
                        Debugging Android native shared libraries
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-07-01T00:00:00+02:00"> Wed 01 July 2015</time>
    </span>



        <span class="label label-default">Category</span>
        <a href="http://blog.dornea.nu/category/blog">blog</a>


<span class="label label-default">Tags</span>
	<a href="http://blog.dornea.nu/tag/ipython/">ipython</a>
        /
	<a href="http://blog.dornea.nu/tag/hacking/">hacking</a>
        /
	<a href="http://blog.dornea.nu/tag/security/">security</a>
        /
	<a href="http://blog.dornea.nu/tag/android/">android</a>
        /
	<a href="http://blog.dornea.nu/tag/python/">python</a>
        /
	<a href="http://blog.dornea.nu/tag/mobile/">mobile</a>
        /
	<a href="http://blog.dornea.nu/tag/appsec/">appsec</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since I haven&#39;t done this before, I thought I could share some experiences with you. All this began during some APK analysis which was heavily using <a href="https://en.wikipedia.org/wiki/Java_Native_Interface">JNI</a>s. In my particular case <em>Java Native Interfaces</em> were used to call functions inside libraries written in C/C++. At that time I was quite unfamiliar with JNIs and how they actually work. Besides that I haven&#39;t debugged any native applications/libraries on Android before. So this was the perfect opportunity to have a closer look at <a href="https://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a> and its debugging features.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-Eclipse-project">Create Eclipse project<a class="anchor-link" href="#Create-Eclipse-project">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post I&#39;ll first create and build a <em>simple</em> Android project that includes native code using the <strong>JNI</strong>. As a main source I have used this extraordinary <a href="http://blog.edwards-research.com/2012/04/tutorial-android-jni/">Android JNI tutorial</a> which I highly appreciate. Following the instructions described in the post, I have managed to successfully create an empty Android project (File -&gt; New -&gt; Project -&gt; Android Application Project) for my purposes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[28]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">tree</span> <span class="o">-</span><span class="n">L</span> <span class="mi">1</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">.
├── AndroidManifest.xml
├── assets
├── build.xml
├── ic_launcher-web.png
├── jni
├── res
└── src

4 directories, 3 files
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And in <code>src</code> we have following <strong>classes</strong>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[29]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%</span><span class="k">ls</span> <span class="o">-</span><span class="n">lR</span> <span class="n">src</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">jni_debug_demo</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">src/com/example/jni_debug_demo:
total 8
-rw-r--r-- 1 victor users 1183 Jun 30 16:44 MainActivity.java
-rw-r--r-- 1 victor users  471 Jun 30 16:44 SquaredWrapper.java
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-Android-project">Create Android project<a class="anchor-link" href="#Create-Android-project">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to be able to build the APK, you&#39;ll have to create a new Android project:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[30]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">victor</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">android</span> <span class="n">update</span> <span class="n">project</span> <span class="o">--</span><span class="n">target</span> <span class="n">android</span><span class="o">-</span><span class="mi">19</span> <span class="o">-</span><span class="n">p</span> <span class="o">.</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Updated and renamed default.properties to project.properties
Updated local.properties
Added file ./proguard-project.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you should be able to <strong>build</strong> the project and also generate the <strong>APK</strong>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[31]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">ant</span> <span class="n">clean</span> <span class="n">release</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">BUILD</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">BUILD SUCCESSFUL
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Add-JNI-functionalities">Add JNI functionalities<a class="anchor-link" href="#Add-JNI-functionalities">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have the base Android project, let&#39;s add some <strong>JNI</strong> functionalities to the project. To compile the shared library (using gcc/g++) we&#39;ll need a valid C <strong>header</strong> which can be computed from <em>SquaredWrapper</em> (class used in previously mentioned tutorial).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="C-header">C header<a class="anchor-link" href="#C-header">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The compiled classes are now in &quot;<code>./bin/classes</code>&quot;. Let&#39;s generate the <strong>header</strong> files for <code>SquaredWrapper</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[37]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">javah</span> <span class="o">-</span><span class="n">jni</span> <span class="o">-</span><span class="n">classpath</span> <span class="o">~/</span><span class="n">work</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">platforms</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="mi">19</span><span class="o">/</span><span class="n">android</span><span class="o">.</span><span class="n">jar</span><span class="p">:</span><span class="o">./</span><span class="nb">bin</span><span class="o">/</span><span class="n">classes</span> <span class="o">-</span><span class="n">o</span> <span class="n">square</span><span class="o">.</span><span class="n">h</span> <span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">jni_debug_demo</span><span class="o">.</span><span class="n">SquaredWrapper</span>
<span class="n">cat</span> <span class="n">square</span><span class="o">.</span><span class="n">h</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">/* DO NOT EDIT THIS FILE - it is machine generated */
#include &lt;jni.h&gt;
/* Header for class com_example_jni_debug_demo_SquaredWrapper */

#ifndef _Included_com_example_jni_debug_demo_SquaredWrapper
#define _Included_com_example_jni_debug_demo_SquaredWrapper
#ifdef __cplusplus
extern &quot;C&quot; {
#endif
/*
 * Class:     com_example_jni_debug_demo_SquaredWrapper
 * Method:    squared
 * Signature: (I)I
 */
JNIEXPORT jint JNICALL Java_com_example_jni_1debug_1demo_SquaredWrapper_squared
  (JNIEnv *, jclass, jint);

#ifdef __cplusplus
}
#endif
#endif
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So there is a function <strong>Java_com_example_jni_1debug_1demo_SquaredWrapper_squared</strong> (pay attention to the naming convention) which has 3 arguments. I won&#39;t discuss this further and I&#39;ll simple copy the file into a new folder <code>jni</code> inside the project:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[38]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">mkdir</span> <span class="n">jni</span>
<span class="n">mv</span> <span class="n">square</span><span class="o">.</span><span class="n">h</span> <span class="n">jni</span><span class="o">/</span>
</pre></div>

</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="C-source">C source<a class="anchor-link" href="#C-source">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have the <strong>function definition</strong> and the prototype generated by <code>javah</code> we can easily implement the <strong>C source</strong> as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[39]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%</span><span class="k">cat</span> <span class="n">jni</span><span class="o">/</span><span class="n">square</span><span class="o">.</span><span class="n">c</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">#include &quot;square.h&quot;
 
JNIEXPORT jint JNICALL Java_com_example_jni_1debug_1demo_SquaredWrapper_squared (JNIEnv * je, jclass jc, jint base)
{
    return (base*base);
}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So nothing special about it. Due to the introductory aspect of this post I&#39;ll try to keep things simple. You can of course go further and implement more complex functions. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Build-the-library">Build the library<a class="anchor-link" href="#Build-the-library">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a <strong>Makefile</strong> for all the Android build tools. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[40]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%</span><span class="k">cat</span> <span class="n">jni</span><span class="o">/</span><span class="n">Android</span><span class="o">.</span><span class="n">mk</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">LOCAL_PATH := $(call my-dir)
 
include $(CLEAR_VARS)

LOCAL_LDLIBS := -llog

LOCAL_MODULE    := squared
LOCAL_SRC_FILES := square.c
 
include $(BUILD_SHARED_LIBRARY)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now <strong>build</strong> the library (remember to set the <em>NDK_DEBUG</em> flag otherwise you won&#39;t be able to debug your native code):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[41]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">NDK_DEBUG</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">victor</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">ndk</span><span class="o">-</span><span class="n">r10e</span><span class="o">/</span><span class="n">ndk</span><span class="o">-</span><span class="n">build</span> 
<span class="n">readelf</span> <span class="o">-</span><span class="n">h</span> <span class="n">libs</span><span class="o">/</span><span class="n">armeabi</span><span class="o">/</span><span class="n">libsquared</span><span class="o">.</span><span class="n">so</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Android NDK: WARNING: APP_PLATFORM android-19 is larger than android:minSdkVersion 16 in ./AndroidManifest.xml    
[armeabi] Gdbserver      : [arm-linux-androideabi-4.8] libs/armeabi/gdbserver
[armeabi] Gdbsetup       : libs/armeabi/gdb.setup
[armeabi] Compile thumb  : squared &lt;= square.c
[armeabi] SharedLibrary  : libsquared.so
[armeabi] Install        : libsquared.so =&gt; libs/armeabi/libsquared.so
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2&apos;s complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              DYN (Shared object file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          52 (bytes into file)
  Start of section headers:          12564 (bytes into file)
  Flags:                             0x5000000, Version5 EABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           40 (bytes)
  Number of section headers:         21
  Section header string table index: 20
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Call-the-library">Call the library<a class="anchor-link" href="#Call-the-library">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <code>MainActivity</code> some static routines of the class <code>SquaredWrapper</code> are being called:</p>
<pre><code class="language-.java"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="id">MainActivity</span> <span class="id">extends</span> <span class="id">Activity</span> {</span>
    <span class="keyword">private</span> EditText etInput;
    <span class="keyword">private</span> TextView txtTo2;
    <span class="keyword">private</span> TextView txtTo4;

    @Override
    <span class="keyword">protected</span> <span class="keyword">void</span> onCreate(Bundle savedInstanceState) {
        <span class="keyword">super</span><span class="variable">.onCreate</span>(savedInstanceState);
        setContentView(R<span class="variable">.layout</span><span class="variable">.activity_main</span>);

        <span class="comment">// Define Input EditText, TextViews</span>
        etInput = (EditText) findViewById(R<span class="variable">.id</span><span class="variable">.etInput</span>);
        txtTo2 =  (TextView) findViewById(R<span class="variable">.id</span><span class="variable">.resTo2</span>);
        txtTo4 =  (TextView) findViewById(R<span class="variable">.id</span><span class="variable">.resTo4</span>);

        <span class="keyword">int</span> b = <span class="number">3</span>;
        <span class="keyword">int</span> a = SquaredWrapper<span class="variable">.to4</span>(b);
        Log<span class="variable">.i</span>(<span class="string">"JNIDemo"</span>, String<span class="variable">.format</span>(<span class="string">"%d-&gt;%d"</span>, b,a));
    }

    <span class="keyword">public</span> <span class="keyword">void</span> cbCalculate(View view) {
        <span class="keyword">int</span> in = <span class="number">0</span>;
        <span class="keyword">try</span>{
            in = Integer<span class="variable">.valueOf</span>( etInput<span class="variable">.getText</span>()<span class="variable">.toString</span>() );
        } <span class="keyword">catch</span>(NumberFormatException e) { 
            <span class="keyword">return</span> ; 
        }

        txtTo2<span class="variable">.setText</span>(String<span class="variable">.format</span>(<span class="string">"%d"</span>, SquaredWrapper<span class="variable">.squared</span>(in)));
        txtTo4<span class="variable">.setText</span>(String<span class="variable">.format</span>(<span class="string">"%d"</span>, SquaredWrapper<span class="variable">.to4</span>(in)));
    }
}
</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Build the project again:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[42]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">ant</span> <span class="n">clean</span> <span class="n">release</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">e</span> <span class="s">&quot;^BUILD&quot;</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">BUILD SUCCESSFUL
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-the-demo-application">Run the demo application<a class="anchor-link" href="#Run-the-demo-application">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First let&#39;s build the APK with <strong>debug</strong> enabled and sign it using a debug key:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[43]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">ant</span> <span class="n">clean</span> <span class="n">debug</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">e</span> <span class="s">&quot;^BUILD&quot;</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">BUILD SUCCESSFUL
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you can <strong>install</strong> <code>./bin/MainActivity-debug.apk</code> on your Android device (whether virtual or real)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[44]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">victor</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">platform</span><span class="o">-</span><span class="n">tools</span><span class="o">/</span><span class="n">adb</span> <span class="n">devices</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">List of devices attached 
0123456789ABCDEF	device

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[47]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">install</span> <span class="o">./</span><span class="nb">bin</span><span class="o">/</span><span class="n">MainActivity</span><span class="o">-</span><span class="n">debug</span><span class="o">.</span><span class="n">apk</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
	pkg: /data/local/tmp/MainActivity-debug.apk
Success
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[91]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="n">am</span> <span class="n">start</span> <span class="o">-</span><span class="n">n</span> <span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">jni_debug_demo</span><span class="o">/</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">jni_debug_demo</span><span class="o">.</span><span class="n">MainActivity</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
Starting: Intent { cmp=com.example.jni_debug_demo/.MainActivity }
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="http://dl.dornea.nu/img/2015/android-solib/a74f0e9adca736086c2834fb63c793ad.png" alt="JNI Debug Demo Application"></p>
<p>Greping for the <strong>logcat messages</strong> shows:</p>
<pre><code class="language-.shell"><span class="comment">$</span> <span class="comment">adb</span> <span class="comment">logcat</span> <span class="literal">-</span><span class="comment">s</span> <span class="comment">JNIDemo</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="comment">beginning</span> <span class="comment">of</span> <span class="comment">/dev/log/system</span>
<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="comment">beginning</span> <span class="comment">of</span> <span class="comment">/dev/log/main</span>
<span class="comment">I/JNIDemo</span> <span class="comment">(</span> <span class="comment">5524):</span> <span class="comment">3</span>-&gt;<span class="comment">81</span>
<span class="comment">I/JNIDemo</span> <span class="comment">(</span> <span class="comment">5524):</span> <span class="comment">3</span>-&gt;<span class="comment">81</span>
<span class="comment">I/JNIDemo</span> <span class="comment">(</span> <span class="comment">5524):</span> <span class="comment">3</span>-&gt;<span class="comment">81</span>
<span class="comment">^C
</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Debug-the-application">Debug the application<a class="anchor-link" href="#Debug-the-application">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the next steps a <strong>rooted</strong> device is <em>required</em>. Besides that you should install the <em>Android NDK</em> if you haven&#39;t done this yet. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Remount-/system-as-rw">Remount /system as rw<a class="anchor-link" href="#Remount-/system-as-rw">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First you&#39;ll have to <em>mount</em> <code>/system</code> with read-write rights:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[103]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">e</span> <span class="s">&quot;system&quot;</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">/emmc@android /system ext4 ro,seclabel,noatime,noauto_da_alloc,commit=1,data=ordered 0 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[49]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="s">&quot;su -c &#39;mount -o rw,remount /system&#39;&quot;</span>
</pre></div>

</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[50]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">e</span> <span class="s">&quot;system&quot;</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">/emmc@android /system ext4 rw,seclabel,relatime,noauto_da_alloc,commit=1,data=ordered 0 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Copy-gdbserver-to-device">Copy gdbserver to device<a class="anchor-link" href="#Copy-gdbserver-to-device">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you&#39;ll have to copy the <strong>gdbserver</strong> from the Android NDK into <code>/system/bin</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[100]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">find</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">victor</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">ndk</span><span class="o">-</span><span class="n">r10e</span><span class="o">/</span> <span class="o">-</span><span class="nb">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">name</span> <span class="s">&quot;gdbserver&quot;</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">/home/victor/work/android-ndk-r10e/prebuilt/android-mips/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-x86_64/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-arm64/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-x86/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-mips64/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-arm/gdbserver/gdbserver
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[107]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="n">cat</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">cpuinfo</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">e</span> <span class="s">&quot;Processor&quot;</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">Processor	: ARMv7 Processor rev 3 (v7l)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[52]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">push</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">victor</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">ndk</span><span class="o">-</span><span class="n">r10e</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">arm</span><span class="o">/</span><span class="n">gdbserver</span><span class="o">/</span><span class="n">gdbserver</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sdcard</span><span class="o">/</span><span class="n">tmp</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="s">&quot;su -c &#39;cp /mnt/sdcard/tmp/gdbserver /system/bin/&#39;&quot;</span>
</pre></div>

</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Copy-ARM-libraries-to-your-client">Copy ARM libraries to your client<a class="anchor-link" href="#Copy-ARM-libraries-to-your-client">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to be able to find debug information/symbols you&#39;ll need  all ARM libraries all your device/emulator to be copied to your PC. <code>gdb</code> will need them later on.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[12]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">mkdir</span> <span class="n">system_lib</span>
<span class="n">cd</span> <span class="n">system_lib</span>
<span class="n">adb</span> <span class="n">pull</span> <span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">lib</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>

</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Run-the-application">Run the application<a class="anchor-link" href="#Run-the-application">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[4]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="n">am</span> <span class="n">start</span> <span class="o">-</span><span class="n">n</span> <span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">jni_debug_demo</span><span class="o">/</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">jni_debug_demo</span><span class="o">.</span><span class="n">MainActivity</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
Starting: Intent { cmp=com.example.jni_debug_demo/.MainActivity }
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[5]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">adb</span> <span class="n">shell</span> <span class="n">ps</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">jni_debug_demo</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="ipynb">u0_a159   28054 135   554400 14484 ffffffff 00000000 S com.example.jni_debug_demo
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that the app is running we&#39;re ready to start the debugger and attach it to the process ID <em>28054</em>. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Attach-gdb-to-process">Attach gdb to process<a class="anchor-link" href="#Attach-gdb-to-process">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In project&#39;s root directory you&#39;ll run <code>ndk-gdb</code> which is part of the <em>Android NDK</em> package. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[10]:
</div>

<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%%</span><span class="k">bash</span>
<span class="n">ndk</span><span class="o">-</span><span class="n">gdb</span> <span class="o">--</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>

</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stderr">
<pre class="ipynb">warning: Could not load shared library symbols for 108 libraries, e.g. libstdc++.so.
Use the &quot;info sharedlibrary&quot; command to see the complete listing.
Do you need &quot;set solib-search-path&quot; or &quot;set sysroot&quot;?
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Without paying attention to the <em>warning</em> message, here are the steps <code>ndk-gdb</code> will do for you</p>
<ul>
<li>check if application is running</li>
<li>setup network redirection (port forwarding)</li>
</ul>
<pre><code>adb_cmd forward tcp:5039 localfilesystem:/data/data/com.example.jni_debug_demo/debug-socket
</code></pre><ul>
<li>pull several utilities (app_process, linker) from the device/emulator</li>
<li>start <code>gdb</code></li>
<li>attach to the process</li>
</ul>
<p>One could of course do all these steps <strong>manually</strong>. </p>
<p>1) Do port <em>forwarding</em>:</p>
<pre><code>$ adb forward tcp:1337 tcp:1337
</code></pre><p>1) Attach <code>gdbserver</code> to the process (on the device)</p>
<pre><code>root@Android:/ # ps | grep jni
u0_a159   28054 135   561056 14100 ffffffff 400a499c S com.example.jni_debug_demo
root@Android:/ # gdbserver :1337 --attach 28054                                
Attached; pid = 28054
Listening on port 1337
</code></pre><p>2) Connect gdb <code>client</code> to the server:</p>
<pre><code>$ /home/victor/work/android-ndk-r10e/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gdb
...
&gt; target remote :1337
...
</code></pre><p>But I still recommend using <code>ndk-gdb</code>. </p>
<h3 id="read-debugging-information">Read debugging information</h3>
<p>And now let&#39;s go back to the previously mentioned <code>warning</code> message:</p>
<pre><code>warning: Could not load shared library symbols for 108 libraries, e.g. libstdc++.so.
</code></pre><p><code>gdb</code> is telling us that it can&#39;t find any <strong>debugging symbols</strong> for the loaded (ARM) libraries. In that case we&#39;ll have to specify the <strong>path</strong> where it can find that information:</p>
<ul>
<li><code>system_lib</code>: contains all ARM libraries from the device (/system/lib)</li>
<li><code>obj/local/armeabi</code>: contains debugging information about <code>libsquared.so</code> (our target)</li>
</ul>
<pre><code>$ ndk-gdb --verbose
...
gef&gt; set solib-search-path system_lib/:obj/local/armeabi/
Reading symbols from system_lib/libc.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/libc.so
Reading symbols from system_lib/libstdc++.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/libstdc++.so
Reading symbols from system_lib/libm.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/libm.so
Reading symbols from system_lib/liblog.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/liblog.so
Reading symbols from system_lib/libcutils.so...(no debugging symbols found)...done.
...
</code></pre><p>You can now <strong>verify</strong> the debugging information via <code>info sharedlibrary</code>:</p>
<pre><code>gef&gt; info sharedlibrary
From        To          Syms Read   Shared Object Library
0x40053a80  0x400619e8  Yes (*)     /home/victor/workspace/jni_debug_demo/obj/local/armeabi/linker
0x4008c500  0x400d2e54  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libc.so
0x400f4828  0x400f49ec  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libstdc++.so
0x400f9940  0x4010d5b8  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libm.so
0x4007a190  0x4007bdf8  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/liblog.so
0x4006f6c8  0x40074ac4  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libcutils.so
0x4012eb1c  0x40131210  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libgccdemangle.so
0x40142bf0  0x40152a84  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libz.so
...
0x60b5bbe4  0x60b5d174  Yes         /home/victor/workspace/jni_debug_demo/obj/local/armeabi/libsquared.so
                        No          gralloc.mt6582.so
(*): Shared library is missing debugging information.
</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Find-target-function">Find target function<a class="anchor-link" href="#Find-target-function">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From last output you can see that <code>libsquared.so</code> starts at address <strong>0x60b5bbe4</strong>. Let&#39;s see what we can find there:</p>
<p><img src="http://dl.dornea.nu/img/2015/android-solib/b85df1e566b46ed748e315c3d4f043ed.png" alt="jni_debug_demo libsquared"></p>
<p>Bingo! So <code>Java_com_example_jni_1debug_1demo_SquaredWrapper_squared</code> starts at <strong>0x60b5bc28</strong>. We&#39;ll definitely set a <strong>breakpoint</strong> at that address:</p>
<pre><code class="language-.shell">gef&gt; b Java_com_example_jni_1debug_1demo_SquaredWrapper_squared
Breakpoint <span class="number">1</span> <span class="keyword">at</span> <span class="number">0x60b5bc40</span>: <span class="type">file</span> jni/square.c, line <span class="number">5.</span>
gef&gt;
</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Trigger-and-debug-function">Trigger and debug function<a class="anchor-link" href="#Trigger-and-debug-function">&#182;</a></h3>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the targeted function to be executed we&#39;ll have to trigger its execution by clicking on the &quot;Calculate&quot; button in the UI. <strong>Before</strong> doing that you should tell <code>gdb</code> to <em>continue</em> execution:</p>
<pre><code>gef&gt; continue
Continuing.
</code></pre><p>After having pressed the button in the UI, you should see sth similar to this:</p>
<pre><code>gef&gt; continue
Continuing.
--------------------------------------------------------------------------------[regs]
$r0    0x4187fe30 $r1    0x7a100019 $r2    0x00000008 $r3    0x578bbd18 
$r4    0x57c49258 $r5    0x41882860 $r6    0x00000004 $r7    0x578bbccc 
$r8    0xbed1e2a8 $r9    0x578bbcc4 $r10   0x41882870 $r11   0xbed1e2a4 
$r12   0x60b5bc28 $sp    0xbed1e290 $lr    0x418a1750 $pc    0x60b5bc40 

--------------------------------------------------------------------------------[stack]
0xbed1e290: 
0xbed1e294: 
0xbed1e298: 
0xbed1e29c: 
0xbed1e2a0: 
0xbed1e2a4: 
0xbed1e2a8: 
0xbed1e2ac: 
0xbed1e2b0: 
0xbed1e2b4: 
--------------------------------------------------------------------------------[code]
0x60b5bc2c       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+4&gt;:  add     r11, sp, #0
0x60b5bc30       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+8&gt;:  sub     sp, sp, #20
0x60b5bc34       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+12&gt;: str     r0, [r11, #-8]
0x60b5bc38       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+16&gt;: str     r1, [r11, #-12]
0x60b5bc3c       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+20&gt;: str     r2, [r11, #-16]
0x60b5bc40       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+24&gt;: ldr     r3, [r11, #-16] &lt;&lt;= 
0x60b5bc44       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+28&gt;: ldr     r2, [r11, #-16]
0x60b5bc48       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+32&gt;: mul     r3, r2, r3
0x60b5bc4c       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+36&gt;: mov     r0, r3
0x60b5bc50       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+40&gt;: sub     sp, r11, #0
--------------------------------------------------------------------------------[trace]
#0  Java_com_example_jni_1debug_1demo_SquaredWrapper_squared (je=0x4187fe30, jc=0x7a100019, base=8) at jni/square.c:5
#1  0x418a1750 in ?? ()
Backtrace stopped: previous frame identical to this frame (corrupt stack?)

Breakpoint 1, Java_com_example_jni_1debug_1demo_SquaredWrapper_squared (je=0x4187fe30, jc=0x7a100019, base=8) at jni/square.c:5
5           return (base*base);
</code></pre><p>You can see that the execution currently stopped at <strong>0x60b5bc40</strong>. Now you can inspect the <em>registers</em>, set <em>additional</em> breakpoints, <em>step</em> into routines etc. </p>
<p><img src="http://dl.dornea.nu/img/2015/android-solib/1c34d2da522b2a450b603cf8cd6a965a.png" alt="GDB GEF">
<img src="http://dl.dornea.nu/img/2015/android-solib/18d6146e96dbb21ceed498ae1cdd92f4.png" alt="GDB GEF"></p>
<p>At this point you should now be equipped with enough knowledge to dissect shared libraries and get some reverse engineering job done. Although this was a quite easy one due to the fact that we had debug symbols and were able to compile the library, the same techniques should also work on <em>stripped</em> binaries. In the post I&#39;ll some <em>binary analysis</em> on some random Android shared library using <a href="http://www.radare.org/r/">radare</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References">&#182;</a></h2>
</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="https://github.com/dorneanu/test/tree/master/jni_debug_demo">jni_debug_demo GitHub Project</a></li>
<li><a href="http://blog.edwards-research.com/2012/04/tutorial-android-jni/">Tutorial: Android JNI</a></li>
<li><a href="http://code.tutsplus.com/tutorials/advanced-android-getting-started-with-the-ndk--mobile-2152">Advanced Android: Getting started with the NDK</a></li>
<li><a href="https://tthtlc.wordpress.com/2012/09/19/how-to-do-remote-debugging-via-gdbserver-running-inside-the-android-phone/">How to do remote debugging via gdbserver running inside the Android phone?</a></li>
</ul>
</div>
</div>
</div></p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://blog.dornea.nu/2014/08/05/android-dynamic-code-analysis-mastering-droidbox">Android Dynamic Code Analysis - Mastering DroidBox</a></li>
        <li><a href="http://blog.dornea.nu/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis">Disect Android APKs like a Pro - Static code analysis</a></li>
        <li><a href="http://blog.dornea.nu/2014/01/23/24h-android-sniffing-using-tcpdump-ipython-notebook-version">24h Android sniffing using tcpdump - IPython Notebook Version</a></li>
        <li><a href="http://blog.dornea.nu/2014/09/12/howto-androguard-with-docker">HowTo: Androguard with Docker</a></li>
        <li><a href="http://blog.dornea.nu/2015/03/18/usd-ag-hacker-challenge-2015-solutions">usd AG Hacker challenge 2015 - Solutions</a></li>
    </ul>
</section>
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'dorneanu'; // required: replace example with your forum shortname

                    var disqus_identifier = 'debugging-android-native-shared-libraries';
                var disqus_url = 'http://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="http://twitter.com/DaanDebie"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
                <li class="list-group-item"><a href="http://www.linkedin.com/in/danieldebie"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
                <li class="list-group-item"><a href="http://github.com/DandyDev"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>

            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
                <ul class="list-group" id="recentposts">
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries">
                            Debugging Android native shared libraries
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/2015/06/22/decode-adobe-flex-amf-protocol">
                            Decode Adobe Flex AMF protocol
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/2015/06/03/usd-ag-hacker-day-in-hamburg">
                            usd AG Hacker Day in Hamburg
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/2015/05/24/validating-and-pinning-x509-certificates">
                            Validating and pinning X.509 certificates
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/2015/05/06/adding-concurrency-to-smalisca">
                            Adding concurrency to smalisca
                        </a>
                    </li>
                </ul>
            </li>

            <li class="list-group-item"><a href="http://blog.dornea.nu/"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
                <ul class="list-group" id="categories">
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/category/blog">
                            <i class="fa fa-folder-open fa-lg"></i> blog
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.dornea.nu/category/notes">
                            <i class="fa fa-folder-open fa-lg"></i> notes
                        </a>
                    </li>
                </ul>
            </li>

            <li class="list-group-item"><a href="http://blog.dornea.nu/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group " id="tags">
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/coding/">
                            coding
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/ipython/">
                            ipython
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/misc/">
                            misc
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/wtf/">
                            wtf
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/network/">
                            network
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/howto/">
                            howto
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/hacking/">
                            hacking
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/security/">
                            security
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/mobile/">
                            mobile
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/web/">
                            web
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/android/">
                            android
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.dornea.nu/tag/low/">
                            low
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.dornea.nu/tag/wargames/">
                            wargames
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.dornea.nu/tag/uncategorized/">
                            uncategorized
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.dornea.nu/tag/appsec/">
                            appsec
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.dornea.nu/tag/python/">
                            python
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.dornea.nu/tag/note/">
                            note
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.dornea.nu/tag/virtualization/">
                            virtualization
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/networking/">
                            networking
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/re/">
                            re
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/fakebanker/">
                            fakebanker
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/events/">
                            events
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/blog/">
                            blog
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/pelican/">
                            pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/c/">
                            c
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/programming/">
                            programming
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/ios/">
                            ios
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/graphviz/">
                            graphviz
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/sca/">
                            sca
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/java/">
                            java
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/burp/">
                            burp
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/crypto/">
                            crypto
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/code/">
                            code
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/books/">
                            books
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://blog.dornea.nu/tag/androguard/">
                            androguard
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/infosec/">
                            infosec
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/jquery/">
                            jquery
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/eclipse/">
                            eclipse
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/linux/">
                            linux
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/tls/">
                            tls
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/openssl/">
                            openssl
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/docker/">
                            docker
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/whatsapp/">
                            whatsapp
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/viz/">
                            viz
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/javascript/">
                            javascript
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/apple/">
                            apple
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/cryptography/">
                            cryptography
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/pandoc/">
                            pandoc
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/smalisca/">
                            smalisca
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/ssl/">
                            ssl
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/droidbox/">
                            droidbox
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/adobe/">
                            adobe
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/debug/">
                            debug
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/flash/">
                            flash
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/iptables/">
                            iptables
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/octopress/">
                            octopress
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/science/">
                            science
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/blockdiag/">
                            blockdiag
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.dornea.nu/tag/x509/">
                            x509
                        </a>
                    </li>
                </ul>
            </li>



    <li class="list-group-item"><h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </li>

    <li class="list-group-item"><h4><i class="fa fa-twitter fa-lg"></i><span class="icon-label">Latest Tweets</span></h4></li>
    <div id="twitter_timeline">
        <a class="twitter-timeline" data-chrome="noheader" href="https://twitter.com/victordorneanu" data-widget-id="468295751982784514">Tweets by victordorneanu</a>
    </div>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://dornea.nu/" target="_blank">
                dornea.nu
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://nullsecurity.net" target="_blank">
                nullsecurity.net
            </a>
        </li>
        <li class="list-group-item">
            <a href="https://github.com/dorneanu" target="_blank">
                github.com/dorneanu
            </a>
        </li>
        <li class="list-group-item">
            <a href="https://github.com/nullsecurity" target="_blank">
                github.com/nullsecurity
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Victor Dorneanu
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.dornea.nu/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>

    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://blog.dornea.nu/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'dorneanu',
                count: 5,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://blog.dornea.nu/theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'dorneanu'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-7161767-3']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-559fc4045bb79811"></script>
</body>
</html>