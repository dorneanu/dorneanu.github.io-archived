<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="coding, howto, security, web, appsec, burp, python, java">
        <meta name="description" content="I really love Burp. Since I use it on a daily basis I thought there might be some way to automate it. Usually I mainly do these steps to scan some URL: Define scope Start manual exploring OR spider the URL in order to get some target map Activate passive ...">
        <title>HowTo: Automate Burp using Burp Extender API - blog.dornea.nu</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
        <link rel="stylesheet" href="/css/ipython.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/font-icons/style.min.css" type="text/css" />
        <link rel="stylesheet" href="http://blog.dornea.nu/theme/css/niu2.min.css" type="text/css" />
        <link rel="stylesheet" href="/css/custom.css" type="text/css" />
		
        
        <link rel="canonical" href="http://blog.dornea.nu/2013/08/02/howto-automate-burp-using-burp-extender-api" />
        <script type="text/javascript">window.onload=function(){};</script>
        <!--[if lt IE 9]>
            <script src="http://blog.dornea.nu/theme/js/html5shiv.js"></script>
            <script src="http://blog.dornea.nu/theme/js/respond.min.js"></script>
        <![endif]-->
    </head>
    <body> 
        <div id="body-header">
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="col-md-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://blog.dornea.nu">
                            <i class="icon-home"></i>blog.dornea.nu
                        </a>
                    </div>
                    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="http://dornea.nu" title="about">
                                <i class="icon-user"></i>about</a>
                            </li>
                            <li><a href="/archives.html" title="archives">
                                <i class="icon-archive"></i>archives</a>
                            </li>
                            <li><a href="/tags.html" title="tags">
                                <i class="icon-tag"></i>tags</a>
                            </li>
                            <li><a href="/feeds/rss.xml" title="feeds">
                                <i class="icon-rss"></i>feeds</a>
                            </li>
                        <!-- category dropdown list -->
                        <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="icon-folder-open"></i>category<b class="caret"></b>
                           </a>
                           <ul class="dropdown-menu">
                               <li><a href="http://blog.dornea.nu/category/blog">
                                      <i class="icon-pencil"></i>blog
                                      (105)</a></li>
                               <li><a href="http://blog.dornea.nu/category/low">
                                   <i class="icon-folder-close"></i>LOW
                                      (27)</a></li>
                               <li><a href="http://blog.dornea.nu/category/notes">
                                      <i class="icon-book"></i>notes
                                      (19)</a></li>
                           </ul>
                        </li>
                        <!--  self defined dropdown list -->
                        </ul>
                        
                        <!-- right nav bar -->
                        <ul class="nav navbar-nav navbar-right">
                        <!-- google custom search -->
                        <li>
                        <div id="niu2-cse-wrapper">
                            <div id="niu2-cse-header-box" class="navbar-form navbar-nav">
                                <form action="http://google.com/cse">
                                    <input type="hidden" name="cx" value="008508447409818574933:pxyxuhrgnxi" />
                                    <input type="hidden" name="ie" value="UTF-8" />
                                    <div class="form-group">
                                        <input id="niu2-cse-search-input" class="niu2-cse-header form-control" 
                                            type="text" name="q" 
                                            placeholder="Press enter to search ..."/>
                                    </div>
                                </form>
                           </div>
                           <div id="niu2-cse-ctrl-box" class="navbar-nav">
                            <i id="niu2-cse-search-image" class="icon-search navbar-nav"></i><span id="niu2-cse-search-text">Search</span>
                           </div>
                       </div>
                       </li>
                       </ul>
                    </nav>
                </div>
            </div>
<style>
    #banner{
        background-image:url("http://blog.dornea.nu//images/header.jpg");
    }   
</style>

<div id="banner">
    <div class="container">
        <div class="copy">
            <h2>blog.dornea.nu</h2>
                <p class="intro">Hack, code and drink some țuică. Personal blog of Victor Dorneanu.</p>
        </div>
    </div>
</div>
            <!-- End Banner -->
        </div>

        <div id="body-content">
            <div class="col-md-8 col-md-offset-2">
                <h1 id="content-heading">HowTo: Automate Burp using Burp Extender API</h1>
            </div>
            <div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
                <div id="niu2-main-content">
                    <p>I really love <a href="http://portswigger.net/burp/">Burp</a>. Since I use it on a daily basis I thought there might be some way to automate it. Usually I mainly do these steps to scan some URL:</p>
<ol>
<li>Define scope</li>
<li>Start manual exploring OR spider the URL in order to get some target map</li>
<li>Activate passive scanning</li>
<li>Activate live scanning</li>
<li>Wait to the scan to finish</li>
<li>Have a look at the results</li>
<li>Save/export the results</li>
</ol>
<p>Well these are a lot of steps which have to be done manually. We all know that necessity is the mother of invention so I've started looking for some concepts how to automate those steps. This is what I've found...  </p>
<h2 id="5a2ebfb8baa378cfcfcba58bbb1380c2">Requirements</h2>
<p>Before I've started googling for some code I've collected some requirements which <em>should</em> be fulfilled:</p>
<ul>
<li>Functional <ul>
<li>Ability to communicate with Burp using some API</li>
<li>Control Burp by command line</li>
<li>Interact with Burp through some console</li>
<li>Tamper requests before being sent in the wild</li>
<li>Create events in order to trigger specific actions</li>
</ul>
</li>
<li>Technical <ul>
<li>OS independent (should at least work on Linux and Windows)</li>
<li>Extendibility: Use your favourite programming language (Python, Java whatever) to interact with the API</li>
</ul>
</li>
<li>Reportings <ul>
<li>Ability to create/generate/export results as XML, CSV, whatever.</li>
</ul>
</li>
</ul>
<p>Having this written I've started googling.</p>
<h1 id="c4f9ec482073794b20393974fe4409c2">Google found...</h1>
<ul>
<li><a href="http://portswigger.net/burp/help/extender.html">Burp Extender API</a></li>
</ul>
<blockquote>
<p><p style="padding-left: 60px;">
  Burp Extender lets you load Burp extensions, to extend Burp's functionality using your own or third-party code.
</p></p>
<p><p style="padding-left: 60px;">
  Burp extensions can customize Burp's behavior in numerous ways, such as modifying HTTP requests and responses, customizing the UI, adding custom Scanner checks, and accessing key runtime information, including the <a href="http://portswigger.net/burp/help/proxy_history.html">Proxy history</a>, <a href="http://portswigger.net/burp/help/target_sitemap.html">Target site map</a> and <a href="http://portswigger.net/burp/help/scanner_results.html">Scanner results</a>. (Source: <a href="http://portswigger.net/burp/help/extender.html">http://portswigger.net/burp/help/extender.html</a>)
</p></p>
</blockquote>
<ul>
<li><a href="https://github.com/GDSSecurity/burpee">GDS Burp API</a></li>
</ul>
<blockquote>
<p><p class="crayon-selected" style="padding-left: 60px;">
  The GDS Burp API exposes a Python object interface to requests/responses recorded by Burp (whether Proxy/Spider/Repeater, etc). The API is used to parse Burp logs, creating a list of Burp objects that contain the request and response data and related meta-data. (Source: <a href="https://github.com/GDSSecurity/burpee">https://github.com/GDSSecurity/burpee</a>)
</p></p>
</blockquote>
<ul>
<li><a href="https://github.com/mwielgoszewski/jython-burp-api">Jython Burp API</a></li>
</ul>
<blockquote>
<p><p style="padding-left: 60px;">
  Jython-Burp-API exposes a Jython interface to the popular Burp Suite web security testing tool, as an alternative to <a href="http://tduehr.github.com/buby/">Buby</a> for those testers who prefer Python over Ruby. (Souce: <a href="https://github.com/mwielgoszewski/jython-burp-api">https://github.com/mwielgoszewski/jython-burp-api)</a>
</p></p>
</blockquote>
<p>The Burp Extender API is the main component and plays a crucial role in automating burp. There are a lot of extension (Java, Python, Ruby) and you could easily write your <a href="http://blog.portswigger.net/2012/12/writing-your-first-burp-extension.html">own</a> one. As you might have noticed there are 3 main supported languages: Java, Ruby and Python. And because I love the pythonic way of life I had closer look at the Jython Burp API. As stated on the github page you can get a jython console to interact with Burp. That's crazy! And this was one of my main requirements.</p>
<h1 id="4e2419f34a9754a835ba2515de19d358">Jython Burp API</h1>
<p>First I've cloned the github repo and copied Burp into the<em> jython-burp-api </em>folder as described in the README.</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -l
total 13173
drwxr-xr-x <span class="m">3</span> vd vd     <span class="m">1024</span> 2013-07-31 14:50 custom-modules
drwxr-xr-x <span class="m">4</span> vd vd     <span class="m">1024</span> 2013-08-02 11:27 jython-burp-api-master
lrwxrwxrwx <span class="m">1</span> vd vd       <span class="m">28</span> 2013-07-31 14:19 jython.jar -&gt; jython-standalone-2.7-b1.jar
-rw-r--r-- <span class="m">1</span> vd vd <span class="m">13432713</span> 2013-07-31 13:49 jython-standalone-2.7-b1.jar
</pre></div>
<p>I <em>cd </em>into<em> jython-burp-api-master, </em>copied Burp into it and compiled the Burp Extender files:</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -l
total 9068
-rw-r--r-- <span class="m">1</span> vd vd    <span class="m">2087</span> 2013-05-13 20:27 burp.ini
-rwxr-x--- <span class="m">1</span> vd vd <span class="m">9225061</span> 2013-07-31 14:07 burpsuite_pro_v1.5.11.jar
drwxr-xr-x <span class="m">3</span> vd vd    <span class="m">1024</span> 2013-05-13 20:27 java
drwxr-xr-x <span class="m">3</span> vd vd    <span class="m">1024</span> 2013-07-31 15:39 Lib
-rw-r--r-- <span class="m">1</span> vd vd     <span class="m">739</span> 2013-05-13 20:27 LICENSE
-rw-r--r-- <span class="m">1</span> vd vd    <span class="m">6662</span> 2013-05-13 20:27 README.md
-rw-r--r-- <span class="m">1</span> vd vd    <span class="m">3592</span> 2013-07-31 15:30 run.py

<span class="nv">$ </span>javac -cp ../jython.jar java/src/*.java java/src/burp/*.java
</pre></div>
<p>Afterwards I tried to start Burp (as described in the README) using:</p>
<div class="highlight"><pre><span class="nv">$ </span>java -Xmx1g -jar ../jython.jar run.py -i -d -B burpsuite_pro_v1.5.11.jar
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"run.py"</span>, line 117, in &lt;module&gt;
    start_burp<span class="o">(</span>opt, *args<span class="o">)</span>
  File <span class="s2">"run.py"</span>, line 15, in start_burp
    from burp_extender import BurpExtender as MyBurpExtender, ConsoleThread
ImportError: No module named burp_extender
</pre></div>
<p>Hmmm.. Strange. I've created this <a href="https://github.com/mwielgoszewski/jython-burp-api/issues/7">issue</a> and informed the developer about the bug. Finally I was able to solve it by myself. The problem was that jython didn't know where to find the module <em>burp_extender. </em>So the class path had to be changed:</p>
<div class="highlight"><pre><span class="nv">$ </span>java -jar ../jython.jar -Dpython.path<span class="o">=</span>Lib/ run.py -B burpsuite_pro_v1.5.11.jar -i -d -v

Jython 2.7b1 <span class="o">(</span>default:ac42d59644e9, Feb <span class="m">9</span> 2013, 15:24:52<span class="o">)</span> 
<span class="o">[</span>OpenJDK 64-Bit Server VM <span class="o">(</span>Sun Microsystems Inc.<span class="o">)]</span> on java1.6.0_20
&gt;&gt;&gt; 
2013-08-02 11:39:08,582 - BurpExtender - DEBUG - Monitoring jython-burp-api-master/Lib/gds/burp/menu/console.py <span class="k">for</span> changes
2013-08-02 11:39:08,594 - BurpExtender - DEBUG - Monitoring jython-burp-api-master/burp.ini <span class="k">for</span> changes
<span class="nb">help</span>
&gt;&gt;&gt; Burp
&gt;&gt;&gt;
</pre></div>
<p>Ahh there we go! Now you should have Burp fired up and a jython console to interact with. Check out <a href="https://github.com/mwielgoszewski/jython-burp-api#examples">examples</a> for some commands.</p>
<h1 id="caea8340e2d186a540518d08602aa065">Automation</h1>
<p>Having this done the next step was to automate the scanning process. The jython console is very helpful but I somehow have to automate Burp with one command. Sth like:</p>
<div class="highlight"><pre><span class="nv">$ </span>java -jar ../jython.jar -Dpython.path<span class="o">=</span>Lib/  run.py -B burpsuite_pro_v1.5.11.jar --send-to-spider http://dornea.nu --add-to-scope http://dornea.nu -i
</pre></div>
<p>Well I had some closer look at the <em>run.py </em>and modified it a little bit. This is what came out (own modifications have been highlighted):</p>
<div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">java.lang</span> <span class="kn">import</span> <span class="n">System</span>

<span class="kn">from</span> <span class="nn">org.python.util</span> <span class="kn">import</span> <span class="n">JLineConsole</span><span class="p">,</span> <span class="n">PythonInterpreter</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="k">class</span> <span class="nc">MyThread</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="c"># Run own thread to get things done</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">burp</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">Thread</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'jython-console'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opts</span>   <span class="o">=</span> <span class="n">options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">burp</span>   <span class="o">=</span> <span class="n">burp</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">java.net</span> <span class="kn">import</span> <span class="n">URL</span>

        <span class="c"># Add new scope</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">add_to_scope</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">burp</span><span class="o">.</span><span class="n">includeInScope</span><span class="p">(</span><span class="n">URL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">add_to_scope</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[--] Added new scope ..."</span><span class="p">)</span>

        <span class="c"># Send URL to spider</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">send_to_spider</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">burp</span><span class="o">.</span><span class="n">sendToSpider</span><span class="p">(</span><span class="n">URL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">send_to_spider</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[--] Starting spider ..."</span><span class="p">)</span>

        <span class="c"># Start interactive jython console</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">java.util</span> <span class="kn">import</span> <span class="n">Properties</span>
            <span class="n">pre_properties</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span>
            <span class="n">pre_properties</span><span class="p">[</span><span class="s">'python.console'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'org.python.util.ReadlineConsole'</span>
            <span class="n">post_properties</span> <span class="o">=</span> <span class="n">Properties</span><span class="p">()</span>

            <span class="n">PythonInterpreter</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">pre_properties</span><span class="p">,</span> <span class="n">post_properties</span><span class="p">,</span> <span class="p">[])</span>

            <span class="c"># Attach threaded console to BurpExtender</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">burp</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">console</span> <span class="o">=</span> <span class="n">JLineConsole</span><span class="p">()</span>
            <span class="n">console</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">'Burp'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">burp</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">burp</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'Launching interactive session...</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'Launching interactive session...</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

            <span class="n">ConsoleThread</span><span class="p">(</span><span class="n">console</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">start_burp</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">'java'</span><span class="p">,</span> <span class="s">'src'</span><span class="p">),</span> <span class="n">options</span><span class="o">.</span><span class="n">burp</span><span class="p">])</span>

    <span class="kn">from</span> <span class="nn">burp_extender</span> <span class="kn">import</span> <span class="n">BurpExtender</span> <span class="k">as</span> <span class="n">MyBurpExtender</span><span class="p">,</span> <span class="n">ConsoleThread</span>
    <span class="kn">from</span> <span class="nn">burp</span> <span class="kn">import</span> <span class="n">StartBurp</span>
    <span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
    <span class="kn">import</span> <span class="nn">BurpExtender</span>

    <span class="kn">from</span> <span class="nn">gds.burp.config</span> <span class="kn">import</span> <span class="n">Configuration</span>

    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="s">'jython-burp.log'</span><span class="p">,</span>
            <span class="n">format</span><span class="o">=</span><span class="s">'</span><span class="si">%(asctime)-15s</span><span class="s"> - </span><span class="si">%(levelname)s</span><span class="s"> - </span><span class="si">%(message)s</span><span class="s">'</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="s">'jython-burp.log'</span><span class="p">,</span>
            <span class="n">format</span><span class="o">=</span><span class="s">'</span><span class="si">%(asctime)-15s</span><span class="s"> - </span><span class="si">%(levelname)s</span><span class="s"> - </span><span class="si">%(message)s</span><span class="s">'</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="s">'jython-burp.log'</span><span class="p">,</span>
            <span class="n">format</span><span class="o">=</span><span class="s">'</span><span class="si">%(asctime)-15s</span><span class="s"> - </span><span class="si">%(levelname)s</span><span class="s"> - </span><span class="si">%(message)s</span><span class="s">'</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>

    <span class="c"># Set the BurpExtender handler to the Pythonic BurpExtender</span>
    <span class="n">Burp</span> <span class="o">=</span> <span class="n">MyBurpExtender</span><span class="p">()</span>
    <span class="n">Burp</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">config</span><span class="p">))</span>
    <span class="n">Burp</span><span class="o">.</span><span class="n">opt</span> <span class="o">=</span> <span class="n">options</span>
    <span class="n">Burp</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="n">BurpExtender</span><span class="o">.</span><span class="n">setHandler</span><span class="p">(</span><span class="n">Burp</span><span class="p">)</span>
    <span class="n">StartBurp</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="c"># In latest Burp, callbacks might not get registered immediately</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">Burp</span><span class="o">.</span><span class="n">cb</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="c"># Disable Burp Proxy Interception on startup</span>
    <span class="n">Burp</span><span class="o">.</span><span class="n">setProxyInterceptionEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># Check for options and start new thread(s)</span>
    <span class="n">MyThread</span><span class="p">(</span><span class="n">Burp</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-B'</span><span class="p">,</span> <span class="s">'--load-burp'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">'burp'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Load Burp Jar from PATH'</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s">'PATH'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-i'</span><span class="p">,</span> <span class="s">'--interactive'</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Run Burp in interactive mode (Jython Console)'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-f'</span><span class="p">,</span> <span class="s">'--file'</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s">'FILE'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Restore Burp state from FILE on startup'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-d'</span><span class="p">,</span> <span class="s">'--debug'</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Set log level to DEBUG'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-v'</span><span class="p">,</span> <span class="s">'--verbose'</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Set log level to INFO'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-P'</span><span class="p">,</span> <span class="s">'--python-path'</span><span class="p">,</span>
                      <span class="n">default</span><span class="o">=</span><span class="s">''</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Set PYTHONPATH used by Jython'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'-C'</span><span class="p">,</span> <span class="s">'--config'</span><span class="p">,</span>
                      <span class="n">default</span><span class="o">=</span><span class="s">'burp.ini'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Specify alternate jython-burp config file'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'--disable-reloading'</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s">'Disable hot-reloading when a file is changed'</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'--send-to-spider'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Send URL to spider'</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">'--add-to-scope'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Add URL to scope'</span><span class="p">)</span>

    <span class="n">opt</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">opt</span><span class="o">.</span><span class="n">burp</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Load Burp Error: Specify a path to your burp.jar with -B'</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">start_burp</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>
<p>Now I can easily automate following steps:</p>
<ul>
<li>send some URL to the spider</li>
<li>add URL to the scope</li>
</ul>
<div class="highlight"><pre><span class="nv">$ </span>java -jar ../jython.jar -Dpython.path<span class="o">=</span>Lib/  testing.py -B burpsuite_pro_v1.5.11.jar --send-to-spider http://heise.de --add-to-scope http://heise.de -i 
<span class="o">[</span>--<span class="o">]</span> Added new scope ...
<span class="o">[</span>--<span class="o">]</span> Starting spider ...
...
</pre></div>
<p>The above code is just a PoC. Maybe I'll extend it to some features like</p>
<ul>
<li>logging (specify format)</li>
<li>tamper requests before being sent</li>
<li>export results (XML)</li>
<li>write results to some DB</li>
</ul>
                </div>
<hr/>
<div style="float:left;">
	Prev: <a href="http://blog.dornea.nu/2013/07/03/howto-root-your-kindle-3" align='left'>
	 HowTo: Root your Kindle 3
	</a>
</div>
<div style="float:right;">
    Next: <a href="http://blog.dornea.nu/2013/08/10/gentoo-systemd-consolekit-udev-and-some-failed-system-update" align='right'>
	 Gentoo, systemd, consolekit, udev and some failed system update
	</a>
</div>
</p>

                <!-- Add comments -->
<div id="content-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname="dorneanu";
				var disqus_identifier = 'howto-automate-burp-using-burp-extender-api';
			var disqus_url = 'http://blog.dornea.nu/2013/08/02/howto-automate-burp-using-burp-extender-api';

		var disqus_config = function () {
			this.language = "en";
		};
 
        
        (function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
            </div>
            <div class="niu2-right-container col-md-2">
                <div id="niu2-sidebar-meta" class="niu2-sidebar">
                    <div class="niu2-sidebar-label"><i class="icon-calendar"></i>Published:</div>
                    <div class="niu2-sidebar-value">2013-08-02 00:00</div>
                    <div class="niu2-sidebar-label"><i class="icon-pencil"></i>category:</div>
                    <div class="niu2-sidebar-value"><a href="http://blog.dornea.nu/category/blog">blog</a></div>
                    <div class="niu2-sidebar-label"><i class="icon-tag"></i>Tag:</div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/coding/">coding</a><sup>26</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/howto/">howto</a><sup>22</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/security/">security</a><sup>35</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/web/">web</a><sup>14</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/appsec/">appsec</a><sup>23</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/burp/">burp</a><sup>5</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/python/">python</a><sup>24</sup></div>
                    <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://blog.dornea.nu/tag/java/">java</a><sup>7</sup></div>
                </div>

                <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
                    <div class="niu2-sidebar-label">
                        <i id="niu2-sidebar-toc-ctrl" class="icon-open-tocs"></i>Table of contents
                    </div>
                    <ul id="niu2-sidebar-toc-list">
                        <li><a href="#content-heading">HowTo: Automate Burp using Burp Extender API</a></li>
                        <li><a href='#5a2ebfb8baa378cfcfcba58bbb1380c2'>Requirements</a></li><li><a href='#c4f9ec482073794b20393974fe4409c2'>Google found...</a></li><li><a href='#4e2419f34a9754a835ba2515de19d358'>Jython Burp API</a></li><li><a href='#caea8340e2d186a540518d08602aa065'>Automation</a></li>
                        <li><a href="#content-comments">Comments</a></li>
                    </ul>
                </div>
            </div>
            <div id="niu2-toolbar">
                <ul class="list-unstyled">
                    <li><a id="niu2-toolbar-ctrlsidebar" href="#" title="Hide Sidebar"><i class="icon-3x icon-hide-sidebar"></i></a></li>
                </ul>
                <div id="niu2-toolbar-showsidebar" data-title="Show Sidebar"></div>
                <div id="niu2-toolbar-github" data-repo=""></div>
                <div id="niu2-toolbar-bitbucket" data-repo=""></div>
            </div>
            <div id="niu2-toc" data-style="fixed"></div>
        </div>

        <div class="niu2-footer">
            <div id="body-footer" class="col-md-6 col-md-offset-2">
                <hr/>
                <p>
                    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
                    <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="https://github.com/twbs/bootstrap">Bootstrap3</a>
                    by <a href="https://blog.mawenbao.com">Ma Wenbao</a>, icons by 
                    <a href="https://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
                </p>
                <p>
                    © 2008 - 2016
                    <a class="niu2-footer-link" href="http://blog.dornea.nu">Victor Dorneanu</a>
                </p>
                <p class="niu2-icons">
                    <a class="niu2-footer-icon" href="https://pgp.mit.edu/pks/lookup?op=get&search=0x18F1AD46FB05E1B7" title="my public key">
                        <i class="icon-key icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="mailto: no-spam ÄATT dornea DOT nu" title="my email address">
                        <i class="icon-envelope-o icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="http://github.com/dorneanu" title="my github page">
                        <i class="icon-github-alt icon-lg"></i>
                    </a>
                    <a class="niu2-footer-icon" href="/feeds/rss.xml" title="subscribe my blog">
                        <i class="icon-rss icon-lg"></i>
                    </a>
                </p>
            </div>
        </div>

        <script type="text/javascript">
            var _gaq=_gaq||[];
            _gaq.push(["_setAccount","UA-7161767-3"]);
            _gaq.push(["_trackPageview"]);
            (function(){
                var b=document.createElement("script");
                b.type="text/javascript";
                b.async=true;
                b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";
                var a=document.getElementsByTagName("script")[0];
                a.parentNode.insertBefore(b,a)
            })();
        </script>
        <div id="niu2-pygments" data-theme="github"></div>
        <div id="niu2-lazy-load" data-loading-txt="Loading image" data-loading-icon="icon-spin icon-spinner"></div>
        <div id="niu2-toolbar-load" data-loading-icon="icon-spin icon-4x icon-spinner"></div>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/niu2.min.js"></script>
        <script type="text/javascript" src="http://blog.dornea.nu/theme/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/js/custom.js"></script>
        <script type="text/javascript">
            onContentLoaded();
        </script>
    </body>
</html>